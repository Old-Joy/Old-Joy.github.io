<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>hexoåšå®¢butterflyä¸»é¢˜ç¾åŒ–æ•™ç¨‹</title>
      <link href="/2025/07/15/butterfly%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/hexo%E5%8D%9A%E5%AE%A2butterfly%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/"/>
      <url>/2025/07/15/butterfly%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/hexo%E5%8D%9A%E5%AE%A2butterfly%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><strong>å†™åœ¨å‰é¢ï¼š</strong></p><ol><li>åšå®¢é­”æ”¹æœ‰é£é™©ï¼Œå»ºè®®åœ¨ä¿®æ”¹ä»£ç æ—¶ï¼Œå°†åŸä»£ç æ³¨é‡Šè€Œä¸æ˜¯åˆ é™¤</li><li>é‰´äºæ¯ä¸ªäººçš„æ ¹ç›®å½•åç§°éƒ½ä¸ä¸€æ ·ï¼Œæœ¬å¸–<strong>åšå®¢æ ¹ç›®å½•</strong>ä¸€å¾‹ä»¥ <code>[BlogRoot]</code> æŒ‡ä»£</li><li>å› ä¸º<code>.pug</code>ã€<code>.styl</code>å’Œ<code>.yml</code>æ–‡ä»¶å¯¹äºç¼©è¿›çš„è¦æ±‚è¾ƒä¸ºä¸¥æ ¼ï¼Œæ•…å»ºè®®å¤§å®¶ä½¿ç”¨ <code>VS Code</code>è¿›è¡Œä¿®æ”¹</li><li>æœ¬å¸–çš„éƒ¨åˆ†ä»£ç ä»¥<strong>diffä»£ç å—</strong>æ ‡è¯†ï¼Œåœ¨ä¿®æ”¹æ—¶åˆ«å¿˜è®°åˆ å»å‰é¢çš„ <code>+</code> å’Œ <code>-</code> ç¬¦å·</li></ol></blockquote><h2 id="ç½‘ç«™æ¶ææ ‡é¢˜"><a href="#ç½‘ç«™æ¶ææ ‡é¢˜" class="headerlink" title="ç½‘ç«™æ¶ææ ‡é¢˜"></a>ç½‘ç«™æ¶ææ ‡é¢˜</h2><h4 id="æ•ˆæœé¢„è§ˆ"><a href="#æ•ˆæœé¢„è§ˆ" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h4><p><img src="/img/butterfly/title_pre.png"></p><p>åœ¨æœªé€‰ä¸­è¯¥ç½‘é¡µæ—¶ï¼Œå…¶å‘ˆç°å‡ºè¿™æ ·çš„å†…å®¹</p><p><img src="/img/butterfly/title_after.png"></p><p>åœ¨é€‰ä¸­è¯¥ç½‘é¡µçš„ä¸€æ®µæ—¶é—´å†…ï¼Œå…¶å‘ˆç°å‡ºè¿™æ ·çš„å†…å®¹ï¼Œä¹‹åæ¢å¤æ­£å¸¸</p><h4 id="ä¿®æ”¹æ–¹å¼"><a href="#ä¿®æ”¹æ–¹å¼" class="headerlink" title="ä¿®æ”¹æ–¹å¼"></a>ä¿®æ”¹æ–¹å¼</h4><ol><li><p>æ–°å»ºæ–‡ä»¶ <code>[BlogRoot]\source\js\title.js</code>ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŠ¨æ€æ ‡é¢˜</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">OriginTitile</span> = <span class="variable language_">document</span>.<span class="property">title</span>;</span><br><span class="line"><span class="keyword">var</span> titleTime;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;visibilitychange&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">hidden</span>) &#123;</span><br><span class="line">    <span class="comment">//ç¦»å¼€å½“å‰é¡µé¢æ—¶æ ‡ç­¾æ˜¾ç¤ºå†…å®¹</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;è¦‹ã¦è¦‹ã¦!!!&#x27;</span>;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(titleTime);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//è¿”å›å½“å‰é¡µé¢æ—¶æ ‡ç­¾æ˜¾ç¤ºå†…å®¹</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;Timoteiâ€”â€”â€”â€”&#x27;</span>;</span><br><span class="line">    <span class="comment">//ä¸¤ç§’åå˜å›æ­£å¸¸æ ‡é¢˜</span></span><br><span class="line">    titleTime = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">title</span> = <span class="title class_">OriginTitile</span>;</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>åˆ«å¿˜äº†åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶é‡Œé¢å¼•å…¥è¯¥å†…å®¹ï¼š</p> <figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  bottom:</span><br><span class="line"><span class="addition">+    - &lt;script async src=&quot;/js/title.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>æœ€åé‡å¯è¯¥é¡¹ç›®ï¼ˆè¯¥æ­¥éª¤ä»¥åä¸å†èµ˜è¿°ï¼‰</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo g; hexo d</span><br></pre></td></tr></table></figure></li></ol><h2 id="å¤´åƒå‘¼å¸ç¯"><a href="#å¤´åƒå‘¼å¸ç¯" class="headerlink" title="å¤´åƒå‘¼å¸ç¯"></a>å¤´åƒå‘¼å¸ç¯</h2><h4 id="æ•ˆæœé¢„è§ˆ-1"><a href="#æ•ˆæœé¢„è§ˆ-1" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h4><p><img src="/img/butterfly/avatar_breathlight.png"></p><p>åœ¨å¤´åƒå‘¨å›´åŠ ä¸Šä¸€åœˆç™½è‰²çš„å‘¼å¸ç¯</p><h4 id="ä¿®æ”¹æ–¹å¼-1"><a href="#ä¿®æ”¹æ–¹å¼-1" class="headerlink" title="ä¿®æ”¹æ–¹å¼"></a>ä¿®æ”¹æ–¹å¼</h4><p>è¿™ä¸ªå‘¼å¸ç¯å¯ä»¥é€šè¿‡<code>js</code>å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>css</code>å®ç°ã€‚ä½¿ç”¨<code>css</code>å®ç°çš„æ€§èƒ½ä¼šå¥½ä¸€ç‚¹ã€‚æ‰€ä»¥å¯ä»¥åœ¨ <code>[BlogRoot]\source\css\custom.css</code>é‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼ˆæ²¡æœ‰å°±è‡ªå·±æ–°å»ºä¸€ä¸ªï¼‰ã€‚å…¶ä¸­å…³äºé¢œè‰²ã€æ—¶é—´çš„éƒ¨åˆ†å¤§å®¶éƒ½å¯ä»¥æŒ‰ç…§è‡ªå·±çš„å–œå¥½æ¥è°ƒèŠ‚ã€‚åŸç†æŒºç®€å•çš„ï¼Œå°±æ˜¯å…³é”®å¸§ä¹‹é—´é€šè¿‡æŸä¸ªæ’å€¼æ–¹æ³•è¿ç»­å˜æ ·å¼è€Œå·²ï¼Œä¼šè¿™ä¸€ä¸ªä½ å°±ä¼šDIYå„ç§é«˜å¤§ä¸Šçš„åŠ¨ç”»å•¦~</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å¤´åƒå‘¼å¸ç¯ */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-class">.avatar-img</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: huxi_light <span class="number">4s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.avatar-img</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: huxi_dark <span class="number">4s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> huxi_light &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">1px</span> <span class="number">1px</span> <span class="number">#e9f5fa</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">5px</span> <span class="number">5px</span> <span class="number">#e9f5fa</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">1px</span> <span class="number">1px</span> <span class="number">#e9f5fa</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> huxi_dark &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">1px</span> <span class="number">1px</span> <span class="number">#39c5bb</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">5px</span> <span class="number">5px</span> <span class="number">#39c5bb</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">1px</span> <span class="number">1px</span> <span class="number">#39c5bb</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡å¯é¡¹ç›®å³å¯çœ‹åˆ°æ•ˆæœã€‚</p><h2 id="æ–‡ç« é¡µé¡¶æ³¢æµªçº¿"><a href="#æ–‡ç« é¡µé¡¶æ³¢æµªçº¿" class="headerlink" title="æ–‡ç« é¡µé¡¶æ³¢æµªçº¿"></a>æ–‡ç« é¡µé¡¶æ³¢æµªçº¿</h2><h4 id="æ•ˆæœé¢„è§ˆ-2"><a href="#æ•ˆæœé¢„è§ˆ-2" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h4><p><img src="/img/butterfly/waves.png"></p><p>åœ¨æ–‡ç« å°é¢çš„åº•éƒ¨åŠ ä¸Šä¸€å±‚åŠ¨æ€æµ·æµªæ•ˆæœï¼Œé¢œè‰²å¯ä»¥è‡ªå·±è°ƒ</p><h4 id="ä¿®æ”¹æ–¹å¼-2"><a href="#ä¿®æ”¹æ–¹å¼-2" class="headerlink" title="ä¿®æ”¹æ–¹å¼"></a>ä¿®æ”¹æ–¹å¼</h4><ol><li><p>ä¿®æ”¹ <code>[BlogRoot]\themes\butterfly\layout\includes\header\index.pug</code>æ–‡ä»¶ï¼Œå¤§æ¦‚ä½ç½®åœ¨33è¡Œ</p> <figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if top_img !== false</span><br><span class="line">  if is_post()</span><br><span class="line">    include ./post-info.pug</span><br><span class="line"><span class="addition">+   section.main-hero-waves-area.waves-area</span></span><br><span class="line"><span class="addition">+     svg.waves-svg(xmlns=&#x27;http://www.w3.org/2000/svg&#x27;, xlink=&#x27;http://www.w3.org/1999/xlink&#x27;, viewBox=&#x27;0 24 150 28&#x27;, preserveAspectRatio=&#x27;none&#x27;, shape-rendering=&#x27;auto&#x27;)</span></span><br><span class="line"><span class="addition">+       defs</span></span><br><span class="line"><span class="addition">+         path#gentle-wave(d=&#x27;M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z&#x27;)</span></span><br><span class="line"><span class="addition">+       g.parallax</span></span><br><span class="line"><span class="addition">+         use(href=&#x27;#gentle-wave&#x27;, x=&#x27;48&#x27;, y=&#x27;0&#x27;)</span></span><br><span class="line"><span class="addition">+         use(href=&#x27;#gentle-wave&#x27;, x=&#x27;48&#x27;, y=&#x27;3&#x27;)</span></span><br><span class="line"><span class="addition">+         use(href=&#x27;#gentle-wave&#x27;, x=&#x27;48&#x27;, y=&#x27;5&#x27;)</span></span><br><span class="line"><span class="addition">+         use(href=&#x27;#gentle-wave&#x27;, x=&#x27;48&#x27;, y=&#x27;7&#x27;)</span></span><br><span class="line">    #post-top-cover</span><br><span class="line">      img#post-top-bg(class=&#x27;nolazyload&#x27; src=bg_img)</span><br><span class="line">  else if is_home()</span><br><span class="line">    #site-info</span><br><span class="line">      h1#site-title=site_title</span><br><span class="line">      if theme.subtitle.enable</span><br></pre></td></tr></table></figure><p> æ³¨æ„çœ‹å¥½ç¼©è¿›</p></li><li><p>ç„¶ååœ¨ <code>[BlogRoot]\source\css\custom.css</code>é‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹</p> <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ³¢æµªcss */</span></span><br><span class="line"><span class="selector-class">.main-hero-waves-area</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: -<span class="number">11px</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waves-area</span> <span class="selector-class">.waves-svg</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">5rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Animation */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: move-forever <span class="number">25s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.55</span>, <span class="number">0.5</span>, <span class="number">0.45</span>, <span class="number">0.5</span>) infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">2s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">7s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#f7f9febd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">3s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">10s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#f7f9fe82</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">4s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">13s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#f7f9fe36</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">5s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">20s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#f7f9fe</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* é»‘è‰²æ¨¡å¼èƒŒæ™¯ */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">2s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">7s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#18171dc8</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">3s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">10s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#18171d80</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">4s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">13s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#18171d3e</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>) &#123;</span><br><span class="line">  <span class="attribute">animation-delay</span>: -<span class="number">5s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">20s</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#18171d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> move-forever &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(-<span class="number">90px</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">85px</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*Shrinking for mobile*/</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.waves-area</span> <span class="selector-class">.waves-svg</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">40px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <code>css</code>é‡Œé¢çš„<code>fill</code>å±æ€§å°±æ˜¯æ§åˆ¶æ³¢æµªé¢œè‰²çš„ï¼Œæœ€å¥½è®©å…¶ä¸­ä¸€ä¸ªé¢œè‰²ä¸èƒŒæ™¯é¢œè‰²ä¸€è‡´ï¼Œä¸ç„¶çš„è¯çœ‹èµ·æ¥ä¼šå¾ˆæ€ªã€‚</p></li><li><p>æœ€åé‡å¯è¯¥é¡¹ç›®å³å¯ã€‚</p></li></ol><h2 id="æ·»åŠ fpsæ˜¾ç¤º"><a href="#æ·»åŠ fpsæ˜¾ç¤º" class="headerlink" title="æ·»åŠ fpsæ˜¾ç¤º"></a>æ·»åŠ fpsæ˜¾ç¤º</h2><h4 id="æ•ˆæœé¢„è§ˆ-3"><a href="#æ•ˆæœé¢„è§ˆ-3" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h4><p><img src="/img/butterfly/FPS.png"></p><p>åœ¨é¡µé¢çš„æŸä¸ªä½ç½®ï¼ˆæˆ‘è¿™é‡Œè®¾ç½®çš„æ˜¯å·¦ä¸‹è§’ï¼‰ï¼Œæ·»åŠ fpsçš„æ˜¾ç¤ºï¼Œå¯ä»¥åˆ’é˜¶æ®µæ˜¾ç¤ºä¸åŒæ–‡å­—</p><h4 id="ä¿®æ”¹æ–¹æ³•"><a href="#ä¿®æ”¹æ–¹æ³•" class="headerlink" title="ä¿®æ”¹æ–¹æ³•"></a>ä¿®æ”¹æ–¹æ³•</h4><ol><li><p>æ–°å»ºæ–‡ä»¶ <code>[BlogRoot]\source\js\fps.js</code>ï¼Œå¹¶å†™å…¥å¦‚ä¸‹ä»£ç </p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;fpson&quot;</span>) == <span class="literal">undefined</span> || <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;fpson&quot;</span>) == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> rAF = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span> ||</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span> ||</span><br><span class="line">            <span class="keyword">function</span> (<span class="params">callback</span>) &#123;</span><br><span class="line">                <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(callback, <span class="number">1000</span> / <span class="number">60</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;();</span><br><span class="line">    <span class="keyword">var</span> frame = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> allFrameCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> lastTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">var</span> lastFameTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">var</span> loop = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">        <span class="keyword">var</span> fs = (now - lastFameTime);</span><br><span class="line">        <span class="keyword">var</span> fps = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="number">1000</span> / fs);</span><br><span class="line"></span><br><span class="line">        lastFameTime = now;</span><br><span class="line">        <span class="comment">// ä¸ç½® 0ï¼Œåœ¨åŠ¨ç”»çš„å¼€å¤´åŠç»“å°¾è®°å½•æ­¤å€¼çš„å·®å€¼ç®—å‡º FPS</span></span><br><span class="line">        allFrameCount++;</span><br><span class="line">        frame++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (now &gt; <span class="number">1000</span> + lastTime) &#123;</span><br><span class="line">            <span class="keyword">var</span> fps = <span class="title class_">Math</span>.<span class="title function_">round</span>((frame * <span class="number">1000</span>) / (now - lastTime));</span><br><span class="line">            <span class="keyword">if</span> (fps &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#bd0000&quot;&gt;å¡æˆpptğŸ˜°&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt;= <span class="number">15</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:red&quot;&gt;ç”µç«çº§å¸§ç‡ğŸ˜–&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt;= <span class="number">25</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:orange&quot;&gt;æœ‰ç‚¹éš¾å—ğŸ˜¨&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt; <span class="number">35</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#9338e6&quot;&gt;ä¸å¤ªæµç•…ğŸ™„&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fps &lt;= <span class="number">45</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#08b7e4&quot;&gt;è¿˜ä¸é”™å“¦ğŸ˜&lt;/span&gt;`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> kd = <span class="string">`&lt;span style=&quot;color:#39c5bb&quot;&gt;ååˆ†æµç•…ğŸ¤“&lt;/span&gt;`</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;fps&quot;</span>).<span class="property">innerHTML</span> = <span class="string">`FPS:<span class="subst">$&#123;fps&#125;</span> <span class="subst">$&#123;kd&#125;</span>`</span>;</span><br><span class="line">            frame = <span class="number">0</span>;</span><br><span class="line">            lastTime = now;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">rAF</span>(loop);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">loop</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;fps&quot;</span>).<span class="property">style</span> = <span class="string">&quot;display:none!important&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åœ¨ <code>[BlogRoot]\source\css\custom.css</code>ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç ï¼Œæˆ‘è¿™é‡Œå°±æ˜¯è®©è¿™ä¸ªæ˜¾ç¤ºåœ¨å·¦ä¸‹è§’ï¼Œä½ å¯ä»¥è‡ªå·±æŒ‡å®šä½ç½®ï¼Œå…¶ä¸­ <code>backdrop-filter</code>è¿‡æ»¤å™¨ä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šï¼Œä¹Ÿå¯ä»¥ä¸è¦</p> <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å¸§ç‡æ£€æµ‹ */</span></span><br><span class="line"><span class="selector-id">#fps</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="comment">/* æŒ‡å®šä½ç½® */</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1919810</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-id">#fps</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.85</span>);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#fps</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.72</span>);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">var</span>(--backdrop-filter);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.butterfly.yml</code>æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç </p> <figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject: </span><br><span class="line">  head: </span><br><span class="line"><span class="addition">+    - &lt;span id=&quot;fps&quot;&gt;&lt;/span&gt; # å¸§ç‡æ£€æµ‹</span></span><br><span class="line">  bottom: </span><br><span class="line"><span class="addition">+    - &lt;script async src=&quot;/js/fps.js&quot;&gt;&lt;/script&gt; # å¸§ç‡æ£€æµ‹</span></span><br></pre></td></tr></table></figure></li><li><p>é‡å¯é¡¹ç›®çœ‹çœ‹æœ‰æ²¡æœ‰å‡ºç°å¸§ç‡å—</p></li></ol><h2 id="å³è¾¹æŒ‰é’®é˜…è¯»è¿›åº¦"><a href="#å³è¾¹æŒ‰é’®é˜…è¯»è¿›åº¦" class="headerlink" title="å³è¾¹æŒ‰é’®é˜…è¯»è¿›åº¦"></a>å³è¾¹æŒ‰é’®é˜…è¯»è¿›åº¦</h2><h4 id="æ•ˆæœé¢„è§ˆ-4"><a href="#æ•ˆæœé¢„è§ˆ-4" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h4><p><img src="/img/butterfly/progress.png"></p><p>å…¶å®æ˜¯æŠŠä¸€é”®å›åˆ°é¡µé¡¶ç»™ä¿®æ”¹äº†ä¸€ä¸‹ã€‚å½“é¼ æ ‡æ²¡æœ‰æ‚¬åœåœ¨è¿™ä¸ªæŒ‰é’®ä¸Šçš„æ—¶å€™ï¼Œå®ƒä¼šæ˜¾ç¤ºå½“å‰æ–‡ç« çš„é˜…è¯»è¿›åº¦ï¼›å½“é¼ æ ‡æ‚¬åœåœ¨ä¸Šé¢çš„æ—¶å€™ï¼Œå®ƒä¼šæ˜¾ç¤ºä¸€ä¸ªä¸Šç®­å¤´ï¼Œç‚¹å‡»å³å¯å›åˆ°é¡µé¡¶</p><h4 id="ä¿®æ”¹æ–¹æ³•-1"><a href="#ä¿®æ”¹æ–¹æ³•-1" class="headerlink" title="ä¿®æ”¹æ–¹æ³•"></a>ä¿®æ”¹æ–¹æ³•</h4><blockquote><p>å…¶å®å®ç°åŸç†ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬åªè¦æŠŠ <code>è¢«é¡¶éƒ¨å·å»çš„é«˜åº¦/ï¼ˆé¡µé¢æ€»é«˜åº¦ - å¯è§†é«˜åº¦ï¼‰</code>ï¼Œå°±èƒ½ç®—å‡ºç™¾åˆ†æ¯”å•¦ï¼ä¹‹æ‰€ä»¥å‡å»å¯è§†é«˜åº¦ï¼Œæ˜¯å› ä¸ºå½“æˆ‘ä»¬åœ¨æ»‘å€’æœ€åº•éƒ¨çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹å‡º <code>é¡µé¢é«˜åº¦ = è¢«å·å»çš„é«˜åº¦ + å¯è§†é«˜åº¦</code></p></blockquote><ol><li><p>ä¿®æ”¹æ–‡ä»¶ <code>[BlogRoot]\themes\butterfly\layout\includes\rightside.pug</code>ï¼Œåœ¨æœ€ä¸‹é¢æ’å…¥å¦‚ä¸‹ä¸¤è¡Œä»£ç </p> <figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">button#go-up(type=&quot;button&quot; title=_p(&quot;rightside.back_to_top&quot;))</span><br><span class="line">  i.fas.fa-arrow-up</span><br><span class="line"><span class="addition">+span#percent 0</span></span><br><span class="line"><span class="addition">+     span %</span></span><br></pre></td></tr></table></figure></li><li><p>æ–°å»ºæ–‡ä»¶ <code>[BlogRoot]\source\js\readPercent.js</code>ï¼ŒåŠ å…¥å¦‚ä¸‹ä»£ç </p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“çª—å£æ»šåŠ¨æ—¶ï¼Œæ‰§è¡Œ percent å‡½æ•°</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onscroll</span> = percent;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡µé¢ç™¾åˆ†æ¯”å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">percent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// --- è®¡ç®—æ»šåŠ¨ç™¾åˆ†æ¯” ---</span></span><br><span class="line">  <span class="keyword">let</span> scrollTop = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> || <span class="variable language_">window</span>.<span class="property">pageYOffset</span>;</span><br><span class="line">  <span class="keyword">let</span> scrollHeight = <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span>, <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollHeight</span>) - <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="title class_">Math</span>.<span class="title function_">round</span>(scrollTop / scrollHeight * <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç›´æ¥é€šè¿‡ class è·å–ç®­å¤´å…ƒç´ ï¼Œæ›´å¯é </span></span><br><span class="line">  <span class="keyword">const</span> arrow = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#go-up .fa-arrow-up&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> percentEl = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#percent&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœæ‰¾ä¸åˆ°å…ƒç´ ï¼Œå°±ç›´æ¥é€€å‡ºï¼Œé˜²æ­¢æŠ¥é”™</span></span><br><span class="line">  <span class="keyword">if</span> (!arrow || !percentEl) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (result &gt;= <span class="number">95</span>) &#123;</span><br><span class="line">    arrow.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">    percentEl.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    arrow.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    percentEl.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">    <span class="comment">// åœ¨æ›´æ–°æ•°å­—çš„åŒæ—¶ï¼ŒåŠ ä¸Š &#x27;%&#x27; å·</span></span><br><span class="line">    percentEl.<span class="property">innerText</span> = result + <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºæ–‡ä»¶ <code>[BlogRoot]\source\css\readPercent.css</code>ï¼Œå†™å…¥å¦‚ä¸‹ä»£ç </p> <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è¿”å›é¡¶éƒ¨ */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-id">#go-up</span> <span class="selector-id">#percent</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">15px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-id">#go-up</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: -<span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* é¼ æ ‡æ»‘åŠ¨åˆ°æŒ‰é’®ä¸Šæ—¶æ˜¾ç¤ºè¿”å›é¡¶éƒ¨å›¾æ ‡ */</span></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-id">#go-up</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">i</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-id">#go-up</span><span class="selector-pseudo">:hover</span> <span class="selector-id">#percent</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æœ€åè®°å¾—å¼•å…¥ä¸€ä¸‹jså’Œcssæ–‡ä»¶</p> <figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line"><span class="addition">+    - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/readPercent.css&quot;&gt;</span></span><br><span class="line">  bottom:</span><br><span class="line"><span class="addition">+    - &lt;script defer data-pjax src=&quot;/js/readPercent.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>é‡å¯é¡¹ç›®å³å¯çœ‹åˆ°æ•ˆæœ</p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_challenge_shell_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/06/25/OS-Lab6-challenge/%E6%8C%91%E6%88%98%E6%80%A7%E4%BB%BB%E5%8A%A1%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/06/25/OS-Lab6-challenge/%E6%8C%91%E6%88%98%E6%80%A7%E4%BB%BB%E5%8A%A1%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å®éªŒæ€»è§ˆ"><a href="#å®éªŒæ€»è§ˆ" class="headerlink" title="å®éªŒæ€»è§ˆ"></a>å®éªŒæ€»è§ˆ</h1><p>æœ¬æ¬¡å®éªŒæ—¨åœ¨å¯¹ MOS æ“ä½œç³»ç»Ÿä¸­ç°æœ‰çš„ Shell è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œä½¿å…¶ä»ä¸€ä¸ªåŸºç¡€çš„å‘½ä»¤è§£é‡Šå™¨æ¼”è¿›ä¸ºä¸€ä¸ªåŠŸèƒ½æ›´åŠ å®Œå–„ã€ç”¨æˆ·ä½“éªŒæ›´ä½³çš„äº¤äº’å¼ç¨‹åºã€‚å®éªŒå†…å®¹ä¸»è¦åŒ…æ‹¬ï¼š</p><ol><li><strong>è·¯å¾„ç®¡ç†</strong>ï¼šå¼•å…¥å½“å‰å·¥ä½œç›®å½•ï¼ˆCWDï¼‰çš„æ¦‚å¿µï¼Œæ”¯æŒç›¸å¯¹è·¯å¾„ï¼Œå¹¶å®ç° <code>cd</code> å’Œ <code>pwd</code> å†…ç½®å‘½ä»¤ã€‚</li><li><strong>ç¯å¢ƒå˜é‡</strong>ï¼šå®ç°å±€éƒ¨å’Œå…¨å±€ç¯å¢ƒå˜é‡çš„ç®¡ç†ï¼ŒåŒ…æ‹¬ <code>declare</code>ã€<code>unset</code> å‘½ä»¤å’Œ <code>$</code> å˜é‡å±•å¼€ã€‚</li><li><strong>è¾“å…¥ä¸æŒ‡ä»¤ä¼˜åŒ–</strong>ï¼šå®ç°æŒ‡ä»¤è‡ªç”±è¾“å…¥ã€ä¸å¸¦ <code>.b</code> åç¼€æŒ‡ä»¤ã€å¿«æ·é”®ã€å†å²æŒ‡ä»¤ã€æ³¨é‡ŠåŠŸèƒ½ã€</li><li><strong>æŒ‡ä»¤æ¡ä»¶æ‰§è¡Œ</strong>ï¼šå®ç° Linux shell ä¸­çš„ <code>&amp;&amp;</code> å’Œ <code>||</code>ã€‚</li><li><strong>æ›´å¤šæŒ‡ä»¤</strong>ï¼šå¢åŠ  <code>touch</code>, <code>mkdir</code>, <code>rm</code> ç­‰å¸¸ç”¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œå‘½ä»¤å’Œ <code>exit</code> æŒ‡ä»¤ã€‚</li><li><strong>è¿½åŠ é‡å®šå‘</strong>ï¼šå®ç°äº†è¿½åŠ é‡å®šå‘åŠŸèƒ½</li></ol><p>é™äºç¯‡å¹…ï¼Œæœ¬æŠ¥å‘Šå¹¶æœªç»™å‡ºå…¨éƒ¨ä¿®æ”¹çš„ä»£ç ï¼Œä»…ç»™å‡ºäº†ç¬”è€…è®¤ä¸ºæ¯”è¾ƒå…³é”®ï¼Œè¯­è¨€ä¸èƒ½å®Œå…¨æè¿°çš„éƒ¨åˆ†ä»£ç ã€‚</p><h1 id="å®éªŒè®¾è®¡ä¸å®ç°"><a href="#å®éªŒè®¾è®¡ä¸å®ç°" class="headerlink" title="å®éªŒè®¾è®¡ä¸å®ç°"></a>å®éªŒè®¾è®¡ä¸å®ç°</h1><h2 id="1-æ”¯æŒç›¸å¯¹è·¯å¾„ä¸å†…ç½®å‘½ä»¤-cdã€pwd"><a href="#1-æ”¯æŒç›¸å¯¹è·¯å¾„ä¸å†…ç½®å‘½ä»¤-cdã€pwd" class="headerlink" title="1. æ”¯æŒç›¸å¯¹è·¯å¾„ä¸å†…ç½®å‘½ä»¤ cdã€pwd"></a><strong>1. æ”¯æŒç›¸å¯¹è·¯å¾„ä¸å†…ç½®å‘½ä»¤ <code>cd</code>ã€<code>pwd</code></strong></h2><h3 id="1-1-è®¾è®¡æ€è·¯"><a href="#1-1-è®¾è®¡æ€è·¯" class="headerlink" title="1.1 è®¾è®¡æ€è·¯"></a><strong>1.1 è®¾è®¡æ€è·¯</strong></h3><p>ä¸ºäº†æ”¯æŒç›¸å¯¹è·¯å¾„ï¼Œæ ¸å¿ƒæ˜¯ä¸ºæ¯ä¸ªè¿›ç¨‹ç»´æŠ¤ä¸€ä¸ªâ€œå½“å‰å·¥ä½œç›®å½•â€ï¼ˆCWDï¼‰çš„çŠ¶æ€ã€‚</p><ol><li><strong>CWD çš„å­˜å‚¨</strong>ï¼š<ul><li>æœ€ä½³æ–¹æ¡ˆæ˜¯åˆ©ç”¨å…±äº«å†…å­˜ã€‚æˆ‘åˆ†é…äº†ä¸€ä¸ªå›ºå®šçš„è™šæ‹Ÿåœ°å€ <code>CWD_VA</code> (<code>0x7f000000</code>)ï¼Œå¹¶å°†å…¶æ˜ å°„ä¸ºä¸€ä¸ªå¸¦æœ‰ <code>PTE_LIBRARY</code> æ ‡å¿—çš„å…±äº«é¡µé¢ã€‚<code>PTE_LIBRARY</code> ç¡®ä¿äº†é€šè¿‡ <code>fork</code> æˆ– <code>spawn</code> åˆ›å»ºçš„å­è¿›ç¨‹èƒ½è‡ªåŠ¨ç»§æ‰¿è¿™ä¸ªé¡µé¢çš„æ˜ å°„ï¼Œä»è€Œå…±äº« CWD å­—ç¬¦ä¸²ã€‚</li><li>åœ¨ Shell å¯åŠ¨æ—¶ï¼ˆ<code>libmain</code> -&gt; <code>fsutil_init</code>ï¼‰ï¼Œä¼šæ£€æŸ¥è¯¥é¡µé¢æ˜¯å¦å·²æ˜ å°„ã€‚å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå¯åŠ¨çš„ Shellï¼Œå®ƒä¼šè´Ÿè´£åˆ†é…å¹¶åˆå§‹åŒ– CWD ä¸ºæ ¹ç›®å½• <code>/</code>ã€‚</li></ul></li><li><strong>è·¯å¾„è§£æ</strong>ï¼š<ul><li>åˆ›å»ºä¸€ä¸ª <code>resolve_path</code> å‡½æ•°ï¼Œè´Ÿè´£å°†ç”¨æˆ·è¾“å…¥çš„ä»»ä½•è·¯å¾„ï¼ˆç»å¯¹æˆ–ç›¸å¯¹ï¼‰è½¬æ¢ä¸ºä¸€ä¸ªå”¯ä¸€çš„ã€è§„èŒƒåŒ–çš„ç»å¯¹è·¯å¾„ã€‚</li><li><code>normalize_path</code> å‡½æ•°è´Ÿè´£å¤„ç†æ‹¼æ¥åçš„è·¯å¾„ï¼Œè§£æ <code>.</code> å’Œ <code>..</code>ï¼Œå¹¶ç§»é™¤å¤šä½™çš„ <code>/</code>ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå¹²å‡€çš„ç»å¯¹è·¯å¾„ã€‚è¿™ä¸ªç»å¯¹è·¯å¾„éšåè¢«ä¼ é€’ç»™ <code>open</code>ã€<code>stat</code> ç­‰åº•å±‚ç³»ç»Ÿè°ƒç”¨ã€‚</li></ul></li><li><strong>å†…ç½®å‘½ä»¤å®ç°</strong>ï¼š<ul><li><strong><code>cd</code></strong>ï¼šä½œä¸ºä¸€ä¸ªå†…ç½®å‘½ä»¤ï¼Œ<code>cd</code> ç›´æ¥ä¿®æ”¹å…±äº«å†…å­˜ä¸­çš„ CWD å­—ç¬¦ä¸²ã€‚å®ƒé¦–å…ˆä½¿ç”¨ <code>resolve_path</code> è§£æç›®æ ‡è·¯å¾„ï¼Œç„¶åé€šè¿‡ <code>stat</code> æ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨ä¸”ä¸ºç›®å½•ï¼ŒéªŒè¯é€šè¿‡åï¼Œæ›´æ–° CWDã€‚</li><li><strong><code>pwd</code></strong>ï¼šåŒæ ·æ˜¯å†…ç½®å‘½ä»¤ï¼Œå®ƒç›´æ¥è¯»å–å…±äº«å†…å­˜ä¸­çš„ CWD å­—ç¬¦ä¸²å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºã€‚</li></ul></li></ol><h3 id="1-2-å…³é”®ä»£ç "><a href="#1-2-å…³é”®ä»£ç " class="headerlink" title="1.2 å…³é”®ä»£ç "></a><strong>1.2 å…³é”®ä»£ç </strong></h3><p><strong>CWD å…±äº«ä¸åˆå§‹åŒ– (<code>user/lib/fsutil.c</code>)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå›ºå®šçš„è™šæ‹Ÿåœ°å€ç”¨äºå­˜å‚¨CWD</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CWD_VA 0x7f000000 </span></span><br><span class="line"><span class="type">static</span> <span class="type">char</span> *current_working_directory;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">fsutil_init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// å°†æŒ‡é’ˆæŒ‡å‘æˆ‘ä»¬çš„å›ºå®šåœ°å€</span></span><br><span class="line">    current_working_directory = (<span class="type">char</span> *)CWD_VA;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥è¿™ä¸ªé¡µé¢æ˜¯å¦å·²ç»è¢«æ˜ å°„ã€‚pageref &gt; 0 è¡¨ç¤ºå·²æ˜ å°„ã€‚</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è¢«æ˜ å°„ï¼Œè¯´æ˜å½“å‰è¿›ç¨‹æ˜¯ç¬¬ä¸€ä¸ªå¯åŠ¨çš„è¿›ç¨‹ï¼ˆé€šå¸¸æ˜¯ shï¼‰ï¼Œ</span></span><br><span class="line">    <span class="keyword">if</span> (pageref(current_working_directory) == <span class="number">0</span>) &#123;</span><br><span class="line">        syscall_mem_alloc(<span class="number">0</span>, (<span class="type">void</span> *)current_working_directory, PTE_D | PTE_LIBRARY);</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–CWDä¸ºæ ¹ç›®å½• &quot;/&quot;</span></span><br><span class="line">        <span class="built_in">strcpy</span>(current_working_directory, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>lib/libos.c</code> ä¸­çš„ <code>libmain</code> ä¼šåœ¨ <code>main</code> å‡½æ•°æ‰§è¡Œå‰è°ƒç”¨ <code>fsutil_init</code>ï¼Œç¡®ä¿ CWD æœºåˆ¶å°±ç»ªã€‚</li><li><code>PTE_LIBRARY</code> æ ‡å¿—æ˜¯å®ç°çˆ¶å­è¿›ç¨‹å…±äº« CWD çš„å…³é”®ã€‚</li></ul><p><strong>è·¯å¾„è§£æ (<code>user/lib/fsutil.c</code>)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ç›¸å¯¹è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">resolve_path</span><span class="params">(<span class="type">char</span> *resolved_path, <span class="type">const</span> <span class="type">char</span> *relative_path)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (relative_path[<span class="number">0</span>] == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line"><span class="comment">// å·²ç»æ˜¯ç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="built_in">strcpy</span>(resolved_path, relative_path);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¸CWDæ‹¼æ¥</span></span><br><span class="line"><span class="built_in">strcpy</span>(resolved_path, current_working_directory);</span><br><span class="line"><span class="comment">// åªæœ‰å½“CWDä¸æ˜¯æ ¹ç›®å½•æ—¶ï¼Œæ‰åœ¨æœ«å°¾æ·»åŠ &#x27;/&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">strcmp</span>(current_working_directory, <span class="string">&quot;/&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line"><span class="built_in">strcat</span>(resolved_path, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">strcat</span>(resolved_path, relative_path);</span><br><span class="line">&#125;</span><br><span class="line">normalize_path(resolved_path);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>è¿™ä¸ªå‡½æ•°ç»Ÿä¸€äº†è·¯å¾„å¤„ç†çš„å…¥å£ï¼Œæ‰€æœ‰æ–‡ä»¶æ“ä½œï¼ˆå¦‚ <code>open</code>, <code>stat</code>, <code>rm</code> ç­‰ï¼‰éƒ½è°ƒç”¨å®ƒæ¥è·å–ç»å¯¹è·¯å¾„ã€‚</p></li><li><p><code>cd</code> ä½œä¸ºä¸€ä¸ªæ”¹å˜ Shell è‡ªèº«çŠ¶æ€çš„å‘½ä»¤ï¼Œå¿…é¡»åœ¨ä¸» Shell è¿›ç¨‹ä¸­ç›´æ¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯ <code>fork</code> ä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œã€‚æˆ‘çš„ä»£ç åœ¨ <code>sh.c</code> çš„ä¸»å¾ªç¯ä¸­æ­£ç¡®åœ°å¤„ç†äº†è¿™ä¸€ç‚¹ã€‚<code>pwd</code> ä¹Ÿå¯ä»¥è¿™æ ·å¤„ç†ï¼Œæˆ–è€…åƒç°åœ¨ä¸€æ ·åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œå› ä¸ºå®ƒä¸æ”¹å˜ Shell çŠ¶æ€ã€‚</p></li></ul><h2 id="2-ç¯å¢ƒå˜é‡ç®¡ç†"><a href="#2-ç¯å¢ƒå˜é‡ç®¡ç†" class="headerlink" title="2. ç¯å¢ƒå˜é‡ç®¡ç†"></a><strong>2. ç¯å¢ƒå˜é‡ç®¡ç†</strong></h2><h3 id="2-1-è®¾è®¡æ€è·¯"><a href="#2-1-è®¾è®¡æ€è·¯" class="headerlink" title="2.1 è®¾è®¡æ€è·¯"></a><strong>2.1 è®¾è®¡æ€è·¯</strong></h3><ol><li><p><strong>æ•°æ®ç»“æ„</strong>ï¼šå®šä¹‰äº†ä¸€ä¸ª <code>Var</code> ç»“æ„ä½“æ¥å­˜å‚¨å•ä¸ªå˜é‡ï¼ŒåŒ…æ‹¬åç§°ã€å€¼ä»¥åŠ <code>is_env</code>ã€<code>is_readonly</code> ç­‰æ ‡å¿—ä½ã€‚æ‰€æœ‰å˜é‡å­˜å‚¨åœ¨ä¸€ä¸ªå…¨å±€æ•°ç»„ <code>shell_vars</code> ä¸­ã€‚</p></li><li><p><strong>å‘½ä»¤å®ç°</strong>ï¼š</p><ul><li><code>declare</code>ï¼šè§£æ <code>-x</code>, <code>-r</code> é€‰é¡¹å’Œ <code>NAME=VALUE</code> æ ¼å¼ã€‚è°ƒç”¨ <code>add_var</code> å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šå…ˆç”¨ <code>find_var</code> æŸ¥æ‰¾å˜é‡ã€‚å¦‚æœå­˜åœ¨ä¸”éåªè¯»ï¼Œåˆ™æ›´æ–°ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åœ¨ <code>shell_vars</code> æ•°ç»„ä¸­æ‰¾ä¸€ä¸ªç©ºä½åˆ›å»ºã€‚</li><li><code>unset</code>ï¼šè°ƒç”¨ <code>remove_var</code>ï¼Œè¯¥å‡½æ•°ä¼šæŸ¥æ‰¾å˜é‡ï¼Œå¦‚æœå­˜åœ¨ä¸”éåªè¯»ï¼Œåˆ™å°†å…¶ä»æ•°ç»„ä¸­ç§»é™¤ã€‚</li><li><code>$</code> å˜é‡å±•å¼€ï¼šåœ¨æ‰§è¡Œå‘½ä»¤å‰ï¼Œå¢åŠ ä¸€ä¸ª <code>expand_vars</code> é˜¶æ®µã€‚è¯¥å‡½æ•°éå†å‘½ä»¤è¡Œå­—ç¬¦ä¸²ï¼ŒæŸ¥æ‰¾ <code>$</code> ç¬¦å·ï¼Œæå–åé¢çš„å˜é‡åï¼Œç”¨ <code>find_var</code> æŸ¥æ‰¾å…¶å€¼ï¼Œå¹¶å°† <code>$</code> å’Œå˜é‡åæ›¿æ¢ä¸ºå…¶å€¼ã€‚</li></ul></li></ol><h3 id="2-2-å…³é”®ä»£ç "><a href="#2-2-å…³é”®ä»£ç " class="headerlink" title="2.2 å…³é”®ä»£ç "></a><strong>2.2 å…³é”®ä»£ç </strong></h3><p><strong>å˜é‡æ•°æ®ç»“æ„ä¸ç®¡ç† (<code>user/include/var.h</code>, <code>user/lib/var.c</code>)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user/include/var.h</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> name[MAX_VAR_NAME_LEN + <span class="number">1</span>];</span><br><span class="line">    <span class="type">char</span> value[MAX_VAR_VALUE_LEN + <span class="number">1</span>];</span><br><span class="line">    u_int is_env : <span class="number">1</span>;</span><br><span class="line">    u_int is_readonly : <span class="number">1</span>;</span><br><span class="line">    u_int is_used : <span class="number">1</span>;</span><br><span class="line">&#125; Var;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> Var shell_vars[MAX_VARS];</span><br><span class="line"></span><br><span class="line"><span class="comment">// user/lib/var.c</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">add_var</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *name, <span class="type">const</span> <span class="type">char</span> *value, u_int is_env, u_int is_readonly)</span> &#123;</span><br><span class="line">    Var *var = find_var(name);</span><br><span class="line">    <span class="keyword">if</span> (var) &#123; <span class="comment">// å˜é‡å·²å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> (var-&gt;is_readonly) &#123; <span class="comment">/* ... é”™è¯¯å¤„ç† ... */</span> &#125;</span><br><span class="line">        <span class="built_in">strcpy</span>(var-&gt;value, value ? value : <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">// ... æ›´æ–°å±æ€§ ...</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// å˜é‡ä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> (num_shell_vars &gt;= MAX_VARS) &#123; <span class="comment">/* ... é”™è¯¯å¤„ç† ... */</span> &#125;</span><br><span class="line">        <span class="comment">// ... æ‰¾ç©ºä½å¹¶åˆ›å»º ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><code>declare</code> å‘½ä»¤å¤„ç† (<code>user/sh.c</code>)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">handle_declare</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    u_int is_env = <span class="number">0</span>, is_readonly = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ... è§£æ -x, -r é€‰é¡¹ ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è§£æ NAME[=VALUE]</span></span><br><span class="line">    <span class="keyword">for</span> (; i &lt; argc; i++) &#123;</span><br><span class="line">        <span class="type">char</span> *name = argv[i];</span><br><span class="line">        <span class="type">char</span> *value = <span class="built_in">strchr</span>(name, <span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (value) &#123;</span><br><span class="line">            *value = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// åˆ†å‰² name å’Œ value</span></span><br><span class="line">            value++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (add_var(name, value, is_env, is_readonly) != <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å˜é‡å±•å¼€ (<code>user/sh.c</code>)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">expand_vars</span><span class="params">(<span class="type">char</span> *in_buf, <span class="type">char</span> *out_buf, <span class="type">int</span> out_size)</span> &#123;</span><br><span class="line">    <span class="type">char</span> *p_in = in_buf;</span><br><span class="line">    <span class="type">char</span> *p_out = out_buf;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">while</span> (*p_in &amp;&amp; p_out &lt; end) &#123;</span><br><span class="line">        <span class="keyword">if</span> (*p_in == <span class="string">&#x27;$&#x27;</span>) &#123;</span><br><span class="line">            p_in++; <span class="comment">// è·³è¿‡ &#x27;$&#x27;</span></span><br><span class="line">            <span class="type">char</span> var_name[MAX_VAR_NAME_LEN + <span class="number">1</span>];</span><br><span class="line">            <span class="comment">// ... æå–å˜é‡å ...</span></span><br><span class="line">            </span><br><span class="line">            Var *v = find_var(var_name);</span><br><span class="line">            <span class="keyword">if</span> (v) &#123;</span><br><span class="line">                <span class="comment">// ... å°† v-&gt;value æ‹·è´åˆ° out_buf ...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            *p_out++ = *p_in++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *p_out = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ main å¾ªç¯ä¸­è°ƒç”¨</span></span><br><span class="line">expand_vars(current_chunk_start, expanded_buf, <span class="keyword">sizeof</span>(expanded_buf));</span><br></pre></td></tr></table></figure><h2 id="3-è¾“å…¥æŒ‡ä»¤ä¼˜åŒ–"><a href="#3-è¾“å…¥æŒ‡ä»¤ä¼˜åŒ–" class="headerlink" title="3. è¾“å…¥æŒ‡ä»¤ä¼˜åŒ–"></a><strong>3. è¾“å…¥æŒ‡ä»¤ä¼˜åŒ–</strong></h2><h3 id="3-1-è®¾è®¡æ€è·¯"><a href="#3-1-è®¾è®¡æ€è·¯" class="headerlink" title="3.1 è®¾è®¡æ€è·¯"></a><strong>3.1 è®¾è®¡æ€è·¯</strong></h3><p>ä¸ºäº†å®ç°é«˜çº§çš„è¡Œç¼–è¾‘åŠŸèƒ½ï¼Œå¿…é¡»æ”¾å¼ƒç®€å•çš„ã€å¸¦å›æ˜¾çš„ <code>read</code> ç³»ç»Ÿè°ƒç”¨ï¼Œè½¬è€Œä½¿ç”¨æ›´åº•å±‚çš„ã€æ— å›æ˜¾çš„å­—ç¬¦è·å–æ–¹å¼ï¼Œå¹¶ç”± Shell è‡ªå·±å®Œå…¨æ§åˆ¶ç»ˆç«¯çš„å›æ˜¾å’Œå…‰æ ‡ç§»åŠ¨ã€‚</p><ol><li><p><strong>æŒ‡ä»¤è‡ªç”±è¾“å…¥</strong>ï¼š</p><ol><li><strong>åº•å±‚è¾“å…¥</strong>ï¼šä½¿ç”¨ <code>syscall_cgetc()</code> è·å–å•ä¸ªå­—ç¬¦ï¼Œè¯¥è°ƒç”¨ä¸é˜»å¡ä¸”æ— å›æ˜¾ã€‚</li><li><strong>çŠ¶æ€ç»´æŠ¤</strong>ï¼šåœ¨ <code>readline</code> å‡½æ•°ä¸­ï¼Œç»´æŠ¤ä¸¤ä¸ªæ ¸å¿ƒçŠ¶æ€ï¼š<code>len</code>ï¼ˆå½“å‰è¾“å…¥ç¼“å†²åŒºçš„æ€»é•¿åº¦ï¼‰å’Œ <code>cursor_pos</code>ï¼ˆå…‰æ ‡åœ¨ç¼“å†²åŒºä¸­çš„é€»è¾‘ä½ç½®ï¼‰ã€‚</li><li><strong>å¤„ç†æ™®é€šå­—ç¬¦</strong>ï¼šæ¥æ”¶åˆ°å¯æ‰“å°å­—ç¬¦æ—¶ï¼Œåœ¨ <code>cursor_pos</code> å¤„å°†å…¶æ’å…¥ç¼“å†²åŒºï¼ˆéœ€è¦ç§»åŠ¨åç»­å­—ç¬¦ï¼‰ï¼Œç„¶åæ‰“å°è¯¥å­—ç¬¦ï¼Œå¹¶ä½¿ç”¨ ANSI è½¬ä¹‰åºåˆ—é‡ç»˜å…‰æ ‡ä¹‹åçš„å†…å®¹ï¼Œæœ€åå°†å…‰æ ‡ç§»å›æ­£ç¡®ä½ç½®ã€‚</li></ol></li><li><p><strong>ä¸å¸¦ <code>.b</code> åç¼€</strong>ï¼šåœ¨ <code>spawn</code> å‡½æ•°ä¸­ï¼Œå½“å°è¯•æ‰§è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œå¦‚æœç›´æ¥ <code>spawn</code> å¤±è´¥ï¼Œå¹¶ä¸”ç¨‹åºåä¸ä»¥ <code>.b</code> ç»“å°¾ï¼Œå°±ä¸ºå…¶æ‹¼æ¥ä¸Š <code>.b</code> åç¼€å†å°è¯•ä¸€æ¬¡ã€‚</p></li><li><p><strong>å¿«æ·é”®</strong>ï¼š</p><ul><li><strong>æ–¹å‘é”®</strong>ï¼šå®ƒä»¬æ˜¯ ANSI è½¬ä¹‰åºåˆ—ï¼ˆå¦‚ <code>\x1b[A</code>ï¼‰ã€‚<code>readline</code> ä¸­æœ‰ä¸€ä¸ªçŠ¶æ€æœºæ¥æ•è·è¿™äº›åºåˆ—ã€‚</li><li><strong>é€€æ ¼é”®</strong>ï¼šä¿®æ”¹ç¼“å†²åŒºå’Œ <code>len</code>ã€<code>cursor_pos</code>ï¼Œå¹¶å‘ç»ˆç«¯å‘é€â€œé€€æ ¼-ç©ºæ ¼-é€€æ ¼â€åºåˆ—æ¥æ“¦é™¤å­—ç¬¦ï¼Œç„¶åé‡ç»˜å…‰æ ‡åçš„å†…å®¹ã€‚</li><li><strong>Ctrl-A&#x2F;E&#x2F;K&#x2F;U&#x2F;W</strong>ï¼šæ¯ä¸ªå¿«æ·é”®éƒ½å¯¹åº”ä¸€å¥—å¯¹ç¼“å†²åŒº <code>buf</code> å’Œ <code>len</code>ã€<code>cursor_pos</code> çš„é€»è¾‘æ“ä½œï¼Œä»¥åŠä¸€å¥—ç›¸åº”çš„ç»ˆç«¯æ§åˆ¶æŒ‡ä»¤ï¼ˆå¦‚æ¸…å± <code>\x1b[K</code>ï¼Œå…‰æ ‡ç§»åŠ¨ <code>\r</code>, <code>\x1b[nC</code>ï¼‰æ¥æ›´æ–°å±å¹•æ˜¾ç¤ºã€‚</li></ul></li><li><p><strong>å†å²æŒ‡ä»¤</strong>ï¼šä½¿ç”¨ä¸€ä¸ªå…¨å±€æ•°ç»„ <code>history_lines</code> å­˜å‚¨å†å²å‘½ä»¤ã€‚<code>load_history</code> å’Œ <code>add_to_history</code> å‡½æ•°è´Ÿè´£ä» <code>/.mos_history</code> æ–‡ä»¶ä¸­è¯»å†™å†å²è®°å½•ã€‚</p></li><li><p>**æ³¨é‡Š **ï¼šæˆ‘è®¾è®¡äº†ä¸€ä¸ªè¾…åŠ©å‡½æ•° <code>find_and_split</code> ã€‚è¿™ä¸ªå‡½æ•°è´Ÿè´£ä»å½“å‰å‘½ä»¤æŒ‡é’ˆå¼€å§‹ï¼ŒæŸ¥æ‰¾ç¬¬ä¸€ä¸ªå‡ºç°çš„æœ‰å…³å­—ç¬¦ã€‚å…¶ä¸­ï¼Œ<code>#</code> è¢«è§†ä¸ºè¡Œå°¾ï¼Œå®ƒä¼šç«‹å³åœæ­¢å¯¹å½“å‰å‘½ä»¤å—çš„è§£æã€‚</p></li><li><p><strong>åå¼•å·æ›¿æ¢</strong>ï¼š</p><ul><li>åœ¨å˜é‡å±•å¼€ä¹‹åã€å‘½ä»¤æ‰§è¡Œä¹‹å‰ï¼Œå¢åŠ ä¸€ä¸ªåå¼•å·å¤„ç†é˜¶æ®µã€‚</li><li>è¯¥é˜¶æ®µéå†å‘½ä»¤å­—ç¬¦ä¸²ï¼ŒæŸ¥æ‰¾æˆå¯¹çš„ <code>`</code>ã€‚</li><li>å¯¹äºæ¯ä¸ª <code>`...`</code> å—ï¼Œæå–å…¶ä¸­çš„å­å‘½ä»¤ã€‚</li><li>åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå­è¿›ç¨‹æ‰§è¡Œå­å‘½ä»¤åé€šè¿‡ç®¡é“æŠŠæ‰§è¡Œåçš„ç»“æœä¼ ç»™çˆ¶è¿›ç¨‹ã€‚</li></ul></li><li><p><strong>ä¸€è¡Œå¤šæŒ‡ä»¤</strong>ï¼šä¸ºäº†æ”¯æŒåœ¨ä¸€è¡Œä¸­é€šè¿‡ <code>;</code> åˆ†éš”æ‰§è¡Œå¤šä¸ªç‹¬ç«‹çš„å‘½ä»¤ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯å°†å®Œæ•´çš„å‘½ä»¤è¡Œå­—ç¬¦ä¸²åˆ†å‰²æˆå¤šä¸ªç‹¬ç«‹çš„å‘½ä»¤å—ï¼Œç„¶åæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚</p><ol><li><strong>å‘½ä»¤å—åˆ†å‰²</strong>ï¼šåœ¨ <code>find_and_split</code> å½“æ‰¾åˆ°ä¸€ä¸ª <code>;</code> æ—¶ï¼Œå®ƒä¼šå°†è¯¥ä½ç½®çš„å­—ç¬¦æ›¿æ¢ä¸º <code>\0</code>ï¼Œä»è€Œæœ‰æ•ˆåœ°å°†ä¸€ä¸ªé•¿å‘½ä»¤å­—ç¬¦ä¸²â€œæˆªæ–­â€æˆä¸€ä¸ªç‹¬ç«‹çš„å‘½ä»¤å—ã€‚åŒæ—¶ï¼Œå‡½æ•°è¿”å›ä¸‹ä¸€ä¸ªå‘½ä»¤å—çš„èµ·å§‹ä½ç½®ã€‚</li><li><strong>å¾ªç¯æ‰§è¡Œ</strong>ï¼šåœ¨ <code>sh.c</code> çš„ <code>main</code> å‡½æ•°ä¸­ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ªä¸» <code>while</code> å¾ªç¯ã€‚è¿™ä¸ªå¾ªç¯ä¸æ–­åœ°è°ƒç”¨ <code>find_and_split</code> æ¥è·å–ä¸‹ä¸€ä¸ªå‘½ä»¤å—ã€‚è·å–åˆ°å‘½ä»¤å—åï¼Œå°±ç«‹å³å¯¹å…¶è¿›è¡Œå˜é‡å±•å¼€ã€åå¼•å·æ›¿æ¢ï¼Œå¹¶æœ€ç»ˆé€šè¿‡ <code>fork</code> å’Œ <code>runcmd</code>ï¼ˆæˆ–ç›´æ¥æ‰§è¡Œå†…ç½®å‘½ä»¤ï¼‰æ¥æ‰§è¡Œå®ƒã€‚</li></ol><p> é€šè¿‡è¿™ç§â€œåˆ†å‰²-æ‰§è¡Œâ€çš„å¾ªç¯æ¨¡å¼ï¼ŒShell èƒ½å¤Ÿå¤„ç†åŒ…å«ä»»æ„å¤šä¸ªç”± <code>;</code> åˆ†éš”çš„æŒ‡ä»¤è¡Œã€‚</p></li></ol><h3 id="3-2-å…³é”®ä»£ç "><a href="#3-2-å…³é”®ä»£ç " class="headerlink" title="3.2 å…³é”®ä»£ç "></a><strong>3.2 å…³é”®ä»£ç </strong></h3><p><strong>è‡ªç”±è¾“å…¥ä¸å¿«æ·é”® (<code>user/sh.c: readline</code>)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">readline</span><span class="params">(<span class="type">char</span> *buf, u_int n)</span> &#123;</span><br><span class="line"><span class="type">int</span> cursor_pos = <span class="number">0</span>; <span class="comment">// å…‰æ ‡åœ¨ç¼“å†²åŒºä¸­çš„é€»è¾‘ä½ç½®</span></span><br><span class="line"><span class="type">int</span> len = <span class="number">0</span>;        <span class="comment">// ç¼“å†²åŒºä¸­å½“å‰å‘½ä»¤çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">while</span> ((c = syscall_cgetc()) == <span class="number">0</span>) &#123; <span class="comment">// æ— å›æ˜¾è·å–å­—ç¬¦</span></span><br><span class="line">syscall_yield();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (c == <span class="string">&#x27;\b&#x27;</span> || c == <span class="number">0x7f</span>) &#123; <span class="comment">// é€€æ ¼é”®</span></span><br><span class="line"><span class="comment">// å®ç°å›æ˜¾æ“¦é™¤</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">&#x27;\x1b&#x27;</span>) &#123; <span class="comment">// ANSIè½¬ä¹‰åºåˆ— (ç®­å¤´ç­‰)</span></span><br><span class="line"><span class="comment">// æ ¹æ®è½¬ä¹‰åºåˆ—åˆ¤æ–­å¿«æ·é”®ç±»å‹å¹¶æ‰§è¡Œå¯¹åº”æ“ä½œ</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// æ™®é€šå­—ç¬¦</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, c); <span class="comment">// æ‰‹åŠ¨å›æ˜¾</span></span><br><span class="line">            <span class="comment">// ... é€»è¾‘æ’å…¥å¹¶é‡ç»˜å…‰æ ‡åå†…å®¹ ...</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>find_and_splitå‡½æ•°</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">find_and_split</span><span class="params">(<span class="type">char</span> *s, <span class="type">char</span> *op)</span> &#123;</span><br><span class="line"><span class="type">char</span> *p = s;</span><br><span class="line"><span class="keyword">while</span> (*p) &#123;</span><br><span class="line"><span class="keyword">if</span> (p[<span class="number">0</span>] == <span class="string">&#x27;#&#x27;</span>) &#123; </span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (p[<span class="number">0</span>] == <span class="string">&#x27;&amp;&#x27;</span> &amp;&amp; p[<span class="number">1</span>] == <span class="string">&#x27;&amp;&#x27;</span>) &#123;</span><br><span class="line">*op = <span class="string">&#x27;&amp;&#x27;</span>;</span><br><span class="line">*p = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (p[<span class="number">0</span>] == <span class="string">&#x27;|&#x27;</span> &amp;&amp; p[<span class="number">1</span>] == <span class="string">&#x27;|&#x27;</span>) &#123;</span><br><span class="line">*op = <span class="string">&#x27;o&#x27;</span>;</span><br><span class="line">*p = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (p[<span class="number">0</span>] == <span class="string">&#x27;;&#x27;</span>) &#123;</span><br><span class="line">*op = <span class="string">&#x27;;&#x27;</span>;</span><br><span class="line">*p = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line">p++;</span><br><span class="line">&#125;</span><br><span class="line">*op = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¯¥å‡½æ•°è´Ÿè´£æŸ¥æ‰¾å‘½ä»¤ä¸­çš„ <code>&amp;&amp;</code>ï¼Œ<code>||</code>ï¼Œ<code>#</code> å’Œ <code>;</code></li></ul><h2 id="4-æŒ‡ä»¤æ¡ä»¶æ‰§è¡Œ"><a href="#4-æŒ‡ä»¤æ¡ä»¶æ‰§è¡Œ" class="headerlink" title="4. æŒ‡ä»¤æ¡ä»¶æ‰§è¡Œ"></a><strong>4. æŒ‡ä»¤æ¡ä»¶æ‰§è¡Œ</strong></h2><h3 id="4-1-è®¾è®¡æ€è·¯"><a href="#4-1-è®¾è®¡æ€è·¯" class="headerlink" title="4.1 è®¾è®¡æ€è·¯"></a><strong>4.1 è®¾è®¡æ€è·¯</strong></h3><p>æˆ‘æŠŠ Shell çš„ä¸»å¾ªç¯è®¾è®¡æˆäº†ä¸€ä¸ªèƒ½å¤„ç†å¤æ‚å‘½ä»¤è¡Œçš„çŠ¶æ€æœºã€‚</p><ol><li><p>   <strong>å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œ</strong>ï¼š</p><ul><li><strong><code>;</code></strong>ï¼š <code>find_and_split</code> æ¥æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå‘½ä»¤åˆ†éš”ç¬¦ï¼ˆ<code>&amp;&amp;</code>, <code>||</code>ï¼‰ã€‚å®ƒå°†å‘½ä»¤å­—ç¬¦ä¸²åœ¨åˆ†éš”ç¬¦å¤„ç”¨ <code>\0</code> æˆªæ–­ï¼Œå½¢æˆä¸€ä¸ªä¸ªå‘½ä»¤å—ã€‚</li><li><strong><code>&amp;&amp;</code> å’Œ <code>||</code></strong>ï¼šä¸»å¾ªç¯ç»´æŠ¤ä¸€ä¸ª <code>last_status</code> (ä¸Šä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºç ) å’Œ <code>should_run_next</code> (æ˜¯å¦åº”æ‰§è¡Œä¸‹ä¸€ä¸ªå‘½ä»¤) çš„çŠ¶æ€ã€‚</li></ul></li><li><p><strong><code>exit</code> è¿”å›çŠ¶æ€</strong>ï¼šæˆ‘ä¿®æ”¹äº†åŸæœ‰çš„ <code>exit()</code> å‡½æ•°ï¼Œä½¿å…¶èƒ½å¤Ÿæ”¯æŒè·å¾—å‘½ä»¤æ‰§è¡Œçš„è¿”å›å€¼ã€‚</p></li></ol><h2 id="5-æ›´å¤šæŒ‡ä»¤"><a href="#5-æ›´å¤šæŒ‡ä»¤" class="headerlink" title="5. æ›´å¤šæŒ‡ä»¤"></a><strong>5. æ›´å¤šæŒ‡ä»¤</strong></h2><h3 id="5-1-è®¾è®¡æ€è·¯"><a href="#5-1-è®¾è®¡æ€è·¯" class="headerlink" title="5.1 è®¾è®¡æ€è·¯"></a><strong>5.1 è®¾è®¡æ€è·¯</strong></h3><ol><li><strong><code>touch</code>, <code>mkdir</code>, <code>rm</code></strong>:<ul><li>è¿™äº›å‘½ä»¤éƒ½æ˜¯ç‹¬ç«‹çš„å¯æ‰§è¡Œç¨‹åº (<code>touch.c</code>, <code>mkdir.c</code>, <code>rm.c</code>)ã€‚</li><li>å®ƒä»¬é€šè¿‡ <code>main</code> å‡½æ•°çš„ <code>argc</code>, <code>argv</code> è§£æå‘½ä»¤è¡Œå‚æ•°ï¼ˆå¦‚ <code>rm -rf</code>ï¼‰ã€‚</li><li>å†…éƒ¨è°ƒç”¨ç›¸åº”çš„åº“å‡½æ•°ï¼ˆæœ€ç»ˆæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼‰æ¥å®Œæˆæ“ä½œï¼š<ul><li><code>touch</code>: ä½¿ç”¨ <code>open</code> çš„ <code>O_CREAT</code> æ ‡å¿—ã€‚</li><li><code>mkdir</code>: ä½¿ç”¨æ–°å¢çš„ <code>fsipc_mkdir</code> -&gt; <code>serve_mkdir</code> -&gt; <code>file_create_dir</code> æµç¨‹ã€‚<code>-p</code> é€‰é¡¹é€šè¿‡é€’å½’è°ƒç”¨ <code>mkdir_p</code> å®ç°ã€‚</li><li><code>rm</code>: <code>stat</code> åˆ¤æ–­æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ã€‚å¯¹æ–‡ä»¶è°ƒç”¨ <code>remove</code>ã€‚å¯¹ç›®å½•ï¼Œå¦‚æœå¸¦ <code>-r</code>ï¼Œåˆ™é€’å½’éå†å¹¶åˆ é™¤å†…å®¹ï¼Œæœ€ååˆ é™¤è‡ªèº«ã€‚</li></ul></li></ul></li><li><strong><code>exit</code></strong>:<ul><li>è¿™æ˜¯ä¸€ä¸ªå†…ç½®å‘½ä»¤ï¼Œå› ä¸ºå®ƒéœ€è¦ç»ˆæ­¢å½“å‰çš„ Shell è¿›ç¨‹ã€‚</li><li><code>handle_exit</code> è§£æå¯é€‰çš„æ•°å­—å‚æ•°ï¼Œç„¶åè°ƒç”¨ <code>syscall_exit(code)</code> é€€å‡ºã€‚</li></ul></li></ol><h2 id="6-å®ç°è¿½åŠ é‡å®šå‘"><a href="#6-å®ç°è¿½åŠ é‡å®šå‘" class="headerlink" title="6. å®ç°è¿½åŠ é‡å®šå‘"></a><strong>6. å®ç°è¿½åŠ é‡å®šå‘</strong></h2><h3 id="6-1-å®ç°æ€è·¯"><a href="#6-1-å®ç°æ€è·¯" class="headerlink" title="6.1 å®ç°æ€è·¯"></a><strong>6.1 å®ç°æ€è·¯</strong></h3><p><strong>è¿½åŠ é‡å®šå‘</strong>:</p><ul><li>åœ¨ <code>_gettoken</code> ä¸­å¢åŠ å¯¹ <code>&gt;&gt;</code> çš„è¯†åˆ«ï¼Œè¿”å›ä¸€ä¸ªç‰¹æ®Šçš„ tokenã€‚</li><li>åœ¨ <code>parsecmd</code> ä¸­ï¼Œä¸ºè¿™ä¸ªæ–°çš„ token å¢åŠ ä¸€ä¸ª caseã€‚</li><li>å½“é‡åˆ° <code>&gt;&gt;</code> æ—¶ï¼Œä½¿ç”¨ <code>open</code> çš„ <code>O_WRONLY | O_CREAT | O_APPEND</code> æ ‡å¿—æ‰“å¼€æ–‡ä»¶ã€‚<code>O_APPEND</code> æ˜¯å…³é”®ï¼Œå®ƒå‘Šè¯‰æ–‡ä»¶ç³»ç»Ÿåç»­çš„ <code>write</code> æ“ä½œéƒ½åœ¨æ–‡ä»¶æœ«å°¾è¿›è¡Œã€‚</li><li>åœ¨ <code>user/lib/fd.c</code> çš„ <code>write</code> å‡½æ•°ä¸­ï¼Œä¹Ÿå¢åŠ äº†å¯¹ <code>O_APPEND</code> æ¨¡å¼çš„æ£€æŸ¥ï¼Œåœ¨æ¯æ¬¡å†™å…¥å‰ï¼Œå…ˆ <code>seek</code> åˆ°æ–‡ä»¶æœ«å°¾ã€‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h1><p>æœ¬æ¬¡å®éªŒæˆåŠŸåœ°å°† MOS çš„ Shell ä»ä¸€ä¸ªç®€å•çš„å‘½ä»¤æ‰§è¡Œå™¨ï¼Œè½¬å˜ä¸ºä¸€ä¸ªå…·å¤‡ç°ä»£ Shell è¯¸å¤šæ ¸å¿ƒåŠŸèƒ½çš„å¼ºå¤§å·¥å…·ã€‚é€šè¿‡å®ç°CWDç®¡ç†ã€ç¯å¢ƒå˜é‡ã€è¡Œç¼–è¾‘ã€å†å²å‘½ä»¤ã€é«˜çº§å‘½ä»¤æµæ§åˆ¶ç­‰åŠŸèƒ½ï¼Œä¸ä»…æå¤§åœ°æå‡äº† MOS çš„å¯ç”¨æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œåœ¨å®è·µä¸­æ·±å…¥ç†è§£äº†æ“ä½œç³»ç»Ÿä¸­è¿›ç¨‹çŠ¶æ€ç®¡ç†ã€å†…å­˜å…±äº«ã€IPCã€æ–‡ä»¶ç³»ç»Ÿäº¤äº’ç­‰æ ¸å¿ƒæ¦‚å¿µçš„åº•å±‚å®ç°ç»†èŠ‚ã€‚æ•´ä¸ªè¿‡ç¨‹å……æ»¡æŒ‘æˆ˜ï¼Œä½†ä¹Ÿæ”¶è·é¢‡ä¸°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_Lab6_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/06/14/OS-Lab6/BUAA_OS_Lab6%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/06/14/OS-Lab6/BUAA_OS_Lab6%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="BUAA-OS-Lab6-å®éªŒæŠ¥å‘Š"><a href="#BUAA-OS-Lab6-å®éªŒæŠ¥å‘Š" class="headerlink" title="BUAA_OS_Lab6 å®éªŒæŠ¥å‘Š"></a>BUAA_OS_Lab6 å®éªŒæŠ¥å‘Š</h1><h2 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h2><h3 id="Thinking-6-1"><a href="#Thinking-6-1" class="headerlink" title="Thinking 6.1"></a>Thinking 6.1</h3><blockquote><p>ç¤ºä¾‹ä»£ç ä¸­ï¼Œçˆ¶è¿›ç¨‹æ“ä½œç®¡é“çš„å†™ç«¯ï¼Œå­è¿›ç¨‹æ“ä½œç®¡é“çš„è¯»ç«¯ã€‚å¦‚æœç°åœ¨æƒ³è®©çˆ¶è¿›ç¨‹ä½œä¸ºâ€œè¯»è€…â€ï¼Œä»£ç åº”å½“å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p></blockquote><p>ä¿®æ”¹å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (fork()) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">/* å­è¿›ç¨‹ - ä½œä¸ºç®¡é“çš„å†™è€… */</span></span><br><span class="line">        close(fildes[<span class="number">0</span>]); <span class="comment">/* å…³é—­ä¸ç”¨çš„è¯»ç«¯ */</span></span><br><span class="line">        write(fildes[<span class="number">1</span>], <span class="string">&quot;Hello world\n&quot;</span>, <span class="number">12</span>); <span class="comment">/* å‘ç®¡é“ä¸­å†™æ•°æ® */</span></span><br><span class="line">        close(fildes[<span class="number">1</span>]); <span class="comment">/* å†™å…¥ç»“æŸï¼Œå…³é—­å†™ç«¯ */</span></span><br><span class="line">        <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">default</span>: <span class="comment">/* çˆ¶è¿›ç¨‹ - ä½œä¸ºç®¡é“çš„å†™è€… */</span></span><br><span class="line">        close(fildes[<span class="number">1</span>]); <span class="comment">/* å…³é—­ä¸ç”¨çš„å†™ç«¯ */</span></span><br><span class="line">        read(fildes[<span class="number">0</span>], buf, <span class="number">100</span>); <span class="comment">/* ä»ç®¡é“ä¸­è¯»æ•°æ® */</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;father-process read:%s&quot;</span>,buf); <span class="comment">/* æ‰“å°è¯»åˆ°çš„æ•°æ® */</span></span><br><span class="line">        close(fildes[<span class="number">0</span>]); <span class="comment">/* è¯»å–ç»“æŸï¼Œå…³é—­è¯»ç«¯ */</span></span><br><span class="line">        <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Thinking-6-2"><a href="#Thinking-6-2" class="headerlink" title="Thinking 6.2"></a>Thinking 6.2</h3><blockquote><p>ä¸Šé¢è¿™ç§ä¸åŒæ­¥ä¿®æ”¹ pp_ref è€Œå¯¼è‡´çš„è¿›ç¨‹ç«äº‰é—®é¢˜åœ¨ user&#x2F;lib&#x2F;fd.c ä¸­çš„ dup å‡½æ•°ä¸­ä¹Ÿå­˜åœ¨ã€‚è¯·ç»“åˆä»£ç æ¨¡ä»¿ä¸Šè¿°æƒ…æ™¯ï¼Œåˆ†æä¸€ä¸‹æˆ‘ä»¬çš„ dup å‡½æ•°ä¸­ä¸ºä»€ä¹ˆä¼šå‡ºç°é¢„æƒ³ä¹‹å¤–çš„æƒ…å†µï¼Ÿ </p></blockquote><p>æ­¤å‰çš„<code>dup</code>å‡½æ•°æ˜¯å…ˆæ˜ å°„æ–‡ä»¶æè¿°ç¬¦ï¼Œå†æ˜ å°„æ–‡ä»¶å†…å®¹ã€‚å¦‚æœåœ¨æ˜ å°„å®Œæ–‡ä»¶æè¿°ç¬¦åï¼Œè¿›ç¨‹è¢«ä¸­æ–­ï¼Œé‚£ä¹ˆå¦ä¸€ç¨‹åºä¼šé”™è¯¯çš„è®¤ä¸ºæ–‡ä»¶æ˜ å°„å·²ç»å®Œæˆï¼Œäº§ç”Ÿé”™è¯¯ã€‚</p><h3 id="Thinking-6-3"><a href="#Thinking-6-3" class="headerlink" title="Thinking 6.3"></a>Thinking 6.3</h3><blockquote><p>é˜…è¯»ä¸Šè¿°ææ–™å¹¶æ€è€ƒï¼šä¸ºä»€ä¹ˆç³»ç»Ÿè°ƒç”¨ä¸€å®šæ˜¯åŸå­æ“ä½œå‘¢ï¼Ÿå¦‚æœä½ è§‰å¾—ä¸æ˜¯æ‰€æœ‰çš„ç³»ç»Ÿè°ƒç”¨éƒ½æ˜¯åŸå­æ“ä½œï¼Œè¯·ç»™å‡ºåä¾‹ã€‚å¸Œæœ›èƒ½ç»“åˆç›¸å…³ä»£ç è¿›è¡Œåˆ†æè¯´æ˜ã€‚ </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.macro CLI</span><br><span class="line">        mfc0    t0, CP0_STATUS</span><br><span class="line">        li      t1, (STATUS_CU0 | 0x1)</span><br><span class="line">        or      t0, t1</span><br><span class="line">        xor     t0, 0x1</span><br><span class="line">        mtc0    t0, CP0_STATUS</span><br><span class="line">.endm</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºï¼Œæ“ä½œç³»ç»Ÿåœ¨è¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œè¿›è¡Œäº†ä¸€ä¸ªçŸ­æš‚çš„å…³ä¸­æ–­ï¼Œæ‰€ä»¥ç³»ç»Ÿè°ƒç”¨æ˜¯åŸå­æ“ä½œ</p><h3 id="Thinking-6-4"><a href="#Thinking-6-4" class="headerlink" title="Thinking 6.4"></a>Thinking 6.4</h3><blockquote><p>ä»”ç»†é˜…è¯»ä¸Šé¢è¿™æ®µè¯ï¼Œå¹¶æ€è€ƒä¸‹åˆ—é—®é¢˜</p><ul><li>æŒ‰ç…§ä¸Šè¿°è¯´æ³•æ§åˆ¶ pipe_close ä¸­ fd å’Œ pipe unmap çš„é¡ºåºï¼Œæ˜¯å¦å¯ä»¥è§£å†³ä¸Šè¿°åœºæ™¯çš„è¿›ç¨‹ç«äº‰é—®é¢˜ï¼Ÿç»™å‡ºä½ çš„åˆ†æè¿‡ç¨‹ã€‚</li><li>æˆ‘ä»¬åªåˆ†æäº† close æ—¶çš„æƒ…å½¢ï¼Œåœ¨ fd.c ä¸­æœ‰ä¸€ä¸ª dup å‡½æ•°ï¼Œç”¨äºå¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ã€‚è¯•æƒ³ï¼Œå¦‚æœè¦å¤åˆ¶çš„æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘ä¸€ä¸ªç®¡é“ï¼Œé‚£ä¹ˆæ˜¯å¦ä¼šå‡ºç°ä¸ close ç±»ä¼¼çš„é—®é¢˜ï¼Ÿè¯·æ¨¡ä»¿ä¸Šè¿°ææ–™å†™å†™ä½ çš„ç†è§£ã€‚</li></ul></blockquote><p>å¯ä»¥è§£å†³ã€‚å…ˆå…³é—­ç¼“å†²åŒºåï¼Œç¼“å†²åŒºçš„å¼•ç”¨æ¬¡æ•°å°±å‘ç”Ÿäº†ä¿®æ”¹ã€‚æ­¤æ—¶ï¼Œå³ä½¿å‘ç”Ÿäº†ä¸­æ–­ï¼Œ<code>pipe</code>ä¹Ÿä¼šé˜»æ­¢è¯»å†™æ“ä½œã€‚<br>å¯ä»¥è§£å†³ã€‚å…ˆå»ºç«‹ç¼“å†²åŒºï¼Œæ­¤æ—¶<code>pipe</code>å°±å·²ç»å¯ä»¥è¿›è¡Œæ­£å¸¸çš„è¯»å†™åŠŸèƒ½äº†ã€‚</p><h3 id="Thinking-6-5"><a href="#Thinking-6-5" class="headerlink" title="Thinking 6.5"></a>Thinking 6.5</h3><blockquote><p>æ€è€ƒä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ã€‚</p><ul><li>è®¤çœŸå›çœ‹ Lab5 æ–‡ä»¶ç³»ç»Ÿç›¸å…³ä»£ç ï¼Œå¼„æ¸…æ‰“å¼€æ–‡ä»¶çš„è¿‡ç¨‹ã€‚</li><li>å›é¡¾ Lab1 ä¸ Lab3ï¼Œæ€è€ƒå¦‚ä½•è¯»å–å¹¶åŠ è½½ ELF æ–‡ä»¶ã€‚</li><li>å›é¡¾ Lab3 å¹¶æ€è€ƒï¼šelf_load_seg() å’Œ load_icode_mapper()å‡½æ•°æ˜¯å¦‚ä½•ç¡®ä¿åŠ è½½ ELF æ–‡ä»¶æ—¶ï¼Œbss æ®µæ•°æ®è¢«æ­£ç¡®åŠ è½½è¿›è™šæ‹Ÿå†…å­˜ç©ºé—´ã€‚bss æ®µåœ¨ ELF ä¸­å¹¶ä¸å ç©ºé—´ï¼Œä½† ELF åŠ è½½è¿›å†…å­˜åï¼Œbss æ®µçš„æ•°æ®å æ®äº†ç©ºé—´ï¼Œå¹¶ä¸”åˆå§‹å€¼éƒ½æ˜¯ 0ã€‚è¯·å›é¡¾ elf_load_seg() å’Œ load_icode_mapper() çš„å®ç°ï¼Œæ€è€ƒè¿™ä¸€ç‚¹æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</li></ul></blockquote><ul><li>é¦–å…ˆç”¨æˆ·è°ƒç”¨<code>user/lib/files.c</code>æ–‡ä»¶ä¸­çš„<code>open</code>å‡½æ•°ï¼Œç„¶å<code>open</code>å‡½æ•°è°ƒç”¨äº†<code>fsipc</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå‘æ–‡ä»¶ç³»ç»Ÿå‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶ç­‰å¾…è¿”å›çš„ä¿¡æ¯ã€‚æ–‡ä»¶ç³»ç»Ÿä¸­çš„<code>serve</code>å‡½æ•°ä¼šè°ƒç”¨<code>file_open</code>å‡½æ•°æ¥å®Œæˆæ–‡ä»¶çš„æ‰“å¼€æ“ä½œï¼Œå¹¶è¿”å›è¿”å›å€¼ã€‚</li><li>ELFæ–‡ä»¶ä¸­çš„æ®µä¿¡æ¯æ˜¯é€šè¿‡<code>Elf32_Phdr</code>ç»“æ„ä½“æ•°ç»„æ¥æè¿°çš„ï¼Œå…¶ä¸­åŒ…å«äº†å„ä¸ªæ®µçš„ç±»å‹ã€åœ¨æ–‡ä»¶ä¸­çš„åç§»ã€åœ¨å†…å­˜ä¸­çš„è™šæ‹Ÿåœ°å€ã€å¤§å°ç­‰ä¿¡æ¯ã€‚å¯¹äº<code>bss</code>æ®µï¼Œè™½ç„¶å®ƒåœ¨æ–‡ä»¶ä¸­ä¸å æ®å®é™…å­˜å‚¨ç©ºé—´ï¼Œä½†å®ƒåœ¨å†…å­˜ä¸­æœ‰ä¸€ä¸ªé¢„æœŸçš„å¤§å°ï¼Œç”¨äºå­˜æ”¾æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ï¼Œè¿™äº›å˜é‡é»˜è®¤å€¼ä¸º0ã€‚</li><li>åŠ è½½å™¨éå†ELFæ–‡ä»¶çš„å„ä¸ªæ®µå¹¶è°ƒç”¨<code>elf_load_seg0()</code>å¤„ç†å„ä¸ªæ®µçš„æ—¶å€™ï¼Œå…³é”®åœ¨äºå¦‚ä½•å¤„ç†<code>sgsize</code>å’Œ<code>bin_size</code>ä¹‹é—´çš„å·®å¼‚ï¼Œä¹Ÿå°±æ˜¯æ®µåœ¨å†…å­˜ä¸­çš„å¤§å°å’Œæ®µåœ¨æ–‡ä»¶ä¸­çš„å¤§å°ä¹‹é—´çš„å·®å¼‚ã€‚å¦‚æœæ®µæœ‰å®é™…çš„æ•°æ®å†…å®¹ï¼ˆ<code>.text</code>æˆ–<code>.data</code>ï¼‰ï¼Œ<code>elf_load_seg()</code>ä¼šé€šè¿‡è°ƒç”¨<code>load_icode_mapper()</code>å°†è¿™äº›å†…å®¹ä»æ–‡ä»¶å¤åˆ¶åˆ°å¯¹åº”çš„è™šæ‹Ÿå†…å­˜ä½ç½®ï¼›å¯¹äº<code>bss</code>æ®µï¼Œä¸æ–­åˆ†é…é¡µé¢ç›´åˆ°è¾¾åˆ°<code>sgsize</code>æŒ‡å®šçš„å¤§å°ï¼Œæ‰€ä»¥æ–°åˆ†é…çš„é¡µé¢ä¸ä¼šä»æ–‡ä»¶ä¸­å¤åˆ¶ä»»ä½•æ•°æ®ï¼Œä¿æŒå…¶å†…å®¹ä¸ºå…¨0ï¼Œè‡ªç„¶å°±è¢«åˆå§‹åŒ–ä¸ºå…¨ 0ã€‚</li></ul><h3 id="Thinking-6-6"><a href="#Thinking-6-6" class="headerlink" title="Thinking 6.6"></a>Thinking 6.6</h3><blockquote><p>é€šè¿‡é˜…è¯»ä»£ç ç©ºç™½æ®µçš„æ³¨é‡Šæˆ‘ä»¬çŸ¥é“ï¼Œå°†æ ‡å‡†è¾“å…¥æˆ–è¾“å‡ºå®šå‘åˆ°æ–‡ä»¶ï¼Œéœ€è¦æˆ‘ä»¬å°†å…¶ dup åˆ° 0 æˆ– 1 å·æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šåœ¨å“ªæ­¥ï¼Œ0 å’Œ 1 è¢«â€œå®‰æ’â€ä¸ºæ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºï¼Ÿè¯·åˆ†æä»£ç æ‰§è¡Œæµç¨‹ï¼Œç»™å‡ºç­”æ¡ˆã€‚ </p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stdin should be 0, because no file descriptors are open yet</span></span><br><span class="line"><span class="keyword">if</span> ((r = opencons()) != <span class="number">0</span>) &#123;</span><br><span class="line">    user_panic(<span class="string">&quot;opencons: %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// stdout</span></span><br><span class="line"><span class="keyword">if</span> ((r = dup(<span class="number">0</span>, <span class="number">1</span>)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    user_panic(<span class="string">&quot;dup: %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯<code>user/init.c</code>çš„ä»£ç ç‰‡æ®µã€‚</p><h3 id="Thinking-6-7"><a href="#Thinking-6-7" class="headerlink" title="Thinking 6.7"></a>Thinking 6.7</h3><blockquote><p>åœ¨ shell ä¸­æ‰§è¡Œçš„å‘½ä»¤åˆ†ä¸ºå†…ç½®å‘½ä»¤å’Œå¤–éƒ¨å‘½ä»¤ã€‚åœ¨æ‰§è¡Œå†…ç½®å‘½ä»¤æ—¶ shell ä¸éœ€è¦ fork ä¸€ä¸ªå­ shellï¼Œå¦‚ Linux ç³»ç»Ÿä¸­çš„ cd å‘½ä»¤ã€‚åœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ shell éœ€è¦ forkä¸€ä¸ªå­ shellï¼Œç„¶åå­ shell å»æ‰§è¡Œè¿™æ¡å‘½ä»¤ã€‚</p><p>æ®æ­¤åˆ¤æ–­ï¼Œåœ¨ MOS ä¸­æˆ‘ä»¬ç”¨åˆ°çš„ shell å‘½ä»¤æ˜¯å†…ç½®å‘½ä»¤è¿˜æ˜¯å¤–éƒ¨å‘½ä»¤ï¼Ÿè¯·æ€è€ƒä¸ºä»€ä¹ˆLinux çš„ cd å‘½ä»¤æ˜¯å†…éƒ¨å‘½ä»¤è€Œä¸æ˜¯å¤–éƒ¨å‘½ä»¤ï¼Ÿ</p></blockquote><p><code>cd</code>å‘½ä»¤ç”¨äºæ”¹å˜å½“å‰å·¥ä½œç›®å½•ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸ shell ä¼šè¯çŠ¶æ€ç´§å¯†ç›¸å…³çš„æ“ä½œã€‚ä½œä¸ºå†…éƒ¨å‘½ä»¤ï¼Œå®ƒå¯ä»¥ç¡®ä¿æ”¹å˜ç«‹å³ç”Ÿæ•ˆå¹¶å½±å“åç»­å‘½ä»¤çš„æ‰§è¡Œç¯å¢ƒã€‚</p><h3 id="Thinking-6-8"><a href="#Thinking-6-8" class="headerlink" title="Thinking 6.8"></a>Thinking 6.8</h3><blockquote><p>åœ¨ä½ çš„ shell ä¸­è¾“å…¥å‘½ä»¤ ls.b | cat.b &gt; motdã€‚</p><ul><li>è¯·é—®ä½ å¯ä»¥åœ¨ä½ çš„ shell ä¸­è§‚å¯Ÿåˆ°å‡ æ¬¡ spawn ï¼Ÿåˆ†åˆ«å¯¹åº”å“ªä¸ªè¿›ç¨‹ï¼Ÿ</li><li>è¯·é—®ä½ å¯ä»¥åœ¨ä½ çš„ shell ä¸­è§‚å¯Ÿåˆ°å‡ æ¬¡è¿›ç¨‹é”€æ¯ï¼Ÿåˆ†åˆ«å¯¹åº”å“ªä¸ªè¿›ç¨‹ï¼Ÿ</li></ul></blockquote><p>å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$</span> ls.b | cat.b &gt; motd</span><br><span class="line">[00002803] pipecreate </span><br><span class="line">[00003805] destroying 00003805</span><br><span class="line">[00003805] free env 00003805</span><br><span class="line">i am killed ... </span><br><span class="line">[00004006] destroying 00004006</span><br><span class="line">[00004006] free env 00004006</span><br><span class="line">i am killed ... </span><br><span class="line">[00003004] destroying 00003004</span><br><span class="line">[00003004] free env 00003004</span><br><span class="line">i am killed ... </span><br><span class="line">[00002803] destroying 00002803</span><br><span class="line">[00002803] free env 00002803</span><br><span class="line">i am killed ... </span><br></pre></td></tr></table></figure><p>ä¸€å…±æœ‰ä¸¤æ¬¡<code>spawn</code>ï¼Œä¸€æ¬¡å¯åŠ¨<code>ls.b</code>ï¼Œå¦ä¸€æ¬¡å¯åŠ¨<code>cat.b</code></p><p>ä¸€å…±æœ‰å››æ¬¡è¿›ç¨‹é”€æ¯</p><h2 id="å®éªŒæ€»ç»“"><a href="#å®éªŒæ€»ç»“" class="headerlink" title="å®éªŒæ€»ç»“"></a>å®éªŒæ€»ç»“</h2><p>Lab6 çš„æ ¸å¿ƒæ˜¯å®ç° Shell å’Œç®¡é“é€šä¿¡ã€‚è¿™ä¸ªå®éªŒè¦æ±‚æˆ‘ä»¬ä¸ä»…è¦å¼„æ‡‚ Shell æ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Œè¿˜è¦æ·±å…¥æ¢ç©¶å…¶å·¥ä½œåŸç†ï¼Œä¾‹å¦‚ï¼šå®ƒå¦‚ä½•è¯»å–æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ï¼Œç„¶ååˆ›å»ºç›¸åº”çš„è¿›ç¨‹æ¥æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œä»¥åŠå¦‚ä½•ç®¡ç†è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚<br>æ€»è€Œè¨€ä¹‹ï¼ŒLab6 æ˜¯ä¸€ä¸ªç»¼åˆæ€§å¾ˆå¼ºçš„é¡¶å±‚å®éªŒã€‚åœ¨æ•´ä¸ª MOSï¼ˆæ“ä½œç³»ç»Ÿï¼‰çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ä¸€ç§è‡ªåº•å‘ä¸Šçš„æ„å»ºæ–¹æ³•ï¼šä»æœ€åº•å±‚çš„åŸºæœ¬åŠŸèƒ½å¼€å§‹ï¼Œç„¶åæ·»åŠ ç³»ç»Ÿè°ƒç”¨ï¼Œå†åˆ°ç”¨æˆ·æ€çš„æ–‡ä»¶ç³»ç»Ÿã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å°†æ•´ä¸ªç³»ç»Ÿæ¨è¿›åˆ°äº†ç”¨æˆ·å±‚é¢ï¼Œè€Œ Lab6 æ­£æ˜¯è¿™ä¸ªç”¨æˆ·å±‚é¢çš„ç»ˆææŒ‘æˆ˜ï¼Œå®ƒéœ€è¦æˆ‘ä»¬çµæ´»è¿ç”¨ä¹‹å‰æ­å»ºçš„æ‰€æœ‰æ¨¡å—æ¥å…±åŒå®Œæˆã€‚</p><h2 id="å®éªŒä½“ä¼š"><a href="#å®éªŒä½“ä¼š" class="headerlink" title="å®éªŒä½“ä¼š"></a>å®éªŒä½“ä¼š</h2><p>ä¸ä¹‹å‰çš„å®éªŒç›¸æ¯”ï¼ŒLab6 çš„è®¾è®¡æ›´åŠ å‹å¥½ï¼Œå¹¶ä¸”æ²¡æœ‰å®‰æ’ä¸Šæœºè€ƒè¯•ï¼Œç»™äº†æˆ‘ä»¬æ›´å®½æ¾çš„æ¢ç´¢ç©ºé—´ã€‚</p><p>æ­£å¦‚ä¹‹å‰æåˆ°çš„ï¼ŒLab6 ä½œä¸ºæ•´ä¸ª MOS é¡¹ç›®çš„æ”¶å®˜ä¹‹ä½œï¼Œå®ƒçš„å®Œæˆæ ‡å¿—ç€æˆ‘ä»¬è¿™é—¨æ“ä½œç³»ç»Ÿè¯¾ç¨‹çš„å­¦ä¹ ä¹Ÿåœ†æ»¡ç»“æŸã€‚ç”¨è¿™æ ·ä¸€ä¸ªéœ€è¦èä¼šè´¯é€šæ‰€æœ‰çŸ¥è¯†ç‚¹çš„ç»¼åˆæ€§å®éªŒæ¥ä¸ºæ•´ä¸ªå­¦æœŸç”»ä¸Šå¥å·ï¼Œæˆ‘è§‰å¾—æ˜¯å†å¥½ä¸è¿‡çš„å®‰æ’äº†ã€‚å®ƒçœŸæ­£è®©æˆ‘ä»¬å°†ä¸€å­¦æœŸæ‰€å­¦çš„çŸ¥è¯†ä»˜è¯¸å®è·µï¼Œçœ‹åˆ°äº†ç†è®ºèµ°å‘åº”ç”¨çš„æˆæœã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œè¿™å­¦æœŸçš„æ“ä½œç³»ç»Ÿå®éªŒè®©æˆ‘æ”¶è·æ»¡æ»¡ï¼Œéå¸¸æ„Ÿè°¢è¯¾ç¨‹å›¢é˜Ÿçš„ç²¾å¿ƒè®¾è®¡å’Œè¾›å‹¤ä»˜å‡ºï¼</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OO_Unit4_å•å…ƒæ€»ç»“</title>
      <link href="/2025/06/13/OO-Unit4%E6%80%BB%E7%BB%93/%E3%80%8CBUAA%20OO%E3%80%8D%E7%AC%AC%E5%9B%9B%E5%8D%95%E5%85%83%E6%80%BB%E7%BB%93/"/>
      <url>/2025/06/13/OO-Unit4%E6%80%BB%E7%BB%93/%E3%80%8CBUAA%20OO%E3%80%8D%E7%AC%AC%E5%9B%9B%E5%8D%95%E5%85%83%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŒBUAA-OOã€ç¬¬å››å•å…ƒæ€»ç»“"><a href="#ã€ŒBUAA-OOã€ç¬¬å››å•å…ƒæ€»ç»“" class="headerlink" title="ã€ŒBUAA OOã€ç¬¬å››å•å…ƒæ€»ç»“"></a>ã€ŒBUAA OOã€ç¬¬å››å•å…ƒæ€»ç»“</h1><blockquote><p>æœ¬ç¯‡åšå®¢è®°å½•äº†ç¬”è€…é¢å‘å¯¹è±¡ç¼–ç¨‹ç¬¬å››å•å…ƒçš„å­¦ä¹ è¿‡ç¨‹ä¸æ€è€ƒï¼Œä»¥åŠå¯¹æœ¬è¯¾ç¨‹å››ä¸ªå•å…ƒå­¦ä¹ çš„æ€»ç»“ï¼ˆæºç ä¸æŒ‡å¯¼ä¹¦å¯ä»¥å‚è€ƒ<a href="https://github.com/Old-Joy/BUAA_OO_2025/tree/Unit4">Github</a>ï¼‰</p></blockquote><h2 id="ç¬¬åä¸‰æ¬¡ä½œä¸š"><a href="#ç¬¬åä¸‰æ¬¡ä½œä¸š" class="headerlink" title="ç¬¬åä¸‰æ¬¡ä½œä¸š"></a>ç¬¬åä¸‰æ¬¡ä½œä¸š</h2><p>é¢˜ç›®è¦æ±‚å®ç°ä¸€ä¸ªèƒ½å®ç°ç”¨æˆ·è¯·æ±‚çš„å›¾ä¹¦é¦†ç³»ç»Ÿã€‚æœ¬å•å…ƒä»£ç ä½œä¸šç®€å•ã€æ¶æ„æ¸…æ™°ã€è¿­ä»£é‡å°‘ï¼Œç¬”è€…åœ¨ä¸‰æ¬¡ä½œä¸šä¸­å‡æ²¡æœ‰å‘ç°ä»€ä¹ˆå€¼å¾—æ³¨æ„çš„é—®é¢˜ã€‚</p><h3 id="ç±»å›¾"><a href="#ç±»å›¾" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><img src="/img/OO-Unit4/ClassDiagram_thirteenth.png"></p><h2 id="ç¬¬åå››æ¬¡ä½œä¸š"><a href="#ç¬¬åå››æ¬¡ä½œä¸š" class="headerlink" title="ç¬¬åå››æ¬¡ä½œä¸š"></a>ç¬¬åå››æ¬¡ä½œä¸š</h2><h3 id="ç±»å›¾-1"><a href="#ç±»å›¾-1" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><img src="/img/OO-Unit4/ClassDiagram_fourteenth.png"></p><h2 id="ç¬¬åäº”æ¬¡ä½œä¸š"><a href="#ç¬¬åäº”æ¬¡ä½œä¸š" class="headerlink" title="ç¬¬åäº”æ¬¡ä½œä¸š"></a>ç¬¬åäº”æ¬¡ä½œä¸š</h2><h3 id="ç±»å›¾-2"><a href="#ç±»å›¾-2" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p><img src="/img/OO-Unit4/ClassDiagram_fifteenth.png"></p><h2 id="æ­£å‘å»ºæ¨¡ä¸å¼€å‘"><a href="#æ­£å‘å»ºæ¨¡ä¸å¼€å‘" class="headerlink" title="æ­£å‘å»ºæ¨¡ä¸å¼€å‘"></a>æ­£å‘å»ºæ¨¡ä¸å¼€å‘</h2><p>æ­£å‘å»ºæ¨¡ä¸å¼€å‘æ˜¯ä¸€ç§**â€œä»æ— åˆ°æœ‰â€**çš„ã€ç³»ç»ŸåŒ–çš„äº§å“åˆ›é€ è¿‡ç¨‹ã€‚å®ƒä»æœ€åˆçš„éœ€æ±‚å’Œæ¦‚å¿µå‡ºå‘ï¼Œé€šè¿‡ç³»ç»Ÿæ€§çš„è®¾è®¡ã€å»ºæ¨¡ã€ä»¿çœŸå’ŒéªŒè¯ï¼Œæœ€ç»ˆåˆ¶é€ å‡ºç¬¦åˆé¢„æœŸçš„äº§å“ã€‚</p><p>æ­£å‘å»ºæ¨¡æ˜¯æ­£å‘å¼€å‘æµç¨‹ä¸­çš„æ ¸å¿ƒç¯èŠ‚ä¹‹ä¸€ï¼ŒæŒ‡çš„æ˜¯åœ¨<strong>äº§å“å°šæœªå®é™…å­˜åœ¨ä¹‹å‰</strong>ï¼Œä¾æ®å…¶åŠŸèƒ½éœ€æ±‚ã€æ€§èƒ½æŒ‡æ ‡å’Œè®¾è®¡è§„åˆ™ï¼Œåœ¨æ•°å­—ä¸–ç•Œä¸­æ„å»ºå…¶è™šæ‹Ÿæ¨¡å‹çš„è¿‡ç¨‹ã€‚è¿™ä¸ªæ¨¡å‹æ˜¯äº§å“çš„â€œæ•°å­—è“å›¾â€ã€‚åœ¨æœ¬å•å…ƒä¸­ï¼Œè¿™ä¸ªå’Œæˆ‘ä»¬å…ˆç”»ç±»å›¾å†ç¼–å†™ä»£ç æ˜¯ç›¸å»åˆçš„ã€‚</p><p>è€Œæ­£å‘å¼€å‘åˆ™æ˜¯ä¸€ä¸ªæ›´å®è§‚çš„æ¦‚å¿µï¼Œå®ƒæ¶µç›–äº†ä»å¸‚åœºè°ƒç ”ã€æ¦‚å¿µæå‡ºã€è®¾è®¡ã€å»ºæ¨¡ã€æµ‹è¯•ã€ç”Ÿäº§åˆ°æœ€ç»ˆäº¤ä»˜çš„å…¨è¿‡ç¨‹ã€‚æ­£å‘å»ºæ¨¡æ˜¯æ­£å‘å¼€å‘æµç¨‹ä¸­çš„ä¸€ä¸ªå…³é”®æŠ€æœ¯æ‰‹æ®µã€‚</p><p>åœ¨æœ¬å•å…ƒçš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ç”¨åˆ°äº†ä¸‰ç§UMLå»ºæ¨¡è¯­è¨€ï¼Œåˆ†åˆ«æ˜¯ç±»å›¾ã€çŠ¶æ€å›¾å’Œé¡ºåºå›¾</p><h3 id="ç±»å›¾-3"><a href="#ç±»å›¾-3" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h3><p>ç±»å›¾ä¼šæè¿°ç³»ç»Ÿçš„é™æ€ç»“æ„ã€‚å®ƒå‘Šè¯‰ä½ ç³»ç»Ÿé‡Œæœ‰ä»€ä¹ˆï¼ˆç±»ï¼‰ï¼Œå®ƒä»¬å„è‡ªçš„å±æ€§å’Œè¡Œä¸ºæ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆæ ·çš„é™æ€å…³ç³»ã€‚å®ƒæ˜¯UMLä¸­æœ€æ ¸å¿ƒã€æœ€åŸºç¡€çš„å›¾ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ç›´æ¥ä½“ç°ã€‚å®ƒå±•ç¤ºäº†ç³»ç»Ÿçš„é™æ€è“å›¾ã€‚</p><p>åœ¨æ­£å‘å»ºæ¨¡çš„åˆæœŸï¼Œå½“æˆ‘ä»¬é€šè¿‡éœ€æ±‚åˆ†æçŸ¥é“äº†ç³»ç»Ÿçš„éœ€æ±‚ä¹‹åï¼Œé¦–å…ˆå°±è¦ç”¨ç±»å›¾æ¥æ­å»ºç³»ç»Ÿçš„æ ¸å¿ƒç»“æ„ã€‚åœ¨æ­£å‘å»ºæ¨¡ä¸­ï¼Œç±»å›¾æ˜¯ç¬¬ä¸€ä¸ªã€ä¹Ÿæ˜¯æœ€é‡è¦çš„äº§å‡ºç‰©ã€‚</p><h3 id="çŠ¶æ€å›¾"><a href="#çŠ¶æ€å›¾" class="headerlink" title="çŠ¶æ€å›¾"></a>çŠ¶æ€å›¾</h3><p>çŠ¶æ€å›¾ï¼Œä¹Ÿå«çŠ¶æ€æœºå›¾ï¼Œç”¨æ¥æè¿°ä¸€ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å®ƒå‘Šè¯‰ä½ ä¸€ä¸ªå¯¹è±¡ä»åˆ›å»ºåˆ°é”€æ¯ä¼šç»å†å“ªäº›çŠ¶æ€ï¼Œä»¥åŠæ˜¯ä»€ä¹ˆäº‹ä»¶è§¦å‘äº†çŠ¶æ€çš„æ”¹å˜ã€‚çŠ¶æ€å›¾ä¸“æ³¨äºæè¿°å•ä¸ªå¯¹è±¡åœ¨å…¶ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½ç»å†çš„å„ç§çŠ¶æ€ï¼Œä»¥åŠå¦‚ä½•ä»ä¸€ä¸ªçŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªçŠ¶æ€ã€‚</p><p>å½“ç³»ç»Ÿçš„é™æ€éª¨æ¶ï¼ˆç±»å›¾ï¼‰æ­å»ºå¥½åï¼Œæˆ‘ä»¬ä¼šå‘ç°æœ‰äº›å¯¹è±¡ï¼ˆç±»ï¼‰çš„è¡Œä¸ºéå¸¸å¤æ‚ï¼Œå®ƒåœ¨ä¸åŒæ—¶é—´ä¼šè¡¨ç°å‡ºå®Œå…¨ä¸åŒçš„è¡Œä¸ºã€‚è¿™æ—¶å°±éœ€è¦çŠ¶æ€å›¾ã€‚åœ¨æ­£å‘å»ºæ¨¡ä¸­ï¼ŒçŠ¶æ€å›¾æ˜¯å¯¹ç±»å›¾çš„æ·±åŒ–å’Œè¡¥å……ï¼Œç¡®ä¿é¡¹ç›®èƒ½å¤Ÿåœ¨å„ç§å†…å¤–ç¯å¢ƒä¸‹å®‰å…¨ã€æ­£ç¡®çš„è¿è¡Œã€‚</p><h3 id="é¡ºåºå›¾"><a href="#é¡ºåºå›¾" class="headerlink" title="é¡ºåºå›¾"></a>é¡ºåºå›¾</h3><p>é¡ºåºå›¾ï¼Œä¹Ÿå«æ—¶åºå›¾ï¼Œç”¨æ¥æè¿°å¯¹è±¡ä¹‹é—´çš„åŠ¨æ€äº¤äº’ã€‚å®ƒå‘Šè¯‰ä½ ä¸ºäº†å®ŒæˆæŸä¸ªç‰¹å®šåŠŸèƒ½ï¼Œä¸åŒå¯¹è±¡ä¹‹é—´æ˜¯å¦‚ä½•æŒ‰æ—¶é—´é¡ºåºå‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„ã€‚é¡ºåºå›¾æ˜¯ä¸€ç§äº¤äº’å›¾ã€‚å®ƒé€šè¿‡æç»˜å¯¹è±¡ä¹‹é—´å‘é€æ¶ˆæ¯çš„æ—¶é—´é¡ºåºæ¥æ˜¾ç¤ºå¤šä¸ªå¯¹è±¡ä¹‹é—´çš„åŠ¨æ€åä½œã€‚</p><p>åœ¨æ­£å‘å»ºæ¨¡ä¸­ï¼Œé¡ºåºå›¾æ˜¯ç¡®ä¿ç³»ç»ŸåŠ¨æ€è¡Œä¸ºæ­£ç¡®æ€§çš„å…³é”®å·¥å…·ã€‚å®ƒæ¨¡æ‹Ÿäº†çœŸå®åœºæ™¯ä¸‹å„ä¸ªéƒ¨åˆ†æ˜¯å¦‚ä½•åä½œï¼Œä»¥å®Œæˆä¸€ä¸ªç‰¹å®šä»»åŠ¡çš„ã€‚</p><h3 id="ä¿è¯ä¸‰ç§å›¾çš„ä¸€è‡´æ€§"><a href="#ä¿è¯ä¸‰ç§å›¾çš„ä¸€è‡´æ€§" class="headerlink" title="ä¿è¯ä¸‰ç§å›¾çš„ä¸€è‡´æ€§"></a>ä¿è¯ä¸‰ç§å›¾çš„ä¸€è‡´æ€§</h3><p>åœ¨æ­£å‘å»ºæ¨¡å’Œæ•´ä¸ªè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œä¿æŒç±»å›¾ã€çŠ¶æ€å›¾å’Œé¡ºåºå›¾ä¹‹é—´çš„ä¸€è‡´æ€§è‡³å…³é‡è¦ã€‚å¦‚æœå®ƒä»¬ä¹‹é—´å‡ºç°çŸ›ç›¾ï¼Œæ•´ä¸ªè®¾è®¡æ¨¡å‹å°±ä¼šå¤±å»æ„ä¹‰ï¼Œç”šè‡³ä¼šè¯¯å¯¼åç»­çš„å¼€å‘å·¥ä½œã€‚ä¸‰ç§å›¾ä»ä¸åŒè§†è§’æè¿°åŒä¸€ä¸ªç³»ç»Ÿï¼Œå¦‚æœå®ƒä»¬çš„ä¿¡æ¯ä¸ä¸€è‡´ï¼Œè¯´æ˜è®¾è®¡æœ¬èº«å­˜åœ¨é€»è¾‘çŸ›ç›¾å’Œç¼ºé™·ã€‚</p><h2 id="å¤§æ¨¡å‹çš„è¾…åŠ©ä½¿ç”¨"><a href="#å¤§æ¨¡å‹çš„è¾…åŠ©ä½¿ç”¨" class="headerlink" title="å¤§æ¨¡å‹çš„è¾…åŠ©ä½¿ç”¨"></a>å¤§æ¨¡å‹çš„è¾…åŠ©ä½¿ç”¨</h2><p>å¤§æ¨¡å‹å¹¶éèƒ½å¤Ÿâ€œè‡ªåŠ¨â€å®Œæˆä»å»ºæ¨¡åˆ°å®ç°æ‰€æœ‰ä»»åŠ¡çš„é»‘ç›’ã€‚åœ¨å»ºæ¨¡ã€å®ç°è¿‡ç¨‹ä¸­ï¼Œå¤§æ¨¡å‹åº”å½“æ›´ç±»ä¼¼äºâ€œå¯¼èˆªâ€ç³»ç»Ÿçš„è§’è‰²ã€‚è¦å¼•å¯¼å®ƒåœ¨å¤æ‚åœºæ™¯ä¸­å®Œæˆé«˜è´¨é‡çš„æ¶æ„è®¾è®¡ï¼Œå…³é”®åœ¨äº<strong>è®¾è®¡å¸ˆçš„ä¸»å¯¼ä½œç”¨</strong>å’Œä¸€å¥—<strong>ç³»ç»ŸåŒ–çš„å¼•å¯¼ç­–ç•¥</strong>ã€‚</p><p>è£è€å¸ˆè¯´ï¼Œâ€œè¦å»æ‹¥æŠ±æ–°æŠ€æœ¯â€ã€‚å¤§æ¨¡å‹çš„åˆ°æ¥å¹¶ä¸æ˜¯ä¸€ä»¶ç¾éš¾æ€§çš„äº‹æƒ…ï¼Œä½†è¿™ä¹Ÿå¹¶ä¸æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å®Œå…¨ä¾èµ–å¤§æ¨¡å‹ã€‚ç›®å‰çš„å¤§æ¨¡å‹ä¾ç„¶å­˜åœ¨å¾ˆå¤šç¼ºç‚¹ï¼Œå®ƒæ‹¥æœ‰å…¨é¢çš„èµ„æ–™ï¼Œå´ä¸ä¸€å®šèƒ½å¤Ÿå…¨éƒ¨ç†è§£å®ƒä»¬ã€‚ç¬”è€…æ€»ç»“äº†ä¸€äº›å¤§æ¨¡å‹çš„å¼•å¯¼æ–¹æ³•ï¼š</p><ol><li>ä¸Šä¸‹æ–‡ç²¾ç¡®æ³¨å…¥ï¼šä¸ºæ¨¡å‹è®¾å®šâ€œè®¾è®¡è¾¹ç•Œâ€<br> å¤§æ¨¡å‹æœ¬èº«ç¼ºä¹çœŸå®ä¸–ç•Œçš„é¡¹ç›®èƒŒæ™¯ã€‚è‹¥æ˜¯ç›´æ¥è®©å…¶è®¾è®¡ä¸€ä¸ªé¡¹ç›®ï¼Œå…¶ç­”æ¡ˆä¼šå› æ³›æ³›è€Œè°ˆè€Œæ¯«æ— ä»·å€¼ã€‚å› æ­¤ï¼Œç¬¬ä¸€æ­¥å¿…é¡»æ˜¯ä¸ºå…¶æ„å»ºä¸€ä¸ªç²¾ç¡®çš„ç¯å¢ƒï¼Œæ¯”å¦‚èµ‹äºˆå¤§æ¨¡å‹ä¸€ä¸ªèº«ä»½ï¼ŒæŠ‘æˆ–æ˜¯æ˜ç¡®ä¸šåŠ¡éœ€æ±‚ä¸çº¦æŸã€æŠ€æœ¯æ ˆã€è®¾è®¡æ¨¡å¼ç­‰ç­‰ã€‚</li><li>ä»»åŠ¡åˆ†è§£ä¸è¿­ä»£å¼ç”Ÿæˆï¼šå°†â€œå¤§é—®é¢˜â€æ‹†è§£ä¸ºâ€œå°æ­¥éª¤â€<br> é¢å¯¹å¤æ‚æ¶æ„ï¼Œä¸èƒ½æŒ‡æœ›ä¸€æ­¥åˆ°ä½ï¼Œéœ€è¦é€å±‚ä¸‹é™ï¼Œå¼•å¯¼æ¨¡å‹åˆ†å±‚ã€åˆ†æ­¥åœ°æ€è€ƒã€‚è¿™ç§åˆ†è§£å¼çš„å¼•å¯¼ï¼Œæœ¬è´¨ä¸Šæ˜¯æ¨¡æ‹Ÿäº†æˆ‘ä»¬è¯¾ç¨‹ä¸­æ‰€å­¦çš„<strong>æ­£å‘å»ºæ¨¡</strong>æµç¨‹ï¼Œç¡®ä¿äº†è®¾è®¡çš„ç³»ç»Ÿæ€§å’Œé€»è¾‘æ€§ã€‚</li><li>æ‰¹åˆ¤æ€§æ€ç»´ä¸ä¸€è‡´æ€§æ ¡éªŒï¼šä»â€œå…¨ç›˜æ¥æ”¶â€åˆ°â€œå®¡æ…è´¨è¯¢â€<br> å¤§æ¨¡å‹æœ€è‡´å‘½çš„å¼±ç‚¹æ˜¯â€œä¸€æœ¬æ­£ç»çš„èƒ¡è¯´å…«é“â€ã€‚å®ƒç¼ºä¹å¯¹è®¾è®¡ä¸€è‡´æ€§çš„è‡ªæˆ‘å®¡æŸ¥èƒ½åŠ›ã€‚ç¨‹åºå‘˜çš„æ‰¹åˆ¤æ€§æ€ç»´æ˜¯ä¸å¯æˆ–ç¼ºçš„ä¸€ç¯ã€‚<br> é¢å¯¹å¤§æ¨¡å‹ç»™å‡ºçš„ç­”æ¡ˆï¼Œæˆ‘ä»¬å¤šé—®â€œä¸ºä»€ä¹ˆâ€ï¼Œå¤šå»å’ŒçœŸå®æƒ…æ™¯å¯¹æ¯”ã€è´¨è¯¢ï¼Œè€Œä¸æ˜¯ä¸€æŠ„äº†äº‹ã€‚å®šä¹‰é—®é¢˜ã€è¿›è¡Œå…³é”®å†³ç­–ã€ä¿è¯è®¾è®¡å®Œæ•´æ€§å’Œä¸€è‡´æ€§çš„æ ¸å¿ƒèŒè´£ï¼Œ<strong>å§‹ç»ˆåº”å½“æŒæ¡åœ¨äººç±»è®¾è®¡å¸ˆæ‰‹ä¸­</strong>ã€‚</li></ol><h2 id="æ€»ç»“å››ä¸ªå•å…ƒ"><a href="#æ€»ç»“å››ä¸ªå•å…ƒ" class="headerlink" title="æ€»ç»“å››ä¸ªå•å…ƒ"></a>æ€»ç»“å››ä¸ªå•å…ƒ</h2><h3 id="æ¶æ„è®¾è®¡æ€ç»´çš„æ¼”è¿›"><a href="#æ¶æ„è®¾è®¡æ€ç»´çš„æ¼”è¿›" class="headerlink" title="æ¶æ„è®¾è®¡æ€ç»´çš„æ¼”è¿›"></a>æ¶æ„è®¾è®¡æ€ç»´çš„æ¼”è¿›</h3><p>å››ä¸ªå•å…ƒä¸€è·¯<del>è‚˜</del>æ¥ï¼Œæ”¶è·è¿˜æ˜¯å¾ˆä¸å°‘çš„ã€‚ç¬¬ä¸€å•å…ƒåƒäº†ä¸€ä¸ªå¤§äºï¼Œä¹‹åå†ä¹Ÿä¸æ•¢åœ¨æ¶æ„è®¾è®¡ä¸Šæ€ æ…¢äº†ã€‚è‡ªç¬¬ä¸€å•å…ƒåï¼Œå†ä¹Ÿæ²¡å‡ºç°è¿‡æ¶æ„å¯¼è‡´çš„ WRONG ANSWER é—®é¢˜ã€‚</p><p>å½“æ—¶ç¬¬ä¸€å•å…ƒçš„ç¬¬äºŒæ¬¡ä½œä¸šï¼Œå¯¹<strong>å°è£…</strong>çš„ç†è§£å°šä¸”ä¸å½»åº•ï¼Œåœ¨é€’æ¨å‡½æ•°çš„è§£æä¸Šé¢åƒäº†å¾ˆå¤§çš„äºã€‚åæ¥æ¸æ¸ç†è§£åˆ°å°è£…çš„å«ä¹‰ï¼ŒæŠŠä»»åŠ¡ä¸‹æ”¾ç»™æ¯ä¸ªç±»ï¼Œå®è§‚ä¸Šåªç®¡è°ƒç”¨å¹¶ä¿¡ä»»ç±»ç»™å‡ºçš„æ–¹æ³•ï¼Œè¿™æ˜¯ç¬¬ä¸€å•å…ƒçš„â€œé€’å½’ä¸‹é™â€é‡Œæœ€é‡è¦çš„çŸ¥è¯†ã€‚</p><p>è‡ªæ­¤ä»¥åï¼Œç¬”è€…ä¹Ÿæ‰“æ¶ˆäº†â€œç»ä¸é‡æ„â€çš„å¿µå¤´ï¼Œæ¯æ¬¡å†™ä½œä¸šï¼Œå°½é‡åšåˆ°æ¶æ„ä¸Šçš„æ¸…æ™°ç®€æ´ã€å¯ç»´æŠ¤æ€§å¥½ã€å¯æ‰©å±•æ€§å¥½ã€‚åœ¨åå‡ ä¸ªå•å…ƒé‡Œéƒ½åšå¾—æ¯”è¾ƒç†æƒ³ã€‚</p><p>æ¶æ„è®¾è®¡æ˜¯å¾ˆé‡è¦çš„ï¼Œä¸€ä¸ªå¥½çš„æ¶æ„èƒ½è®©ä»»åŠ¡çš„å®Œæˆæ›´æ¸…æ™°ã€æ€è·¯æ˜ç¡®ï¼Œèƒ½è®©ç¨‹åºå‘˜æ›´å®¹æ˜“ç†è§£ä»£ç çš„é€»è¾‘ã€‚æ— è®ºæ˜¯ç»´æŠ¤ã€æ‰©å±•ã€æµ‹è¯•éƒ½ä¼šæœ‰ä¸€ä¸ªå¥½çš„å¯¼å‘ã€‚</p><h3 id="æµ‹è¯•æ€ç»´çš„æ¼”è¿›"><a href="#æµ‹è¯•æ€ç»´çš„æ¼”è¿›" class="headerlink" title="æµ‹è¯•æ€ç»´çš„æ¼”è¿›"></a>æµ‹è¯•æ€ç»´çš„æ¼”è¿›</h3><p>ç¬¬ä¸€å•å…ƒçš„æ—¶å€™è¿˜ä¸ä¼šå†™è¯„æµ‹æœºï¼Œå½“æ—¶ä¹Ÿåƒäº†ä¸å°‘äºã€‚ææµ‹è¯•ç‚¹çš„æ—¶å€™æ„Ÿè§‰å¾ˆæœ‰è‡ªä¿¡ï¼ŒæŠŠå¥½å¤šæƒ…å†µéƒ½è€ƒè™‘äº†ï¼Œå…¶å®æƒ³åˆ°çš„æ ¹æœ¬ä¸å…¨é¢ã€‚å½“æ—¶ä¹Ÿåªä¼šé»‘ç›’æµ‹è¯•ã€‚å¦‚æœå½“æ—¶æ‡‚å¾—ä»£ç èµ°æŸ¥çš„é‡è¦æ€§çš„è¯ï¼Œä¸€å®šæ˜¯èƒ½æ„Ÿè§‰åˆ°é€’æ¨å‡½æ•°å†…éƒ¨é€»è¾‘è§£ææœ‰æƒ…å†µé—æ¼çš„ã€‚</p><p>ç¬¬äºŒå•å…ƒï¼Œä¸€æ–¹é¢å¼€å§‹è®­ç»ƒè‡ªå·±ä»£ç èµ°æŸ¥çš„èƒ½åŠ›ï¼Œå¦ä¸€æ–¹é¢å¼€å§‹å­¦ä¼šæ­å»ºè¯„æµ‹æœºäº†ã€‚å½“æ—¶ä½¿ç”¨ä»£ç èµ°æŸ¥çœ‹å‡ºè‡ªå·±ä»£ç å¾ˆå¤šçº¿ç¨‹ä¸å®‰å…¨çš„åœ°æ–¹ï¼Œåœ¨äº’æµ‹é‡Œä¹Ÿçœ‹åˆ°æˆ¿å‹ä»£ç ä¸Šçš„ç¼ºç‚¹ï¼Œæé€ æµ‹è¯•ç‚¹æˆåŠŸhackäº†ï¼Œä¹Ÿæ˜¯å½“æ—¶æˆ¿é—´é‡Œå”¯ä¸€hackçš„äººã€‚å¦ä¸€æ–¹é¢ï¼Œè¯„æµ‹æœºæ­å»ºçš„å¼ºåº¦ä¹Ÿå¾ˆé«˜ã€‚å…³äºæ•°æ®ç”Ÿæˆï¼Œæˆ‘æ‰ç”¨äº†å¾ˆå¤šç­–ç•¥æ¥æé«˜æ•°æ®ç‚¹çš„å¼ºåº¦ï¼Œåˆè®¾ç½®äº†å¾ˆå¤šé™åˆ¶æ¥ä¿è¯æ•°æ®ç‚¹çš„æ­£ç¡®æ€§ä¸æœ‰æ•ˆæ€§ã€‚æœ€åå°±æ˜¯æ­£ç¡®æ€§åˆ¤å®šæ–¹é¢ï¼Œæˆ‘å…ˆæ˜¯è‡ªå·±å¤šæ€è€ƒã€å¤šåˆ¤æ–­ï¼Œç„¶ååˆæ ¹æ®å¤§æ¨¡å‹çš„è¾…åŠ©ï¼Œæé«˜æ­£ç¡®æ€§åˆ¤å®šçš„ä¸¥å¯†æ€§ï¼Œæœ€åä¹Ÿæ˜¯åœ¨ç¬¬äºŒå•å…ƒæ‰“å‡ºäº†å¾ˆä¸é”™çš„æˆç»©ã€‚</p><p>åœ¨è¿™ä¹‹åï¼Œå¯¹ä»£ç è¿›è¡Œæµ‹è¯•çš„æ—¶å€™å°±å¾ˆçµæ´»äº†ã€‚</p><h2 id="è¯¾ç¨‹æ”¶è·"><a href="#è¯¾ç¨‹æ”¶è·" class="headerlink" title="è¯¾ç¨‹æ”¶è·"></a>è¯¾ç¨‹æ”¶è·</h2><p>OO çš„è·¯å·²ç»å‘Šä¸€æ®µè½äº†ã€‚åˆ°äº†è¿™ä¸ªä»½ä¸Šï¼Œå¥½åƒè¯´ä¸å‡ºä»€ä¹ˆç‰¹åˆ«æœ‰å¤§é“ç†çš„è¯ã€‚ç¡¬è¦è¯´ï¼Œç¬”è€…çš„æ”¶è·æ›´å¤šè¿˜ä¸æ˜¯çŸ¥è¯†å±‚é¢çš„ã€‚</p><p>åˆšå¼€å§‹æ¥è§¦çš„æ—¶å€™è¿˜æ˜¯æ¯”è¾ƒå¿å¿‘çš„ï¼Œç¬¬ä¸€å•å…ƒï¼Œå¯¹é¢å‘å¯¹è±¡çš„æ€è·¯è¿˜ä¸æ˜¯ç‰¹åˆ«æ¸…æ™°ã€‚åˆšå¼€å§‹æ‹¿åˆ°ä½œä¸šè¦æ±‚çš„æ—¶å€™è¿˜ä¸çŸ¥é“è¦ä»å“ªæ–¹é¢ä¸‹æ‰‹ï¼Œçœ‹äº†å¥½å¤šåšå®¢æ‰æ¸æ¸çš„æœ‰äº†æ€è·¯ã€‚å½“æ—¶ç¡®å®ä¸ä¼šè®¾è®¡æ¶æ„ï¼Œç°åœ¨åè¿‡æ¥çœ‹ç¬¬ä¸€å•å…ƒä¸‰æ¬¡ä½œä¸šçš„ä»£ç éƒ½æ„Ÿè§‰æ˜¯<del>å±å±±ä¸­çš„å±å±±</del>ã€‚</p><p>ä½†éšç€æ…¢æ…¢çš„æ¥è§¦ï¼Œè®¾è®¡æ¶æ„è¶Šæ¥è¶Šå¾—å¿ƒåº”æ‰‹äº†ã€‚å¯¹å¾€å±Šå­¦é•¿å­¦å§çš„åšå®¢å‚è€ƒä¹Ÿå°‘äº†å¾ˆå¤šï¼Œé€æ¸å­¦ä¼šäº†åœ¨æ‹¿åˆ°è¦æ±‚ä¹‹åå…ˆè‡ªå·±æ€è€ƒã€è®¾è®¡ï¼Œæœ€åå®Œæˆæ¯”è¾ƒå…¨é¢çš„ã€ä¼˜è‰¯çš„é¡¹ç›®ã€‚</p><p>é¢å‘å¯¹è±¡æ˜¯ä¸ªå€¼å¾—æ·±å…¥ç ”ç©¶çš„è¯¾é¢˜ã€‚å¤§ä¸€åªå­¦è¿‡Cè¯­è¨€çš„é¢å‘è¿‡ç¨‹ï¼Œåˆšæ¥è§¦åˆ°é¢å‘å¯¹è±¡çš„æ—¶å€™æ˜¯æ¯”è¾ƒè¯§å¼‚çš„ï¼Œâ€œå“‡ï¼Œä»£ç è¿˜èƒ½è¿™ä¹ˆå†™â€ï¼ˆä¸Šå®ŒOOpreå’Œèˆå‹èŠå¤©çš„åŸè¯ï¼‰ã€‚æ¯”å¦‚ï¼Œå°è£…çš„æ„è¯†æ˜¯é¢å‘è¿‡ç¨‹ç¼–ç¨‹ä½“ä¼šä¸åˆ°çš„ï¼Œå°±å¥½æ¯”é¢å¯¹ä¸€ä¸ªæœºå™¨ï¼Œä½ è®©å®ƒå¹²ä»€ä¹ˆå®ƒå°±å¹²ä»€ä¹ˆï¼Œä½†ä½ ä»å¤–éƒ¨æ˜¯æ— æ³•å¾—çŸ¥å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Œçœ‹ä¸åˆ°å†…éƒ¨çš„çŠ¶æ€ï¼Œè¿™ç§æ„Ÿè§‰çœŸçš„å¥½ç”Ÿå¥‡å¦™ã€‚è¿™æ ·æ—¢æé«˜äº†å®‰å…¨æ€§ï¼Œä¹Ÿé™ä½äº†å¤æ‚åº¦ã€‚</p><p>OO çš„è¿‡ç¨‹ä¸­æœ‰è¿‡å–œæ‚¦ï¼Œæœ‰è¿‡éš¾è¿‡ã€‚åœ¨ OO çš„è·¯ä¸Šï¼Œç»“è¯†äº†å¾ˆå¤šå‹å¥½çš„åŒå­¦å’ŒåŠ©æ•™ï¼Œä¹ŸçŠ¯è¿‡é”™è¯¯ï¼Œè®¤è¯†åˆ°ä¸è¶³å¹¶æ”¹æ­£ã€‚OO è¯¾ç¨‹é™ªä¼´äº†æˆ‘ä»¬ä¸€ä¸ªå­¦æœŸï¼Œç»™æˆ‘ä»¬å¸¦æ¥äº†æå¤šæˆªç„¶ä¸åŒçš„ä½“éªŒï¼Œ<del>æƒ³å¿…æˆ‘è¿™è¾ˆå­éƒ½å¿˜ä¸äº†ä½ äº†</del>ã€‚</p><p>è¡·å¿ƒç¥æ„¿ OO è¯¾èƒ½å¤Ÿè¶ŠåŠè¶Šå¥½ï¼Œä¹Ÿå¸Œæœ›è‡ªå·±èƒ½å¤Ÿå½“é€‰ OO åŠ©æ•™ï¼Œå†å’Œ OO ä¸€èµ·èµ°ä¸€å¹´ï¼</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OO_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_Lab5_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/05/30/OS-Lab5/BUAA-OS-Lab5%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/05/30/OS-Lab5/BUAA-OS-Lab5%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="BUAA-OS-Lab5-å®éªŒæŠ¥å‘Š"><a href="#BUAA-OS-Lab5-å®éªŒæŠ¥å‘Š" class="headerlink" title="BUAA-OS-Lab5 å®éªŒæŠ¥å‘Š"></a>BUAA-OS-Lab5 å®éªŒæŠ¥å‘Š</h1><h2 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h2><h3 id="Thinking-5-1"><a href="#Thinking-5-1" class="headerlink" title="Thinking 5.1"></a>Thinking 5.1</h3><blockquote><p>å¦‚æœé€šè¿‡ kseg0 è¯»å†™è®¾å¤‡ï¼Œé‚£ä¹ˆå¯¹äºè®¾å¤‡çš„å†™å…¥ä¼šç¼“å­˜åˆ° Cache ä¸­ã€‚è¿™æ˜¯ä¸€ç§é”™è¯¯çš„è¡Œä¸ºï¼Œåœ¨å®é™…ç¼–å†™ä»£ç çš„æ—¶å€™è¿™ä¹ˆåšä¼šå¼•å‘ä¸å¯é¢„çŸ¥çš„é—®é¢˜ã€‚è¯·æ€è€ƒï¼šè¿™ä¹ˆåšè¿™ä¼šå¼•å‘ä»€ä¹ˆé—®é¢˜ï¼Ÿå¯¹äºä¸åŒç§ç±»çš„è®¾å¤‡ï¼ˆå¦‚æˆ‘ä»¬æåˆ°çš„ä¸²å£è®¾å¤‡å’Œ IDE ç£ç›˜ï¼‰çš„æ“ä½œä¼šæœ‰å·®å¼‚å—ï¼Ÿå¯ä»¥ä»ç¼“å­˜çš„æ€§è´¨å’Œç¼“å­˜æ›´æ–°çš„ç­–ç•¥æ¥è€ƒè™‘ã€‚</p></blockquote><p>å½“å¤–éƒ¨è®¾å¤‡äº§ç”Ÿä¸­æ–­ä¿¡å·æˆ–è€…æ›´æ–°æ•°æ®æ—¶ï¼Œæ­¤æ—¶Cacheä¸­ä¹‹å‰æ—§çš„æ•°æ®å¯èƒ½åˆšå®Œæˆç¼“å­˜ï¼Œé‚£ä¹ˆå®Œæˆç¼“å­˜çš„è¿™ä¸€éƒ¨åˆ†æ— æ³•å®Œæˆæ›´æ–°ï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯çš„è¡Œä¸ºã€‚<br>ç¼“å­˜æœºåˆ¶çš„è®¾è®¡æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè®©æ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ä¸ç«‹å³å†™å…¥å†…å­˜ï¼Œè€Œæ˜¯ç­‰Cacheå‘ç”Ÿæ›¿æ¢çš„æ—¶å€™æ‰å†™è¿›å»ã€‚<br>è€Œå¯¹äºä¸²å£è®¾å¤‡è¿™ç§è¯»å†™é¢‘ç¹ã€å®æ—¶äº¤äº’çš„è®¾å¤‡æ¥è¯´ï¼Œå¦‚æœå†™å…¥ kseg0 éƒ¨åˆ†ï¼Œæ•°æ®å¯èƒ½å¾ˆä¹…éƒ½ä¸è¢«çœŸæ­£å†™å…¥å†…å­˜ä¸­ï¼Œå¼•å‘é”™è¯¯ã€‚åœ¨ç›¸åŒçš„æ—¶é—´å†…ï¼Œå‘ç”Ÿè¯»å†™é”™è¯¯çš„æ¦‚ç‡è¿œé«˜äºIDEç£ç›˜ã€‚</p><h3 id="Thinking-5-2"><a href="#Thinking-5-2" class="headerlink" title="Thinking 5.2"></a>Thinking 5.2</h3><blockquote><p>æŸ¥æ‰¾ä»£ç ä¸­çš„ç›¸å…³å®šä¹‰ï¼Œè¯•å›ç­”ä¸€ä¸ªç£ç›˜å—ä¸­æœ€å¤šèƒ½å­˜å‚¨å¤šå°‘ä¸ªæ–‡ä»¶æ§åˆ¶å—ï¼Ÿä¸€ä¸ªç›®å½•ä¸‹æœ€å¤šèƒ½æœ‰å¤šå°‘ä¸ªæ–‡ä»¶ï¼Ÿæˆ‘ä»¬çš„æ–‡ä»¶ç³»ç»Ÿæ”¯æŒçš„å•ä¸ªæ–‡ä»¶æœ€å¤§ä¸ºå¤šå¤§ï¼Ÿ</p></blockquote><ul><li>ä¸€ä¸ªç£ç›˜å—çš„å¤§å°ä¸º<strong>4KB</strong>ï¼Œä¸€ä¸ªæ–‡ä»¶æ§åˆ¶å—çš„å¤§å°ä¸º<strong>256B</strong>ï¼Œä¸€ä¸ªç£ç›˜å—ä¸­æœ€å¤šæœ‰<strong>16ä¸ª</strong>æ–‡ä»¶æ§åˆ¶å—ã€‚</li><li>ä¸€ä¸ªç›®å½•å¤§å°ä¸º<strong>4KB</strong>ï¼Œæ‰€ä»¥ä¸€ä¸ªç›®å½•ä¸‹<strong>æœ€å¤šæœ‰1024ä¸ª</strong>ç›®å½•é¡¹ï¼Œä¹Ÿå°±æ˜¯æœ€å¤šå¯ä»¥æŒ‡å‘<strong>1024ä¸ª</strong>ç£ç›˜å—ã€‚æ¯ä¸€ä¸ªç£ç›˜å—æœ‰æœ€å¤šæœ‰<strong>16</strong>ä¸ªæ–‡ä»¶æ§åˆ¶å—ï¼Œæ‰€ä»¥ä¸€ä¸ªç›®å½•æœ€å¤šæœ‰<strong>16Kä¸ª</strong>æ–‡ä»¶ã€‚</li><li>ä¸€ä¸ªæ–‡ä»¶æœ‰<strong>ç›´æ¥æŒ‡é’ˆ</strong>+<strong>é—´æ¥æŒ‡é’ˆ</strong>å…±1024ä¸ªã€‚æ¯ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªç£ç›˜å—ï¼Œå­˜å‚¨ç€è¯¥æ–‡ä»¶çš„ä¸€éƒ¨åˆ†æ–‡ä»¶æ•°æ®ã€‚æ‰€ä»¥æ–‡ä»¶ç³»ç»Ÿæ”¯æŒçš„å•ä¸ªæ–‡ä»¶æœ€å¤§ä¸º<strong>4MB</strong></li></ul><h3 id="Thinking-5-3"><a href="#Thinking-5-3" class="headerlink" title="Thinking 5.3"></a>Thinking 5.3</h3><blockquote><p>è¯·æ€è€ƒï¼Œåœ¨æ»¡è¶³ç£ç›˜å—ç¼“å­˜çš„è®¾è®¡çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å®éªŒä½¿ç”¨çš„å†…æ ¸æ”¯æŒçš„æœ€å¤§ç£ç›˜å¤§å°æ˜¯å¤šå°‘ï¼Ÿ</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> DISKMAX 0x40000000</span></span><br></pre></td></tr></table></figure><p>ç”±ä»£ç å¯çŸ¥æœ€å¤§ç£ç›˜å¤§å°ä¸º1GBã€‚</p><h3 id="Thinking-5-4"><a href="#Thinking-5-4" class="headerlink" title="Thinking 5.4"></a>Thinking 5.4</h3><blockquote><p>åœ¨æœ¬å®éªŒä¸­ï¼Œ fs&#x2F;serv.hã€ user&#x2F;include&#x2F;fs.h ç­‰æ–‡ä»¶ä¸­å‡ºç°äº†è®¸å¤šå®å®šä¹‰ï¼Œè¯•åˆ—ä¸¾ä½ è®¤ä¸ºè¾ƒä¸ºé‡è¦çš„å®å®šä¹‰ï¼ŒåŒæ—¶è¿›è¡Œè§£é‡Šï¼Œå¹¶æè¿°å…¶ä¸»è¦åº”ç”¨ä¹‹å¤„ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> INDEX2FD(i) (FDTABLE + (i)*BY2PG)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INDEX2DATA(i) (FILEBASE + (i)*PDMAP)</span></span><br></pre></td></tr></table></figure><p><code>user/include/fs.h</code>é‡Œé¢ï¼Œè¿™ä¸¤ä¸ªå®åˆ†åˆ«ç”¨æ¥æ‰¾<code>fd</code>å¯¹åº”çš„<strong>æ–‡ä»¶ä¿¡æ¯é¡µé¢</strong>å’Œ<strong>æ–‡ä»¶çš„ç¼“å­˜åŒºåœ°å€</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SECT2BLK (BLOCK_SIZE / SECT_SIZE) <span class="comment">/* sectors to a block */</span></span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å®ç° sect å·åˆ° block å·çš„è½¬æ¢ã€‚</p><h3 id="Thinking-5-5"><a href="#Thinking-5-5" class="headerlink" title="Thinking 5.5"></a>Thinking 5.5</h3><blockquote><p>åœ¨ Lab4â€œç³»ç»Ÿè°ƒç”¨ä¸ forkâ€çš„å®éªŒä¸­æˆ‘ä»¬å®ç°äº†æä¸ºé‡è¦çš„ fork å‡½æ•°ã€‚é‚£ä¹ˆ fork å‰åçš„çˆ¶å­è¿›ç¨‹æ˜¯å¦ä¼šå…±äº«æ–‡ä»¶æè¿°ç¬¦å’Œå®šä½æŒ‡é’ˆå‘¢ï¼Ÿè¯·åœ¨å®Œæˆä¸Šè¿°ç»ƒä¹ çš„åŸºç¡€ä¸Šç¼–å†™ä¸€ä¸ªç¨‹åºè¿›è¡ŒéªŒè¯ã€‚</p></blockquote><p>ä¼šå…±äº«</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fd = open(<span class="string">&quot;/testfork&quot;</span>, O_RDWR);</span><br><span class="line"><span class="keyword">if</span>((r = fork()) == <span class="number">0</span>) &#123; <span class="comment">//å­è¿›ç¨‹</span></span><br><span class="line">    n = read(fd, buf, <span class="number">3</span>);</span><br><span class="line">    debugf(<span class="string">&quot;child : %s\n&quot;</span>, buf);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">//çˆ¶è¿›ç¨‹</span></span><br><span class="line">    n = read(fd, buf, <span class="number">3</span>);</span><br><span class="line">    debugf(<span class="string">&quot;father : %s\n&quot;</span>, buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶<code>/testfork</code>ç§çš„å†…å®¹ä¸º<code>abcdef</code></p><p>è€Œè¾“å‡ºä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">child : abc</span><br><span class="line">father : def</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ–‡ä»¶æŒ‡é’ˆå’Œæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¼šå…±äº«çš„</p><h3 id="Thinking-5-5-1"><a href="#Thinking-5-5-1" class="headerlink" title="Thinking 5.5"></a>Thinking 5.5</h3><blockquote><p>è¯·è§£é‡Š File, Fd, Filefd ç»“æ„ä½“åŠå…¶å„ä¸ªåŸŸçš„ä½œç”¨ã€‚æ¯”å¦‚å„ä¸ªç»“æ„ä½“ä¼šåœ¨å“ªäº›è¿‡ç¨‹ä¸­è¢«ä½¿ç”¨ï¼Œæ˜¯å¦å¯¹åº”ç£ç›˜ä¸Šçš„ç‰©ç†å®ä½“è¿˜æ˜¯å•çº¯çš„å†…å­˜æ•°æ®ç­‰ã€‚è¯´æ˜å½¢å¼è‡ªå®šï¼Œè¦æ±‚ç®€æ´æ˜äº†ï¼Œå¯å¤§è‡´å‹¾å‹’å‡ºæ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„ä¸ç‰©ç†å®ä½“çš„å¯¹åº”å…³ç³»ä¸è®¾è®¡æ¡†æ¶ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fileç»“æ„ä½“è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å…ƒæ•°æ®ï¼Œæ—¢å­˜åœ¨äºç£ç›˜ä¸Šçš„ç‰©ç†ç»“æ„ï¼Œä¹Ÿå­˜åœ¨äºæ–‡ä»¶ç³»ç»ŸæœåŠ¡è¿›ç¨‹çš„å†…å­˜ä¸­ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> f_name[MAXNAMELEN]; <span class="comment">// æ–‡ä»¶åæˆ–ç›®å½•å</span></span><br><span class="line">    <span class="type">uint32_t</span> f_size;         <span class="comment">// æ–‡ä»¶æˆ–ç›®å½•å æ®çš„å­˜å‚¨ç©ºé—´å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½</span></span><br><span class="line">    <span class="type">uint32_t</span> f_type;         <span class="comment">// æ–‡ä»¶çš„ç±»å‹æ ‡è¯†ï¼ŒåŒºåˆ†æ–‡ä»¶å’Œç›®å½•</span></span><br><span class="line">    <span class="type">uint32_t</span> f_direct[NDIRECT]; <span class="comment">// ç›´æ¥æŒ‡é’ˆæ•°ç»„ï¼ŒæŒ‡å‘åŒ…å«æ–‡ä»¶å†…å®¹çš„ç£ç›˜å—åœ°å€</span></span><br><span class="line">    <span class="type">uint32_t</span> f_indirect;     <span class="comment">// é—´æ¥æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªç£ç›˜å—ï¼Œè¯¥ç£ç›˜å—å­˜å‚¨äº†æŒ‡å‘æ–‡ä»¶å†…å®¹çš„å…¶ä»–ç£ç›˜å—åœ°å€</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">File</span> *<span class="title">f_dir</span>;</span>      <span class="comment">// æŒ‡å‘è¯¥æ–‡ä»¶æ‰€å±ç›®å½•çš„æŒ‡é’ˆï¼Œæ­¤å­—æ®µä»…åœ¨å†…å­˜ä¸­è¡¨ç¤ºæœ‰æ•ˆ</span></span><br><span class="line">    <span class="type">char</span> f_pad[BY2FILE - MAXNAMELEN - (<span class="number">3</span> + NDIRECT) * <span class="number">4</span> - <span class="keyword">sizeof</span>(<span class="type">void</span> *)]; <span class="comment">// ç”¨äºå­—èŠ‚å¯¹é½çš„å¡«å……å­—æ®µï¼Œç¡®ä¿ç»“æ„ä½“å¤§å°ä¸º256å­—èŠ‚</span></span><br><span class="line">&#125; __attribute__((aligned(<span class="number">4</span>), packed));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fdç»“æ„ä½“ä»£è¡¨ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼ŒåŒ…å«äº†å…³äºæ–‡ä»¶æ“ä½œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fd</span> &#123;</span></span><br><span class="line">    u_int fd_dev_id; <span class="comment">// è®¾å¤‡æ ‡è¯†ç¬¦ï¼Œç”¨äºè¯†åˆ«æ–‡ä»¶æ‰€å±çš„å¤–è®¾ç±»å‹</span></span><br><span class="line">    u_int fd_offset; <span class="comment">// æ–‡ä»¶åç§»é‡ï¼Œè¡¨ç¤ºå½“å‰æ–‡ä»¶æ“ä½œçš„è¯»å†™ä½ç½®</span></span><br><span class="line">    u_int fd_omode;  <span class="comment">// æ–‡ä»¶æ‰“å¼€æ¨¡å¼ï¼ŒæŒ‡å®šäº†æ–‡ä»¶çš„æ“ä½œæƒé™ï¼Œå¦‚è¯»å†™ã€åªè¯»ã€åªå†™ç­‰</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Filefdç»“æ„ä½“ç»“åˆäº†æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶å…ƒæ•°æ®ï¼Œæä¾›äº†å¯¹æ–‡ä»¶æ“ä½œçš„å®Œæ•´ä¸Šä¸‹æ–‡ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Filefd</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Fd</span> <span class="title">f_fd</span>;</span>       <span class="comment">// æ–‡ä»¶æè¿°ç¬¦ï¼ŒåŒ…å«è®¾å¤‡IDã€åç§»é‡å’Œæ‰“å¼€æ¨¡å¼</span></span><br><span class="line">    u_int f_fileid;       <span class="comment">// æ–‡ä»¶æ ‡è¯†ç¬¦ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">File</span> <span class="title">f_file</span>;</span>   <span class="comment">// æ–‡ä»¶å…ƒæ•°æ®ï¼ŒåŒ…å«äº†æ–‡ä»¶åã€å¤§å°ã€ç±»å‹ç­‰å±æ€§</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="Thinking-5-6"><a href="#Thinking-5-6" class="headerlink" title="Thinking 5.6"></a>Thinking 5.6</h3><blockquote><p>ä¸‹å›¾ï¼ˆæ–‡ä»¶ç³»ç»ŸæœåŠ¡æ—¶åºå›¾ï¼‰ä¸­æœ‰å¤šç§ä¸åŒå½¢å¼çš„ç®­å¤´ï¼Œè¯·è§£é‡Šè¿™äº›ä¸åŒç®­å¤´çš„å·®åˆ«ï¼Œå¹¶æ€è€ƒæˆ‘ä»¬çš„æ“ä½œç³»ç»Ÿæ˜¯å¦‚ä½•å®ç°å¯¹åº”ç±»å‹çš„è¿›ç¨‹é—´é€šä¿¡çš„ã€‚</p></blockquote><p>åœ¨å›¾5.7ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ä¸¤ç§ä¸åŒç±»å‹çš„ç®­å¤´ï¼Œåˆ†åˆ«æ˜¯å®å¿ƒç®­å¤´å’Œè™šçº¿ç®­å¤´ã€‚å®å¿ƒç®­å¤´ç”¨äºè¡¨ç¤ºåŒæ­¥æ¶ˆæ¯ï¼Œè€Œè™šçº¿ç®­å¤´åˆ™è¡¨ç¤ºè¿”å›æ¶ˆæ¯ã€‚</p><p>init è¿›ç¨‹åˆ›å»ºäº†<code>fs</code>å’Œ<code>user</code>ä¸¤ä¸ªè¿›ç¨‹ã€‚ç”¨æˆ·è¿›ç¨‹å’Œæ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„ç®­å¤´è¡¨æ˜äºŒè€…ä¹‹é—´å­˜åœ¨äº¤äº’ï¼Œç”¨æˆ·è¿›ç¨‹å‘å‡ºéœ€æ±‚ï¼Œæ–‡ä»¶ç³»ç»Ÿå®ç°ã€‚</p><p>é€šä¿¡çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼šé¦–å…ˆï¼Œç”¨æˆ·ç©ºé—´è°ƒç”¨<code>user/lib/file.c</code>ä¸­æä¾›çš„æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå¦‚<code>open</code>ã€‚è¿™äº›å‡½æ•°éšåè°ƒç”¨<code>user/lib/fsipc.c</code>çš„å‡½æ•°ã€‚ä¼ é€’æ‰€éœ€çš„æ“ä½œç±»å‹ç ï¼Œå¹¶è¿›è¡Œ<code>ipc_send</code>ï¼Œå‘æ–‡ä»¶ç³»ç»Ÿå‘é€è¯·æ±‚ï¼Œå¹¶ç”¨<code>ipc_rcv</code>æ¥æ¥æ”¶ç»“æœã€‚</p><p>æ–‡ä»¶ç³»ç»Ÿæ¥æ”¶åˆ°è¯·æ±‚åï¼Œä½¿ç”¨<code>serv.c</code>ä¸­çš„å‡½æ•°æ¥å¤„ç†è¯·æ±‚ã€‚å¤„ç†ç»“æŸåï¼Œå†æ¬¡è°ƒç”¨<code>ipc_send</code>æŠŠç»“æœä¼ ç»™ç”¨æˆ·è¿›ç¨‹ï¼Œç”¨æˆ·è¿›ç¨‹ç»§ç»­è¿è¡Œã€‚</p><h2 id="å®éªŒéš¾ç‚¹"><a href="#å®éªŒéš¾ç‚¹" class="headerlink" title="å®éªŒéš¾ç‚¹"></a>å®éªŒéš¾ç‚¹</h2><p>æœ¬æ¬¡å®éªŒä¸­éœ€è¦å¡«è¡¥çš„å†…å®¹å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œéš¾åº¦å¹¶ä¸ç®—å¤§ï¼Œä½†æ˜¯MOSçš„æ–‡ä»¶ç³»ç»Ÿæœ¬èº«æ¯”è¾ƒå¤æ‚ï¼Œé‡Œé¢é”™ç»¼å¤æ‚çš„è°ƒç”¨å…³ç³»éœ€è¦ç†æ¸…æ¥šæ‰è¡Œã€‚æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰å¾ˆå¤šéå¸¸é•¿çš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æœ¬èº«å†…éƒ¨çš„å‡½æ•°æ¯”è¾ƒå¤šæ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦å¯¹é‡Œé¢çš„å†…å®¹è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒæ¸…æ¥šçš„æŠŠæ¡ã€‚</p><p>è¿™äº›å‡½æ•°è°ƒç”¨å…¶å®éƒ½æ˜¯å®ç°æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ç³»åˆ—æ“ä½œï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡è°ƒç”¨æ˜¯ä¸€å±‚ä¸€å±‚å‘é‡Œé¢è°ƒç”¨çš„ã€‚</p><h2 id="å®éªŒä½“ä¼š"><a href="#å®éªŒä½“ä¼š" class="headerlink" title="å®éªŒä½“ä¼š"></a>å®éªŒä½“ä¼š</h2><p>Lab5çš„ä¸Šæœºå€’æ˜¯æŒºç…ç†¬çš„ã€‚examå› ä¸ºç†è§£çš„ä¸å¤Ÿåˆ°ä½ï¼Œå¯¼è‡´å¡äº†å¥½ä¹…ï¼Œæœ€ååœ¨åŠ©æ•™çš„å¸®åŠ©ä¸‹æ‰è¿‡äº†ï¼Œextraç®€å•çš„çœ‹äº†çœ‹ï¼Œå¾ˆå¤æ‚ï¼Œä¸è¿‡æœ‰ä¸€ä¸ªæ•´ä½“çš„æ€è·¯ï¼Œé‡Œé¢è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šç»†èŠ‚ã€‚</p><p>OSçš„ä¸Šæœºåˆ°è¿™å°±ç»“æŸäº†ã€‚è¿™ç§ä¸ŠæœºèŠ‚å¥æ„Ÿè§‰è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œè¯¾ä¸‹çš„ä»»åŠ¡ç»™è¶³äº†æç¤ºå’Œè§£é‡Šï¼Œç®€å•æµè§ˆä»£ç å°±å¯ä»¥å®Œæˆï¼›ä¸Šæœºè¦æ±‚å¯¹ä»£ç çš„æ•´ä½“æ¶æ„æœ‰ä¸€ä¸ªæ¸…æ™°çš„æŠŠæ¡ï¼Œéœ€è¦ç¨å¾®æ·±å…¥åœ°é˜…è¯»æœ‰å…³çš„ä»£ç ã€‚è¿™ç§æ–¹å¼å…¶å®æŒºå¥½ï¼Œç¡®ä¿äº†æˆ‘ä»¬æ¯å‘¨éƒ½ä¼šèŠ±ä¸€å®šçš„æ—¶é—´æ¥æµè§ˆæ•´ä¸ªä»£ç ï¼Œæ‰€ä»¥æœ€åå¯¹MOSçš„å†…éƒ¨é€»è¾‘è¿˜æ˜¯äº†è§£çš„æŒºå¥½çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OO_Unit3_å•å…ƒæ€»ç»“</title>
      <link href="/2025/05/18/OO-Unit3%E6%80%BB%E7%BB%93/%E3%80%8CBUAA%20OO%E3%80%8D%E7%AC%AC%E4%B8%89%E5%8D%95%E5%85%83%E6%80%BB%E7%BB%93/"/>
      <url>/2025/05/18/OO-Unit3%E6%80%BB%E7%BB%93/%E3%80%8CBUAA%20OO%E3%80%8D%E7%AC%AC%E4%B8%89%E5%8D%95%E5%85%83%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŒBUAA-OOã€ç¬¬ä¸‰å•å…ƒæ€»ç»“"><a href="#ã€ŒBUAA-OOã€ç¬¬ä¸‰å•å…ƒæ€»ç»“" class="headerlink" title="ã€ŒBUAA OOã€ç¬¬ä¸‰å•å…ƒæ€»ç»“"></a>ã€ŒBUAA OOã€ç¬¬ä¸‰å•å…ƒæ€»ç»“</h1><h2 id="é¢˜ç›®è¯´æ˜"><a href="#é¢˜ç›®è¯´æ˜" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h2><p>æœ¬æ¬¡é¢å‘å¯¹è±¡ç¼–ç¨‹ç¬¬ä¸‰å•å…ƒçš„ä¸»é¢˜æ˜¯ï¼šã€ŒBUAA OOã€ç¬¬ä¸‰å•å…ƒæ€»ç»“</p><ul><li>ç¬¬ä¹æ¬¡ä½œä¸šï¼šæ ¹æ® JML è§„æ ¼å®ç°<code>Person</code>ç±»ã€<code>Tag</code>ç±»ã€<code>Network</code>ç±»</li><li>ç¬¬åæ¬¡ä½œä¸šï¼šæ ¹æ® JML è§„æ ¼å®ç°<code>OfficialAccount</code>ç±»</li><li>ç¬¬åä¸€æ¬¡ä½œä¸šï¼šæ ¹æ® JML è§„æ ¼å®ç°<code>Message</code>ç±»åŠå…¶3ä¸ªå­ç±»</li></ul><h2 id="ä¸‰æ¬¡è¿­ä»£è¯´æ˜"><a href="#ä¸‰æ¬¡è¿­ä»£è¯´æ˜" class="headerlink" title="ä¸‰æ¬¡è¿­ä»£è¯´æ˜"></a>ä¸‰æ¬¡è¿­ä»£è¯´æ˜</h2><h3 id="ç¬¬ä¹æ¬¡ä½œä¸š"><a href="#ç¬¬ä¹æ¬¡ä½œä¸š" class="headerlink" title="ç¬¬ä¹æ¬¡ä½œä¸š"></a>ç¬¬ä¹æ¬¡ä½œä¸š</h3><p>æœ¬æ¬¡ä½œä¸šä¸»è¦æ˜¯æ ¹æ®JMLè§„æ ¼å®ç°ä¸‰ä¸ªæ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼ŒæŒ‰ç…§JMLè§„æ ¼ä¸¥æ ¼å®ç°ç†è®ºä¸Šå°±æ˜¯æ­£ç¡®çš„ï¼Œæ‰€ä»¥å…¶å®è¦å¤šæ³¨æ„ç»†èŠ‚ï¼›ä½†æ˜¯å®Œå…¨æŒ‰ç…§JMLå®ç°æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œ<del>å“ˆå“ˆtleäº†å§</del></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*@ ensures \result ==</span></span><br><span class="line"><span class="comment">      @         (\sum int i; 0 &lt;= i &amp;&amp; i &lt; persons.length;</span></span><br><span class="line"><span class="comment">      @             (\sum int j; i &lt; j &amp;&amp; j &lt; persons.length;</span></span><br><span class="line"><span class="comment">      @                 (\sum int k; j &lt; k &amp;&amp; k &lt; persons.length</span></span><br><span class="line"><span class="comment">      @                     &amp;&amp; getPerson(persons[i].getId()).isLinked(getPerson(persons[j].getId()))</span></span><br><span class="line"><span class="comment">      @                     &amp;&amp; getPerson(persons[j].getId()).isLinked(getPerson(persons[k].getId()))</span></span><br><span class="line"><span class="comment">      @                     &amp;&amp; getPerson(persons[k].getId()).isLinked(getPerson(persons[i].getId()));</span></span><br><span class="line"><span class="comment">      @                     1)));</span></span><br><span class="line"><span class="comment">      @*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="comment">/*@ pure @*/</span> <span class="type">int</span> <span class="title function_">queryTripleSum</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒå…¸å‹çš„å°±æ˜¯è¿™ä¸ªï¼ŒæŒ‰ç…§JMLé‡Œé¢å†™ä¸‰é‡å¾ªç¯æ˜¾ç„¶æ˜¯ä¼šå¯„çš„ï¼Œæ‰€ä»¥è¦æƒ³åˆ«çš„æ–¹æ³•ã€‚</p><p><del>ç»è¿‡å’Œaiçš„è®¨è®º</del>ï¼Œç¬”è€…å‘ç°å…¶å®å¯ä»¥ç”¨åŠ¨æ€ç»´æŠ¤çš„æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…ˆæŠŠè¿™ä¸ªå€¼åˆå§‹åŒ–æˆ0ï¼Œç„¶åæ¯æ¬¡<code>addRelation</code>æˆ–è€…<code>modifyRelation</code>æˆ–è€…ç­‰ç­‰æ—¶ï¼ŒæŒ‰ç…§è¦æ±‚æ›´æ–°å€¼çš„å¤§å°ã€‚è¿™æ ·å…¶å®æ˜¯æŠŠç®—æ³•çš„å‹åŠ›åˆ†é…åˆ°äº†åŠ å‡å…³ç³»ä¸Šé¢äº†ï¼Œè€Œä¸”è¿™æ ·åšè€—æ—¶çŸ­ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†å†—ä½™çš„è®¡ç®—ï¼Œ<del>æ¯”å¦‚å“ªä¸ªåè›‹ç»™ä½ å¡å¥½å‡ æ¬¡<code>qts</code>è¿™ä½ ä¸ç‚¸äº†å—</del>ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œåˆ«çš„ä¼˜åŒ–ç¬”è€…å€’æ˜¯æ²¡æ€ä¹ˆåšã€‚</p><h4 id="æ¶æ„å›¾"><a href="#æ¶æ„å›¾" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h4><p><img src="/img/OO-Unit3/ClassDiagram_ninth.png" alt="ç¬¬9æ¬¡ä½œä¸šç±»å›¾"></p><p>æ•´ä½“æ¶æ„å›¾å¦‚ä¸Šæ‰€ç¤ºï¼Œé™¤äº†é¢˜ç›®è¦æ±‚çš„ç±»ç¬”è€…å¹¶æ²¡æœ‰æ–°å¢åˆ«çš„ç±»ã€‚</p><h4 id="ä»£ç å¤æ‚åº¦åˆ†æ"><a href="#ä»£ç å¤æ‚åº¦åˆ†æ" class="headerlink" title="ä»£ç å¤æ‚åº¦åˆ†æ"></a>ä»£ç å¤æ‚åº¦åˆ†æ</h4><p><img src="/img/OO-Unit3/Magnanimity_ninth.png" alt="ç¬¬9æ¬¡ä½œä¸šä»£ç å¤æ‚åº¦"></p><p>è¿™æ¬¡ä½œä¸šçš„æ•´ä½“å¤æ‚åº¦ä¸ç®—ç‰¹åˆ«é«˜ã€‚æ¯”è¾ƒé«˜çš„<code>Network</code>ç±»é‡Œé¢æ˜¯åœ¨ç»´æŠ¤æŸ¥è¯¢çš„æ•°æ®ã€‚</p><h4 id="Junitæµ‹è¯•æ„Ÿæ‚Ÿ"><a href="#Junitæµ‹è¯•æ„Ÿæ‚Ÿ" class="headerlink" title="Junitæµ‹è¯•æ„Ÿæ‚Ÿ"></a>Junitæµ‹è¯•æ„Ÿæ‚Ÿ</h4><p>Junitçš„æµ‹è¯•ä¸€å¼€å§‹æœ‰ä¸€ä¸ªç‚¹ä¸€ç›´å¡ç€è¿‡ä¸å»ï¼Œç»è¿‡ä»”ç»†é˜…è¯»æŒ‡å¯¼ä¹¦åå‘ç°æ˜¯<code>pure</code>æµ‹è¯•çš„å…³é”®ã€‚ä¸€ä¸ªæ–¹æ³•æ˜¯<code>pure</code>çš„ï¼Œå…³é”®å°±åœ¨äºåœ¨å®ƒè°ƒç”¨å‰åï¼Œå¯¹è±¡çš„å±æ€§ä¸åº”å½“å‘ç”Ÿæ”¹å˜ã€‚æ‰€ä»¥ï¼Œæµ‹è¯•<code>pure</code>çš„å…³é”®å°±åœ¨äºåœ¨è°ƒç”¨è¯¥æ–¹æ³•ä¹‹å‰ï¼Œå°†å…¶è¦æ“ä½œçš„å¯¹è±¡æ·±æ‹·è´ï¼Œç„¶åå’Œå®ƒè°ƒç”¨åçš„å¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚<del>å½“ç„¶æœ‰ä¸ªæ›´ç›´ç™½çš„æ–¹æ³•å°±æ˜¯ç›´æ¥æ–°å»ºä¸¤ä¸ªå±æ€§ä¸€æ ·çš„å®ä¾‹ï¼Œå…¶ä¸­æŸä¸ªä½œä¸ºå¯¹ç…§ç»„æ¥æµ‹è¯•ï¼Œç®¡å®ƒä»€ä¹ˆæ‹·è´</del></p><h3 id="ç¬¬åæ¬¡ä½œä¸š"><a href="#ç¬¬åæ¬¡ä½œä¸š" class="headerlink" title="ç¬¬åæ¬¡ä½œä¸š"></a>ç¬¬åæ¬¡ä½œä¸š</h3><p>æœ¬æ¬¡ä½œä¸šæ–°å¢äº†ä¸€ä¸ª<code>OfficialAccount</code>ç±»ï¼Œå¦å¤–ï¼ŒåŸå…ˆçš„ç±»é‡Œé¢ä¹Ÿæœ‰ä¸€äº›æ–°çš„è¿­ä»£å†…å®¹ã€‚</p><p>æœ¬æ¬¡å¼ºæµ‹tleäº†å¥½å‡ ä¸ªç‚¹ï¼Œ<del>äº”ä¸€ç©çš„å¤ªå—¨äº†</del>ï¼Œæ²¡æœ‰åšç»†è‡´çš„ä¼˜åŒ–ã€‚æ¯”è¾ƒå¡æ—¶é—´çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*@ public normal_behavior</span></span><br><span class="line"><span class="comment">      @ requires containsPerson(personId) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          getPerson(personId).containsTag(tagId);</span></span><br><span class="line"><span class="comment">      @ ensures \result == getPerson(personId).getTag(tagId).getValueSum();</span></span><br><span class="line"><span class="comment">      @ also</span></span><br><span class="line"><span class="comment">      @ public exceptional_behavior</span></span><br><span class="line"><span class="comment">      @ signals (PersonIdNotFoundException e) !containsPerson(personId);</span></span><br><span class="line"><span class="comment">      @ signals (TagIdNotFoundException e) containsPerson(personId) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @                                    !getPerson(personId).containsTag(tagId);</span></span><br><span class="line"><span class="comment">      @*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="comment">/*@ pure @*/</span> <span class="type">int</span> <span class="title function_">queryTagValueSum</span><span class="params">(<span class="type">int</span> personId, <span class="type">int</span> tagId)</span> <span class="keyword">throws</span> PersonIdNotFoundException, TagIdNotFoundException;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå…¶å®è·Ÿå‰ä¸€æ¬¡ä½œä¸šè¿˜æ˜¯ä¸€æ ·çš„ï¼Œåšå¥½åŠ¨æ€è§„åˆ’å°±å¥½äº†ï¼Œå¹¶ä¸æ˜¯ä»€ä¹ˆå¤æ‚çš„é—®é¢˜ã€‚å½“ç„¶è¿™ä¸ªè¦åšåŠ¨æ€è§„åˆ’çš„è¯è¿˜è¦æ³¨æ„ä¸€äº›æ·±å±‚æ¬¡çš„ç»†èŠ‚ã€‚ç¬”è€…åœ¨å®Œæˆäº†åŠ¨æ€è§„åˆ’ä¹‹åè¿˜æœ‰ä¸€äº›ç»†èŠ‚ä¸Šçš„bugï¼Œå¤„ç†äº†å¾ˆä¹…ã€‚åœ¨ç¬¬åä¸€æ¬¡ä½œä¸šçš„è‡ªæµ‹è¿‡ç¨‹ä¸­ï¼Œä¸è¿™ä¸ªæ–¹æ³•æœ‰å…³è¿˜å‡ºäº†ä¸€ä¸ªéå¸¸ç»†å°çš„bugï¼Œè¿™ä¸ªä¹‹åå†è¯´ã€‚</p><p>åœ¨äº’æµ‹è¿‡ç¨‹ä¸­ï¼Œç¬”è€…ä¹Ÿé’ˆå¯¹æ€§çš„è®¾è®¡äº†ä¸€äº›å’Œ<code>qtvs</code>æœ‰å…³çš„æµ‹è¯•æ•°æ®ï¼ŒæˆåŠŸhackåˆ°äº†æˆ¿å‹ã€‚</p><p>å¦å¤–ï¼Œåœ¨è¿›è¡Œäº†ä¸Šè¿°ä¼˜åŒ–ä¹‹åï¼Œæ‰€æœ‰å¼ºæµ‹ç‚¹ï¼Œç¬”è€…æœ€æ…¢çš„åœ¨æœ¬åœ°ç”¨profileråˆ†æï¼Œä¹Ÿèƒ½å‹ç¼©åˆ°1600msä»¥å†…ï¼Œä½†æ˜¯è¯„æµ‹æœºè·‘ä¸‹æ¥å°±æ˜¯tleï¼Œ<del>çœŸè¯¥åŠ å¼ºä¸€ä¸‹è¿™ä¸ªçƒ‚è¯„æµ‹æœºäº†</del>ã€‚æ‰€ä»¥ç¬”è€…åœ¨ä»”ç»†è€ƒè™‘ä¹‹åï¼Œå°†è¿™ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*@ public normal_behavior</span></span><br><span class="line"><span class="comment">      @ requires containsPerson(id1) &amp;&amp; id1 == id2 ;</span></span><br><span class="line"><span class="comment">      @ ensures \result==0 ;</span></span><br><span class="line"><span class="comment">      @ also</span></span><br><span class="line"><span class="comment">      @ public normal_behavior</span></span><br><span class="line"><span class="comment">      @ requires containsPerson(id1) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          containsPerson(id2) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          id1 != id2 &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          (\exists PersonInterface[] path;</span></span><br><span class="line"><span class="comment">      @          path.length &gt;= 2 &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          path[0].equals(getPerson(id1)) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          path[path.length - 1].equals(getPerson(id2));</span></span><br><span class="line"><span class="comment">      @          (\forall int i; 1 &lt;= i &amp;&amp; i &lt; path.length; path[i - 1].isLinked(path[i])));</span></span><br><span class="line"><span class="comment">      @ ensures  (\exists PersonInterface[] pathM;</span></span><br><span class="line"><span class="comment">      @          pathM.length &gt;= 2 &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          pathM[0].equals(getPerson(id1)) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          pathM[pathM.length - 1].equals(getPerson(id2)) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          (\forall int i; 1 &lt;= i &amp;&amp; i &lt; pathM.length; pathM[i - 1].isLinked(pathM[i]));</span></span><br><span class="line"><span class="comment">      @          (\forall PersonInterface[] path;</span></span><br><span class="line"><span class="comment">      @          path.length &gt;= 2 &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          path[0].equals(getPerson(id1)) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          path[path.length - 1].equals(getPerson(id2)) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          (\forall int i; 1 &lt;= i &amp;&amp; i &lt; path.length; path[i - 1].isLinked(path[i]));</span></span><br><span class="line"><span class="comment">      @          (\sum int i; 0 &lt;= i &amp;&amp; i &lt; path.length; 1) &gt;=</span></span><br><span class="line"><span class="comment">      @          (\sum int i; 0 &lt;= i &amp;&amp; i &lt; pathM.length; 1)) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @          \result==(\sum int i; 1 &lt;= i &amp;&amp; i &lt; pathM.length; 1));</span></span><br><span class="line"><span class="comment">      @ also</span></span><br><span class="line"><span class="comment">      @ public exceptional_behavior</span></span><br><span class="line"><span class="comment">      @ signals (PersonIdNotFoundException e) !containsPerson(id1);</span></span><br><span class="line"><span class="comment">      @ signals (PersonIdNotFoundException e) containsPerson(id1) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @                                       !containsPerson(id2);</span></span><br><span class="line"><span class="comment">      @ signals (PathNotFoundException e) containsPerson(id1) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @                                   containsPerson(id2) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @         !(\exists PersonInterface[] path;</span></span><br><span class="line"><span class="comment">      @         path.length &gt;= 2 &amp;&amp;</span></span><br><span class="line"><span class="comment">      @         path[0].equals(getPerson(id1)) &amp;&amp;</span></span><br><span class="line"><span class="comment">      @         path[path.length - 1].equals(getPerson(id2));</span></span><br><span class="line"><span class="comment">      @         (\forall int i; 1 &lt;= i &amp;&amp; i &lt; path.length; path[i - 1].isLinked(path[i])));</span></span><br><span class="line"><span class="comment">      @*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="comment">/*@ pure @*/</span> <span class="type">int</span> <span class="title function_">queryShortestPath</span><span class="params">(<span class="type">int</span> id1,<span class="type">int</span> id2)</span> <span class="keyword">throws</span> PersonIdNotFoundException, PathNotFoundException;</span><br></pre></td></tr></table></figure><p>ç”±å¸¸è§„çš„BFSç®—æ³•ï¼Œå³å¹¿åº¦ä¼˜å…ˆç®—æ³•ï¼Œä¼˜åŒ–æˆäº†åŒå‘BFSç®—æ³•ã€‚è‡³æ­¤ä¹‹åï¼Œæœ€æ…¢çš„ç‚¹ä¹Ÿèƒ½åœ¨500mså°±èƒ½è·‘å®Œäº†ã€‚</p><p>åŒå‘ bfsï¼Œæˆ–è¯´å›¾çš„åŒå‘æœç´¢ç®—æ³•ï¼Œæ˜¯å¯¹äºå¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•çš„ä¸€ç§æ”¹è¿›ã€‚bfs ä»èµ·ç‚¹å¼€å§‹ç”±æµ…å…¥æ·±åœ°éå†ï¼Œç›´åˆ°æ‰¾åˆ°ç»ˆç‚¹ï¼›è€ŒåŒå‘ bfs åˆ™ä»èµ·ç‚¹ä¸ç»ˆç‚¹åŒæ—¶å¼€å§‹éå†ï¼Œç›´åˆ°éå†çš„åŒºåŸŸç›¸äº¤ï¼ˆè¯´æ˜æ‰¾åˆ°äº†æœ€çŸ­è·¯å¾„ï¼‰ã€‚</p><h4 id="æ¶æ„å›¾-1"><a href="#æ¶æ„å›¾-1" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h4><p><img src="/img/OO-Unit3/ClassDiagram_tenth.png" alt="ç¬¬10æ¬¡ä½œä¸šç±»å›¾"></p><h4 id="ä»£ç å¤æ‚åº¦åˆ†æ-1"><a href="#ä»£ç å¤æ‚åº¦åˆ†æ-1" class="headerlink" title="ä»£ç å¤æ‚åº¦åˆ†æ"></a>ä»£ç å¤æ‚åº¦åˆ†æ</h4><p><img src="/img/OO-Unit3/Magnanimity_tenth.png" alt="ç¬¬10æ¬¡ä½œä¸šä»£ç å¤æ‚åº¦"></p><p>æœ¬æ¬¡ä½œä¸šå¤æ‚åº¦æ•´ä½“å°±æœ‰ç‚¹é«˜äº†ï¼Œä¸»è¦é›†ä¸­åœ¨<code>Network</code>ç±»ï¼Œå› ä¸ºå…¶ä¸­åŒ…å«äº†<code>queryShortestPath</code>æ–¹æ³•å’Œ<code>modifyRelation</code>æ–¹æ³•ã€‚</p><h3 id="ç¬¬åä¸€æ¬¡ä½œä¸š"><a href="#ç¬¬åä¸€æ¬¡ä½œä¸š" class="headerlink" title="ç¬¬åä¸€æ¬¡ä½œä¸š"></a>ç¬¬åä¸€æ¬¡ä½œä¸š</h3><p>è¿™æ¬¡ä½œä¸šä¸»è¦æ–°å¢äº†<code>Message</code>ç±»ä»¥åŠå®ƒçš„ä¸‰ä¸ªå­ç±»ã€‚</p><p>æœ¬æ¬¡ä½œä¸šå€¼å¾—æ³¨æ„çš„ç‚¹å€’æ˜¯ä¸ç®—å¤šï¼Œç¬”è€…ä¸ªäººè®¤ä¸ºåªæœ‰ä¸€ä¸ªï¼šåœ¨ç¬¬åä¸€æ¬¡ä½œä¸šé‡Œé¢ï¼Œ<code>sendMessage</code>çš„åŠ å…¥ï¼Œå¯èƒ½ä½¿å¾—ç›¸åŒçš„æ–‡ç« å¯èƒ½ä¼šè¢«è½¬å‘åˆ°ä¸€ä¸ªäººçš„å®¹å™¨ä¸­ã€‚åœ¨åˆ é™¤çš„æ—¶å€™ï¼Œéœ€è¦å°†æ‰€æœ‰è¯¥idçš„æ–‡ç« éƒ½åˆ æ‰ã€‚</p><p>å¦å¤–ï¼Œåœ¨è‡ªè¡Œæµ‹è¯•çš„æ—¶å€™ï¼Œç¬”è€…å‘ç°äº†ä¸€ä¸ªéå¸¸éšè”½çš„bugã€‚å› ä¸º<code>Tag</code>æ˜¯å…è®¸idç›¸åŒä½†æ˜¯å®ä¾‹ä¸åŒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ª<code>person</code>ï¼Œä»–ä»¬å„è‡ªæ‹¥æœ‰ä¸€ä¸ª<code>tag</code>ï¼Œè¿™ä¸¤ä¸ª<code>tag</code>æ˜¾ç„¶å®ä¾‹æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ä»–ä»¬å¯ä»¥æ‹¥æœ‰ç›¸åŒçš„idã€‚åœ¨ç¬”è€…çš„å®ç°ä¸­ï¼Œå½“å‘ç”Ÿäº†<code>modifyRelation</code>çš„æ—¶å€™ï¼Œéœ€è¦æ‰¾åˆ°åŒæ—¶åŒ…å«è¿™ä¸¤ä¸ª<code>person</code>çš„<code>tag</code>ï¼Œå› æ­¤ç¬”è€…é‡‡ç”¨äº†ä¸€ä¸ª<code>HashMap</code>æ¥è®°å½•è¿™ä¸ªäººæ‰€åœ¨çš„<code>tag</code>ï¼Œè€Œkeyä¾¿æ˜¯ä½¿ç”¨äº†<code>tag</code>çš„idã€‚ç„¶è€Œï¼Œä¸€ä¸ªäººå¯èƒ½åŒæ—¶å¤„äºidç›¸åŒçš„ä¸åŒ<code>tag</code>é‡Œé¢ï¼Œ<code>HashMap</code>çš„keyä¸€å®šæ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥ç”¨<code>HashMap</code>æ¥è®°å½•å¿…ç„¶æ˜¯é”™è¯¯çš„ã€‚</p><p>ç¬”è€…åœ¨ä¸å°ä¼™ä¼´ä»¬è®¨è®ºä¹‹åï¼Œé‡‡ç”¨äº†è¿™æ ·ä¸€ç§æ–¹å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TagKey</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> ownerId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> tagId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TagKey</span><span class="params">(<span class="type">int</span> ownerId, <span class="type">int</span> tagId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.ownerId = ownerId;</span><br><span class="line">        <span class="built_in">this</span>.tagId = tagId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">        <span class="type">TagKey</span> <span class="variable">tagKey</span> <span class="operator">=</span> (TagKey) o;</span><br><span class="line">        <span class="keyword">return</span> ownerId == tagKey.ownerId &amp;&amp; tagId == tagKey.tagId; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123; </span><br><span class="line">        <span class="keyword">return</span> Objects.hash(ownerId, tagId); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡‡ç”¨è¿™æ ·çš„ä¸€ç§æ•°æ®ç»“æ„æ¥è®°å½•<code>tag</code>çš„â€œå”¯ä¸€idâ€ï¼Œè¿™æ ·å°±ç¡®ä¿äº†keyæ˜¯å”¯ä¸€çš„</p><h4 id="æ¶æ„å›¾-2"><a href="#æ¶æ„å›¾-2" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h4><p><img src="/img/OO-Unit3/ClassDiagram_eleventh.png" alt="ç¬¬11æ¬¡ä½œä¸šç±»å›¾"></p><h4 id="ä»£ç å¤æ‚åº¦åˆ†æ-2"><a href="#ä»£ç å¤æ‚åº¦åˆ†æ-2" class="headerlink" title="ä»£ç å¤æ‚åº¦åˆ†æ"></a>ä»£ç å¤æ‚åº¦åˆ†æ</h4><p><img src="/img/OO-Unit3/Magnanimity_eleventh.png" alt="ç¬¬11æ¬¡ä»£ç å¤æ‚åº¦"></p><h2 id="æµ‹è¯•è¿‡ç¨‹"><a href="#æµ‹è¯•è¿‡ç¨‹" class="headerlink" title="æµ‹è¯•è¿‡ç¨‹"></a>æµ‹è¯•è¿‡ç¨‹</h2><h3 id="æµ‹è¯•æ€æƒ³"><a href="#æµ‹è¯•æ€æƒ³" class="headerlink" title="æµ‹è¯•æ€æƒ³"></a>æµ‹è¯•æ€æƒ³</h3><h4 id="é»‘ç›’æµ‹è¯•"><a href="#é»‘ç›’æµ‹è¯•" class="headerlink" title="é»‘ç›’æµ‹è¯•"></a>é»‘ç›’æµ‹è¯•</h4><blockquote><p>é»‘ç›’æµ‹è¯•ï¼ŒæŠŠç¨‹åºçœ‹ä½œä¸€ä¸ªä¸èƒ½æ‰“å¼€çš„é»‘ç›’å­ï¼Œåœ¨å®Œå…¨ä¸è€ƒè™‘ç¨‹åºå†…éƒ¨ç»“æ„å’Œå†…éƒ¨ç‰¹æ€§çš„æƒ…å†µä¸‹ï¼Œåœ¨ç¨‹åºæ¥å£è¿›è¡Œæµ‹è¯•ã€‚é»‘ç›’æµ‹è¯•ç€çœ¼äºç¨‹åºå¤–éƒ¨ç»“æ„ï¼Œä¸è€ƒè™‘å†…éƒ¨é€»è¾‘ç»“æ„ï¼Œä¸»è¦é’ˆå¯¹è½¯ä»¶ç•Œé¢å’Œè½¯ä»¶åŠŸèƒ½è¿›è¡Œæµ‹è¯•ã€‚<br>â€”â€”ç™¾åº¦ç™¾ç§‘ï¼Œé»‘ç›’æµ‹è¯•</p></blockquote><p>è¯„æµ‹æœºå…¶å®å°±æ˜¯ä¸€ç§é»‘ç›’æµ‹è¯•ï¼Œå®ƒåªå…³å¿ƒç¨‹åºæ˜¯å¦èƒ½äº§ç”Ÿæ­£ç¡®çš„è¾“å‡ºï¼Œä¸å…³å¿ƒç¨‹åºå†…éƒ¨æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚</p><h4 id="ç™½ç›’æµ‹è¯•"><a href="#ç™½ç›’æµ‹è¯•" class="headerlink" title="ç™½ç›’æµ‹è¯•"></a>ç™½ç›’æµ‹è¯•</h4><blockquote><p>ç™½ç›’æµ‹è¯•æ˜¯ä¸€ç§æµ‹è¯•ç”¨ä¾‹è®¾è®¡æ–¹æ³•ï¼Œç›’å­æŒ‡çš„æ˜¯è¢«æµ‹è¯•çš„è½¯ä»¶ï¼Œç™½ç›’æŒ‡çš„æ˜¯ç›’å­æ˜¯å¯è§†çš„ï¼Œå³æ¸…æ¥šç›’å­å†…éƒ¨çš„ä¸œè¥¿ä»¥åŠé‡Œé¢æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚â€œç™½ç›’â€æ³•å…¨é¢äº†è§£ç¨‹åºå†…éƒ¨é€»è¾‘ç»“æ„ã€å¯¹æ‰€æœ‰é€»è¾‘è·¯å¾„è¿›è¡Œæµ‹è¯•ã€‚<br>â€”â€”ç™¾åº¦ç™¾ç§‘ï¼Œç™½ç›’æµ‹è¯•</p></blockquote><p>æœ¬å•å…ƒè¦æ±‚å­¦ç”Ÿè®¾è®¡çš„ Junit æµ‹è¯•ä¾¿æ˜¯ä¸€ç§ç™½ç›’æµ‹è¯•ï¼Œå®ƒè¦æ±‚è¢«æµ‹æ–¹æ³•çš„è¡Œä¸ºå®Œå…¨ç¬¦åˆè§„æ ¼è¯´æ˜ï¼Œä¸èƒ½äº§ç”Ÿè¶Šç•Œçš„è¡Œä¸ºã€‚</p><h3 id="æµ‹è¯•æ–¹æ³•"><a href="#æµ‹è¯•æ–¹æ³•" class="headerlink" title="æµ‹è¯•æ–¹æ³•"></a>æµ‹è¯•æ–¹æ³•</h3><h4 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><p>å•å…ƒæµ‹è¯•æ˜¯é’ˆå¯¹ç¨‹åºæ¨¡å—æ¥è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚åœ¨è¿‡ç¨‹åŒ–ç¼–ç¨‹ä¸­ï¼Œä¸€ä¸ªå•å…ƒå°±æ˜¯å•ä¸ªç¨‹åºã€å‡½æ•°ã€è¿‡ç¨‹ç­‰ï¼›å¯¹äºé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæœ€å°å•å…ƒå°±æ˜¯æ–¹æ³•ã€‚å•å…ƒæµ‹è¯•çš„ç›®æ ‡æ˜¯éš”ç¦»ç¨‹åºéƒ¨ä»¶å¹¶è¯æ˜è¿™äº›å•ä¸ªéƒ¨ä»¶æ˜¯æ­£ç¡®çš„ã€‚</p><p>æœ¬å•å…ƒçš„Junitå°±æ˜¯ä¸€ç§å•å…ƒæµ‹è¯•ã€‚</p><h4 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h4><blockquote><p>åŠŸèƒ½æµ‹è¯•å°±æ˜¯å¯¹äº§å“çš„å„åŠŸèƒ½è¿›è¡ŒéªŒè¯ï¼Œæ ¹æ®åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹ï¼Œé€é¡¹æµ‹è¯•ï¼Œæ£€æŸ¥äº§å“æ˜¯å¦è¾¾åˆ°ç”¨æˆ·è¦æ±‚çš„åŠŸèƒ½ã€‚åŠŸèƒ½æµ‹è¯•ä¹Ÿå«æ•°æ®é©±åŠ¨æµ‹è¯•ï¼Œåªéœ€è€ƒè™‘éœ€è¦æµ‹è¯•çš„å„ä¸ªåŠŸèƒ½ï¼Œä¸éœ€è¦è€ƒè™‘æ•´ä¸ªè½¯ä»¶çš„å†…éƒ¨ç»“æ„åŠä»£ç ã€‚<br>â€”â€”ç™¾åº¦ç™¾ç§‘ï¼ŒåŠŸèƒ½æµ‹è¯•</p></blockquote><p>åŠŸèƒ½æµ‹è¯•å…¶å®å°±æ˜¯ä¸€ç§é»‘ç›’æµ‹è¯•ã€‚</p><h4 id="é›†æˆæµ‹è¯•"><a href="#é›†æˆæµ‹è¯•" class="headerlink" title="é›†æˆæµ‹è¯•"></a>é›†æˆæµ‹è¯•</h4><blockquote><p>é›†æˆæµ‹è¯•ï¼Œå³å¯¹ç¨‹åºæ¨¡å—é‡‡ç”¨ä¸€æ¬¡æ€§æˆ–å¢å€¼æ–¹å¼ç»„è£…èµ·æ¥ï¼Œå¯¹ç³»ç»Ÿçš„æ¥å£è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚æ•´åˆæµ‹è¯•ä¸€èˆ¬åœ¨å•å…ƒæµ‹è¯•ä¹‹åã€ç³»ç»Ÿæµ‹è¯•ä¹‹å‰è¿›è¡Œã€‚å®è·µè¡¨æ˜ï¼Œæœ‰æ—¶æ¨¡å—è™½ç„¶å¯ä»¥å•ç‹¬å·¥ä½œï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯ç»„è£…èµ·æ¥ä¹Ÿå¯ä»¥åŒæ—¶å·¥ä½œã€‚è¯¥æµ‹è¯•ï¼Œå¯ä»¥ç”±ç¨‹åºå‘˜æˆ–æ˜¯è½¯ä»¶å“ä¿å·¥ç¨‹å¸ˆè¿›è¡Œã€‚<br>â€”â€”Wikipediaï¼Œé›†æˆæµ‹è¯•</p></blockquote><h4 id="å‹åŠ›æµ‹è¯•"><a href="#å‹åŠ›æµ‹è¯•" class="headerlink" title="å‹åŠ›æµ‹è¯•"></a>å‹åŠ›æµ‹è¯•</h4><p>å‹åŠ›æµ‹è¯•ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯é’ˆå¯¹ç‰¹å®šçš„ç³»ç»Ÿã€ç»„ä»¶ã€ç¨‹åºç­‰ï¼Œé‡‡ç”¨è¶…è¿‡æ­£å¸¸ä½¿ç”¨æ¡ä»¶ä¸‹çš„æƒ…å†µè¿›è¡Œè¿è½¬ï¼Œç¡®è®¤åœ¨æé™çŠ¶æ€ä¸‹ï¼Œç¨‹åºæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è¿è½¬ã€‚</p><p>åˆ°ç›®å‰ç¬”è€…è¿˜æ²¡ç”¨ä½¿ç”¨è¿‡è¿™ç§æµ‹è¯•æ–¹å¼ï¼Œä½†ä¼¼ä¹èˆªç©ºèˆªå¤©è®¾è®¡ç»å¸¸ä¼šä½¿ç”¨è¿™ç§æµ‹è¯•æ–¹æ³•ï¼ˆç¡®è®¤ç³»ç»Ÿåœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ä¼šæŸåï¼Œä»¥åŠå®‰å…¨ä½¿ç”¨æ¡ä»¶ï¼‰ã€‚</p><h4 id="å›å½’æµ‹è¯•"><a href="#å›å½’æµ‹è¯•" class="headerlink" title="å›å½’æµ‹è¯•"></a>å›å½’æµ‹è¯•</h4><blockquote><p>å›å½’æµ‹è¯•æ˜¯æŒ‡ä¿®æ”¹äº†æ—§ä»£ç åï¼Œé‡æ–°è¿›è¡Œæµ‹è¯•ä»¥ç¡®è®¤ä¿®æ”¹æ²¡æœ‰å¼•å…¥æ–°çš„é”™è¯¯æˆ–å¯¼è‡´å…¶ä»–ä»£ç äº§ç”Ÿé”™è¯¯ã€‚è‡ªåŠ¨å›å½’æµ‹è¯•å°†å¤§å¹…é™ä½ç³»ç»Ÿæµ‹è¯•ã€ç»´æŠ¤å‡çº§ç­‰é˜¶æ®µçš„æˆæœ¬ã€‚<br>â€”â€”ç™¾åº¦ç™¾ç§‘ï¼Œå›å½’æµ‹è¯•</p></blockquote><h3 id="æ•°æ®æ„é€ "><a href="#æ•°æ®æ„é€ " class="headerlink" title="æ•°æ®æ„é€ "></a>æ•°æ®æ„é€ </h3><p>æœ¬æ¬¡ç¬”è€…åªå†™äº†ä¸€ä¸ªç®€æ˜“çš„æ•°æ®ç”Ÿæˆå™¨ï¼Œè§„èŒƒäº†ç”Ÿæˆæ•°æ®çš„åˆæ³•æ€§ä»¥åï¼Œæ‰‹åŠ¨æ·»åŠ äº†ä¸€äº›æ¡ä»¶æ¥å¢åŠ æ•°æ®çš„å¼ºåº¦ã€‚ç”Ÿæˆæ•°æ®æ—¶åº”å½“ä¼˜å…ˆè€ƒè™‘JMLè§„æ ¼ä¸­æè¿°çš„æ¯ä¸€ä¸ªæ–¹æ³•çš„behaviorã€‚ç”±äºæ—¶é—´æœ‰é™ï¼Œå¹¶æ²¡æœ‰åˆ»æ„å»æ„é€ è¶³å¤Ÿå¼ºå¤§çš„æµ‹è¯•æ•°æ®ã€‚å› æ­¤ç¬”è€…çš„æ•°æ®ç”Ÿæˆå™¨ä¸»è¦åœ¨æœ¬åœ°æµ‹è¯•æ—¶å‘æŒ¥äº†ä½œç”¨ï¼Œåœ¨äº’æµ‹é˜¶æ®µæˆåŠŸåˆ€ä¸­äº†å‡ ä¸ªäººã€‚</p><h2 id="å¦‚ä½•å¼•å¯¼å¤§æ¨¡å‹åœ¨ä¸åŒåœºæ™¯ä¸‹å®Œæˆå¤æ‚ä»»åŠ¡"><a href="#å¦‚ä½•å¼•å¯¼å¤§æ¨¡å‹åœ¨ä¸åŒåœºæ™¯ä¸‹å®Œæˆå¤æ‚ä»»åŠ¡" class="headerlink" title="å¦‚ä½•å¼•å¯¼å¤§æ¨¡å‹åœ¨ä¸åŒåœºæ™¯ä¸‹å®Œæˆå¤æ‚ä»»åŠ¡"></a>å¦‚ä½•å¼•å¯¼å¤§æ¨¡å‹åœ¨ä¸åŒåœºæ™¯ä¸‹å®Œæˆå¤æ‚ä»»åŠ¡</h2><p>ç°åœ¨çš„å¤§æ¨¡å‹æ•´ä½“å¯ç”¨æ€§éå¸¸é«˜ï¼Œä¸€èˆ¬æ¥è®²ä¸ç”¨åˆ»æ„å»å¤šæ­¥å¼•å¯¼ã€‚ç¬”è€…å°è¯•è¿‡ç›´æ¥ä½¿ç”¨å¤§æ¨¡å‹å®Œæˆç¬¬åä¸€æ¬¡ä½œä¸šï¼Œå…¶å®Œæˆçš„æ¯”è¾ƒå®Œå–„ï¼Œæ€§èƒ½æ–¹é¢æœ‰æ‰€æ¬ ç¼ºï¼Œ<del>ä»£ç é£æ ¼æƒ¨ä¸å¿ç¹</del>ï¼Œä½†å…¶ä»–æ–¹é¢ç¡®å®å¾ˆä¼˜å¼‚ï¼Œç¬”è€…åªè¿›è¡Œäº†ç»†èŠ‚ä¸Šçš„ä¼˜åŒ–ä¸ç»´æŠ¤å’Œæ€§èƒ½ä¸Šçš„æ”¹å–„ã€‚</p><h2 id="å¥‘çº¦å¼è®¾è®¡"><a href="#å¥‘çº¦å¼è®¾è®¡" class="headerlink" title="å¥‘çº¦å¼è®¾è®¡"></a>å¥‘çº¦å¼è®¾è®¡</h2><p>å¥‘çº¦å¼è®¾è®¡æ˜¯ä¸€ç§è®¾è®¡è®¡ç®—æœºè½¯ä»¶çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•è¦æ±‚è½¯ä»¶è®¾è®¡è€…ä¸ºè½¯ä»¶ç»„ä»¶å®šä¹‰æ­£å¼çš„ï¼Œç²¾ç¡®çš„å¹¶ä¸”å¯éªŒè¯çš„æ¥å£ã€‚</p><p>å¥‘çº¦å¼è®¾è®¡çš„æ ¸å¿ƒåœ¨äºåˆ†ç¦»è§„æ ¼è®¾è®¡ä¸ä»£ç å®ç°ã€‚è®¾è®¡è€…é€šè¿‡éœ€æ±‚æ¥è®¾è®¡ä¸æ’°å†™æ¯ä¸ªæ–¹æ³•çš„è§„æ ¼ï¼Œç¨‹åºå‘˜é€šè¿‡è§„æ ¼æ¥å®ç°ä»£ç ã€‚è¿™ç§è®¾è®¡æ€æƒ³å¯ä»¥æœ‰æ•ˆå‡å°‘ä»£ç ä¸­çš„bugæ•°é‡ï¼Œæé«˜ä»£ç çš„å¯é æ€§ä¸å¯ç»´æŠ¤æ€§ï¼›ä½†ç”±äºå¥‘çº¦å¼è®¾è®¡éœ€è¦ä¸ºæ¯ä¸ªç±»ä¹¦å†™è¯¦ç»†çš„å¥‘çº¦ï¼ˆå¥‘çº¦é•¿åº¦å¾€å¾€ä¼šè¶…è¿‡ä»£ç æœ¬èº«çš„é•¿åº¦ï¼‰ï¼Œè¿™ç§è®¾è®¡æ–¹å¼ä¼šæ˜¾è‘—åœ°é™ä½å¼€å‘çš„é€Ÿåº¦ã€‚å› æ­¤åœ¨å®é™…åº”ç”¨ä¸­å¾€å¾€åœ¨è®¾è®¡ä»£ç çš„æ ¸å¿ƒæ¨¡å—ä¸­ä½¿ç”¨ï¼Œä»¥ä¿è¯æ ¸å¿ƒæ¨¡å—çš„æ­£ç¡®æ€§ã€‚</p><p>JMLæ˜¯ä¸€é—¨éå¸¸å†·é—¨çš„è§„æ ¼å»ºæ¨¡è¯­è¨€ï¼Œè¯¾ç¨‹ç»„å¹¶æœªè®©å­¦ç”Ÿä»¬å®Œæˆç”±éœ€æ±‚è®¾è®¡è§„æ ¼è¿™ä¸€å±‚æ¬¡ï¼Œè€Œæ˜¯å°†ä¸‰æ¬¡è¿­ä»£çš„é‡ç‚¹æ”¾åœ¨äº†ç”±è§„æ ¼å®ç°ä»£ç ã€‚åŸºäºè§„æ ¼çš„å±‚æ¬¡åŒ–è®¾è®¡æœ‰ä¸¤ä¸ªå±‚æ¬¡ï¼Œä¸€æ˜¯æ ¹æ®éœ€æ±‚è®¾è®¡è§„æ ¼ï¼ŒäºŒæ˜¯æ ¹æ®è§„æ ¼å®ç°ä»£ç ã€‚è¯¾ç¨‹ç»„å°†ç»å¤§éƒ¨åˆ†é‡å¿ƒéƒ½æ”¾åˆ°äº†åè€…ä¹‹ä¸Šï¼Œç¬”è€…è®¤ä¸ºä¸æ˜¯å¾ˆåˆç†ã€‚å¯ä»¥å°è¯•è®©åŒå­¦ä»¬è‡ªå·±ç¼–å†™JMLè§„æ ¼ã€‚</p><h2 id="Junitæµ‹è¯•"><a href="#Junitæµ‹è¯•" class="headerlink" title="Junitæµ‹è¯•"></a>Junitæµ‹è¯•</h2><p>Junitæµ‹è¯•æ˜¯ç”±è§„æ ¼è®¾è®¡å¼•æ¥çš„æµ‹è¯•ï¼Œæ—¨åœ¨éªŒè¯ä»£ç æ˜¯å¦ç¬¦åˆè§„æ ¼è¯´æ˜ä¹¦ã€‚æƒ³è¦è¿›è¡ŒJunitæµ‹è¯•ï¼Œå‰ææ˜¯æ‹¥æœ‰ä¸€ä¸ªå®Œå…¨æ­£ç¡®çš„è§„æ ¼ï¼Œå¦åˆ™Junitæµ‹è¯•å®Œå…¨æ˜¯ä¸€çº¸ç©ºè°ˆã€‚</p><h3 id="æ•°æ®ç”Ÿæˆ"><a href="#æ•°æ®ç”Ÿæˆ" class="headerlink" title="æ•°æ®ç”Ÿæˆ"></a>æ•°æ®ç”Ÿæˆ</h3><p>æœ¬æ¬¡Junitæµ‹è¯•æˆ‘å¹¶æ²¡æœ‰è€ƒè™‘éšæœºæ•°æ®æ„é€ ï¼Œåªæ˜¯é€‰æ‹©äº†15-30ä¸ªæœ‰ç‰¹è‰²çš„æ•°æ®ç‚¹è¿›è¡Œæµ‹è¯•å……åˆ†è¦†ç›–JMLè§„æ ¼ä¸­å„ä¸ª<code>behavior</code>çš„<code>requires</code>å’Œ<code>ensures</code>ã€‚</p><h3 id="æ–­è¨€"><a href="#æ–­è¨€" class="headerlink" title="æ–­è¨€"></a>æ–­è¨€</h3><p>æ·±åº¦æ£€æŸ»JMLè§„æ ¼ä¸­<code>not_assigned</code>çš„å±æ€§ï¼Œä¿å­˜ä¸€ä»½æ–¹æ³•æ‰§è¡Œå‰çš„æ·±æ‹·è´ï¼Œä¿è¯å„ä¸ªå±æ€§æœªå‘ç”Ÿå˜åŒ–ã€‚é€è¡Œæ£€æŸ¥<code>requires</code>å’Œ<code>ensures</code>ã€‚</p><h2 id="å¿ƒå¾—ä½“ä¼š"><a href="#å¿ƒå¾—ä½“ä¼š" class="headerlink" title="å¿ƒå¾—ä½“ä¼š"></a>å¿ƒå¾—ä½“ä¼š</h2><p>æœ¬å•å…ƒçš„å­¦ä¹ ï¼Œç¬”è€…å¤§è‡´å­¦ä¹ åˆ°è§„æ ¼åŒ–è®¾è®¡çš„æ­¥éª¤ï¼Œä½“ä¼šåˆ°è§„æ ¼åŒ–è®¾è®¡çš„ä¼˜ç‚¹ã€‚æœ¬å•å…ƒå¯¹äºJunitçš„å­¦ä¹ ï¼Œè®©æˆ‘ç†è§£äº†Junitçš„ä½¿ç”¨æ–¹æ³•ä¸å…¶å­˜åœ¨çš„æ„ä¹‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OO_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_Lab4_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/05/09/OS-Lab4/BUAA_OS_Lab4%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/05/09/OS-Lab4/BUAA_OS_Lab4%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="BUAA-OS-Lab4-å®éªŒæŠ¥å‘Š"><a href="#BUAA-OS-Lab4-å®éªŒæŠ¥å‘Š" class="headerlink" title="BUAA_OS_Lab4_å®éªŒæŠ¥å‘Š"></a>BUAA_OS_Lab4_å®éªŒæŠ¥å‘Š</h1><h2 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h2><h3 id="Thinking-4-1"><a href="#Thinking-4-1" class="headerlink" title="Thinking 4.1"></a>Thinking 4.1</h3><blockquote><p>æ€è€ƒå¹¶å›ç­”ä¸‹é¢çš„é—®é¢˜ï¼š</p><ul><li>å†…æ ¸åœ¨ä¿å­˜ç°åœºçš„æ—¶å€™æ˜¯å¦‚ä½•é¿å…ç ´åé€šç”¨å¯„å­˜å™¨çš„ï¼Ÿ</li><li>ç³»ç»Ÿé™·å…¥å†…æ ¸è°ƒç”¨åå¯ä»¥ç›´æ¥ä»å½“æ—¶çš„ $a0-$a3 å‚æ•°å¯„å­˜å™¨ä¸­å¾—åˆ°ç”¨æˆ·è°ƒç”¨ <code>msyscall</code>ç•™ä¸‹çš„ä¿¡æ¯å—ï¼Ÿ</li><li>æˆ‘ä»¬æ˜¯æ€ä¹ˆåšåˆ°è®© sys å¼€å¤´çš„å‡½æ•°â€œè®¤ä¸ºâ€æˆ‘ä»¬æä¾›äº†å’Œç”¨æˆ·è°ƒç”¨ <code>msyscall</code> æ—¶åŒæ ·çš„å‚æ•°çš„ï¼Ÿ</li><li>å†…æ ¸å¤„ç†ç³»ç»Ÿè°ƒç”¨çš„è¿‡ç¨‹å¯¹ <code>Trapframe</code> åšäº†å“ªäº›æ›´æ”¹ï¼Ÿè¿™ç§ä¿®æ”¹å¯¹åº”çš„ç”¨æˆ·æ€çš„å˜åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ</li></ul></blockquote><ul><li>å†…æ ¸åœ¨ä¿æŠ¤ç°åœºçš„æ—¶å€™ä¼šè°ƒç”¨<code>SAVE_ALL</code>å®ï¼ŒæŠŠé€šç”¨å¯„å­˜å™¨çš„<code>sp</code>å¤åˆ¶åˆ°<code>$k0</code>ä¸­ã€‚ä¿å­˜ç°åœºéœ€è¦ä½¿ç”¨<code>$v0</code>ä½œä¸ºåå¯„å­˜å™¨åˆ°å†…å­˜çš„ä¸­è½¬å¯„å­˜å™¨ï¼Œå†™åˆ°å†…å­˜æ—¶éœ€è¦<code>sp</code>ï¼Œæ‰€ä»¥åœ¨æ­£å¼ä¿å­˜åå¯„å­˜å™¨å’Œé€šç”¨å¯„å­˜å™¨å‰å…ˆä¿å­˜è¿™ä¸¤ä¸ªå¯„å­˜å™¨ã€‚</li><li>å¯ä»¥çš„ã€‚å› ä¸ºå†…æ ¸åœ¨é™·å…¥å†…æ ¸ã€ä¿å­˜ç°åœºçš„è¿‡ç¨‹ä¸­ï¼Œå¯„å­˜å™¨ a0-a3 ä¸­çš„å€¼éƒ½æ²¡æœ‰è¢«ç ´åã€‚ç”¨æˆ·åœ¨è°ƒç”¨ msyscall æ—¶ï¼Œä¼ å…¥çš„å‚æ•°ä¼šè¢«ä¿å­˜åœ¨ a0-a3 å¯„å­˜å™¨å’Œå †æ ˆä¸­ã€‚å½“é™·å…¥å†…æ ¸æ—¶ï¼Œa0-a3 å¯„å­˜å™¨ä¸ä¼šè¢«ç ´åï¼Œå¹¶ä¸”ä¼šå°†ç”¨æˆ·æ ˆä¸­çš„ç›¸åº”å‚æ•°å¤åˆ¶å–å‡ºåˆ°å†…æ ¸æ ˆä¸­ã€‚å› æ­¤ï¼Œ<code>sys_*</code> å‡½æ•°å¯ä»¥ä»å¯„å­˜å™¨å’Œç”¨æˆ·æ ˆå¤„è·å¾—ç”¨æˆ·è°ƒç”¨ msyscall æ—¶ä¼ å…¥çš„å‚æ•°å€¼ã€‚</li><li>æ›´æ”¹äº† epc çš„å€¼ï¼ˆ+4ï¼‰ï¼Œä½¿å¾—è¿”å›ç”¨æˆ·æ€åèƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ï¼›è¿”å›å€¼ä¼šè¢«å­˜å‚¨åˆ° v0 å¯„å­˜å™¨å†…ï¼Œä½¿å¾—è¿”å›ç”¨æˆ·æ€åå¯ä»¥è·å–è°ƒç”¨åçš„è¿”å›å€¼ã€‚</li></ul><h3 id="Thinking-4-2"><a href="#Thinking-4-2" class="headerlink" title="Thinking 4.2"></a>Thinking 4.2</h3><blockquote><p>æ€è€ƒ <code>envid2env</code> å‡½æ•°: ä¸ºä»€ä¹ˆ <code>envid2env</code> ä¸­éœ€è¦åˆ¤æ–­ <code>e-&gt;env_id != envid</code> çš„æƒ…å†µï¼Ÿå¦‚æœæ²¡æœ‰è¿™æ­¥åˆ¤æ–­ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p></blockquote><p>æˆ‘ä»¬åœ¨è¯•å›¾é€šè¿‡ <code>envid</code> æ¥è·å–å¯¹åº”çš„è¿›ç¨‹æ§åˆ¶å—æ—¶ï¼Œåªå–äº† <code>envid</code> çš„å 10 ä½æ¥ä½œä¸ºæ•°ç»„ä¸‹æ ‡ã€‚ä½†è¦ç¡®ä¿ <code>envid</code> å’Œå–å‡ºçš„è¿›ç¨‹å—<strong>å®Œå…¨å¯¹åº”</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»…ä»…çœ‹å 10 ä½æ˜¯ä¸å¤Ÿçš„ã€‚ç”¨ <code>e-&gt;env_id != envid</code> è¿™ä¸€æ­¥æ¥ç¡®å®šä¼ å…¥çš„ <code>envid</code> ç¡®å®å’Œå–å‡ºçš„è¿›ç¨‹å—æ˜¯å¯¹åº”çš„ã€‚å¦‚æœä¸åˆ¤æ–­envidæ˜¯å¦ç›¸åŒï¼Œä¼šå–åˆ°é”™è¯¯çš„æˆ–è€…æœ¬è¯¥è¢«é”€æ¯çš„è¿›ç¨‹æ§åˆ¶å—ã€‚</p><h3 id="Thinking-4-3"><a href="#Thinking-4-3" class="headerlink" title="Thinking 4.3"></a>Thinking 4.3</h3><blockquote><p>æ€è€ƒä¸‹é¢çš„é—®é¢˜ï¼Œå¹¶å¯¹è¿™ä¸ªé—®é¢˜è°ˆè°ˆä½ çš„ç†è§£ï¼šè¯·å›é¡¾ <em>kern&#x2F;env.c</em> æ–‡ä»¶ä¸­ <code>mkenvid()</code> å‡½æ•°çš„å®ç°ï¼Œè¯¥å‡½æ•°ä¸ä¼šè¿”å› <code>0</code>ï¼Œè¯·ç»“åˆç³»ç»Ÿè°ƒç”¨å’Œ <em>IPC</em> éƒ¨åˆ†çš„å®ç°ä¸<code>envid2env()</code> å‡½æ•°çš„è¡Œä¸ºè¿›è¡Œè§£é‡Šã€‚</p></blockquote><p>åœ¨ç³»ç»Ÿè°ƒç”¨å’Œ ipc é€šè®¯çš„ç›¸å…³å‡½æ•°é‡Œï¼Œæˆ‘ä»¬å¦‚æœä¼ å…¥çš„ <code>envid</code> ä¸º 0ï¼Œé‚£ä¹ˆä»£è¡¨ç›¸åº”çš„è¿›ç¨‹ä¸º <strong>å½“å‰è¿›ç¨‹</strong>ã€‚å› æ­¤ï¼Œéœ€è¦ä¿è¯æ¯ä¸€ä¸ªè¿›ç¨‹å—çš„ <code>envid</code> ä¸ä¸º 0ï¼Œæ‰èƒ½è®©è¿™ä¸ªæ ‡å‡†æ­£ç¡®å®ç°ã€‚</p><h3 id="Thinking-4-4"><a href="#Thinking-4-4" class="headerlink" title="Thinking 4.4"></a>Thinking 4.4</h3><blockquote><p>å…³äº <code>fork</code> å‡½æ•°çš„ä¸¤ä¸ªè¿”å›å€¼ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼š<br>Aã€ <code>fork</code> åœ¨çˆ¶è¿›ç¨‹ä¸­è¢«è°ƒç”¨ä¸¤æ¬¡ï¼Œäº§ç”Ÿä¸¤ä¸ªè¿”å›å€¼<br>Bã€ <code>fork</code> åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¸­åˆ†åˆ«è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œäº§ç”Ÿä¸¤ä¸ªä¸åŒçš„è¿”å›å€¼<br>Cã€ <code>fork</code> åªåœ¨çˆ¶è¿›ç¨‹ä¸­è¢«è°ƒç”¨äº†ä¸€æ¬¡ï¼Œåœ¨ä¸¤ä¸ªè¿›ç¨‹ä¸­å„äº§ç”Ÿä¸€ä¸ªè¿”å›å€¼<br>Dã€ <code>fork</code> åªåœ¨å­è¿›ç¨‹ä¸­è¢«è°ƒç”¨äº†ä¸€æ¬¡ï¼Œåœ¨ä¸¤ä¸ªè¿›ç¨‹ä¸­å„äº§ç”Ÿä¸€ä¸ªè¿”å›å€¼</p></blockquote><p>C</p><h3 id="Thinking-4-5"><a href="#Thinking-4-5" class="headerlink" title="Thinking 4.5"></a>Thinking 4.5</h3><blockquote><p>æˆ‘ä»¬å¹¶ä¸åº”è¯¥å¯¹æ‰€æœ‰çš„ç”¨æˆ·ç©ºé—´é¡µéƒ½ä½¿ç”¨ <code>duppage</code> è¿›è¡Œæ˜ å°„ã€‚é‚£ä¹ˆç©¶ç«Ÿå“ªäº›ç”¨æˆ·ç©ºé—´é¡µåº”è¯¥æ˜ å°„ï¼Œå“ªäº›ä¸åº”è¯¥å‘¢ï¼Ÿè¯·ç»“åˆ <em>kern&#x2F;env.c</em> ä¸­ <code>env_init</code> å‡½æ•°è¿›è¡Œçš„é¡µé¢æ˜ å°„ã€ <em>include&#x2F;mmu.h</em> é‡Œçš„å†…å­˜å¸ƒå±€å›¾ä»¥åŠæœ¬ç« çš„åç»­æè¿°è¿›è¡Œæ€è€ƒã€‚</p></blockquote><ul><li>åœ¨ 0 - <code>USTACKTOP</code> èŒƒå›´çš„å†…å­˜éœ€è¦ä½¿ç”¨ <code>duppage</code> è¿›è¡Œæ˜ å°„;</li><li><code>USTACKTOP</code> åˆ° <code>UTOP</code> ä¹‹é—´çš„ <strong>user exception stack</strong> æ˜¯ç”¨æ¥è¿›è¡Œé¡µå†™å…¥å¼‚å¸¸çš„ï¼Œä¸ä¼šåœ¨å¤„ç†COWå¼‚å¸¸æ—¶è°ƒç”¨ <code>fork()</code> ,æ‰€ä»¥ <code>user exception stack</code> è¿™ä¸€é¡µä¸éœ€è¦å…±äº«ï¼›</li><li><code>UTOP</code>ä»¥ä¸Šé¡µé¢çš„<strong>å†…å­˜ä¸é¡µè¡¨</strong>æ˜¯æ‰€æœ‰è¿›ç¨‹å…±äº«çš„ï¼Œä¸”ç”¨æˆ·è¿›ç¨‹æ— æƒé™è®¿é—®ï¼Œä¸éœ€è¦åšçˆ¶å­è¿›ç¨‹é—´çš„<code>duppage</code>ï¼›</li><li>å…¶ä¸ŠèŒƒå›´çš„å†…å­˜è¦ä¹ˆ<strong>å±äºå†…æ ¸</strong>ï¼Œè¦ä¹ˆæ˜¯æ‰€æœ‰ç”¨æˆ·è¿›ç¨‹<strong>å…±äº«çš„ç©ºé—´</strong>ï¼Œç”¨æˆ·æ¨¡å¼ä¸‹åªå¯ä»¥è¯»å–ã€‚é™¤åªè¯»ã€å…±äº«çš„é¡µé¢å¤–éƒ½éœ€è¦è®¾ç½® <code>PTE_COW</code> è¿›è¡Œä¿æŠ¤ã€‚</li></ul><h3 id="Thinking-4-6"><a href="#Thinking-4-6" class="headerlink" title="Thinking 4.6"></a>Thinking 4.6</h3><blockquote><p>åœ¨éå†åœ°å€ç©ºé—´å­˜å–é¡µè¡¨é¡¹æ—¶ä½ éœ€è¦ä½¿ç”¨åˆ° <code>vpd</code> å’Œ <code>vpt</code> è¿™ä¸¤ä¸ªæŒ‡é’ˆï¼Œè¯·å‚è€ƒ <em>user&#x2F;include&#x2F;lib.h</em> ä¸­çš„ç›¸å…³å®šä¹‰ï¼Œæ€è€ƒå¹¶å›ç­”è¿™å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>vpt å’Œ vpd çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ€æ ·ä½¿ç”¨å®ƒä»¬ï¼Ÿ</li><li>ä»å®ç°çš„è§’åº¦è°ˆä¸€ä¸‹ä¸ºä»€ä¹ˆè¿›ç¨‹èƒ½å¤Ÿé€šè¿‡è¿™ç§æ–¹å¼æ¥å­˜å–è‡ªèº«çš„é¡µè¡¨ï¼Ÿ</li><li>å®ƒä»¬æ˜¯å¦‚ä½•ä½“ç°è‡ªæ˜ å°„è®¾è®¡çš„ï¼Ÿ</li><li>è¿›ç¨‹èƒ½å¤Ÿé€šè¿‡è¿™ç§æ–¹å¼æ¥ä¿®æ”¹è‡ªå·±çš„é¡µè¡¨é¡¹å—ï¼Ÿ</li></ul></blockquote><ol><li><code>vpt</code> å’Œ <code>vpd</code> åˆ†åˆ«æ˜¯æŒ‡å‘ç”¨æˆ·é¡µè¡¨å’Œç”¨æˆ·é¡µç›®å½•çš„æŒ‡é’ˆã€‚å®ƒä»¬ç”¨äºè®¿é—®å’Œéå†è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­çš„é¡µè¡¨é¡¹ã€‚ä»¥ <code>vpt</code> ä¸ºä¾‹ï¼Œè¦è·å–å½“å‰è™šæ‹Ÿåœ°å€ <code>va</code> æ‰€å¯¹åº”çš„é¡µè¡¨é¡¹ï¼Œå¯ä»¥ä½¿ç”¨ <code>vpt[VPN(va)]</code>ï¼Œä½¿ç”¨å® <code>VPN(va)</code> è·å–è™šæ‹Ÿåœ°å€ <code>va</code> å¯¹åº”çš„é¡µé¢çš„ç¼–å·ï¼Œå³ç›¸å¯¹ <code>(*vpt)</code> çš„åç§»é‡ï¼Œé€šè¿‡è¿™ä¸ªåç§»é‡å°±å¯ä»¥å¾—åˆ°å¯¹åº”çš„é¡µè¡¨é¡¹ã€‚</li><li>å­˜å‚¨é¡µè¡¨çš„ç©ºé—´å±äºç”¨æˆ·ç©ºé—´ï¼Œå› æ­¤ç”¨æˆ·è¿›ç¨‹å¯ä»¥é€šè¿‡æŒ‡é’ˆå–å¾—é¡µè¡¨çš„åœ°å€æ¥è¿›è¡Œè®¿é—®ã€‚ç³»ç»Ÿæ˜¯çº¿æ€§åœ°è¿›è¡Œé¡µé¢çš„æ˜ å°„ï¼Œå› æ­¤å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°â€œè™šæ‹Ÿåœ°å€-&gt;è™šæ‹Ÿé¡µå·â€çš„è½¬å˜ã€‚è™šæ‹Ÿé¡µå·å³è™šæ‹Ÿåœ°å€å¯¹åº”çš„è™šæ‹Ÿé¡µé¢ç›¸å¯¹é¡µè¡¨é¡¹çš„åç§»é‡ï¼Œè·å¾—äº†é¡µè¡¨é¦–åœ°å€å’Œåç§»é‡åï¼Œå°±å¯ä»¥è·å–å¯¹åº”çš„é¡µè¡¨é¡¹ã€‚</li><li><code>vpd</code> çš„å€¼ä¸º <code>(UVPT + (PDX(UVPT) &lt;&lt; PGSHIFT))</code>ï¼Œåœ¨<code>UVPT</code>å’Œ<code>UVPT + PDMAP</code>ä¹‹é—´ï¼Œè¯´æ˜å°†é¡µç›®å½•æ˜ å°„åˆ°äº†æŸä¸€é¡µè¡¨ä½ç½®ï¼›é€šè¿‡ <code>vpt</code> æ¥æ‰¾ <code>vpd</code>ï¼Œè¿™è¡¨æ˜é¡µè¡¨ <code>vpt</code> ä¸­å­˜åœ¨æŸä¸€é¡µä¸ºé¡µç›®å½•ï¼Œç”±æ­¤ä½“ç°äº†è‡ªæ˜ å°„è®¾è®¡ã€‚</li><li>ä¸èƒ½ï¼Œè¯¥åŒºåŸŸå¯¹ç”¨æˆ·<strong>åªè¯»ä¸å†™</strong>ï¼Œç”¨æˆ·è¿›ç¨‹åªèƒ½è¯»å–é¡µè¡¨é¡¹ï¼Œä¸èƒ½è¿›è¡Œä¿®æ”¹ã€‚æƒ³è¦ä¿®æ”¹éœ€è¦é™·å…¥å†…æ ¸</li></ol><h3 id="Thinking-4-7"><a href="#Thinking-4-7" class="headerlink" title="Thinking 4.7"></a>Thinking 4.7</h3><blockquote><p>åœ¨ <code>do_tlb_mod</code> å‡½æ•°ä¸­ï¼Œä½ å¯èƒ½æ³¨æ„åˆ°äº†ä¸€ä¸ªå‘å¼‚å¸¸å¤„ç†æ ˆå¤åˆ¶ <code>Trapframe</code>è¿è¡Œç°åœºçš„è¿‡ç¨‹ï¼Œè¯·æ€è€ƒå¹¶å›ç­”è¿™å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>è¿™é‡Œå®ç°äº†ä¸€ä¸ªæ”¯æŒç±»ä¼¼äºâ€œå¼‚å¸¸é‡å…¥â€çš„æœºåˆ¶ï¼Œè€Œåœ¨ä»€ä¹ˆæ—¶å€™ä¼šå‡ºç°è¿™ç§â€œå¼‚å¸¸é‡å…¥â€ï¼Ÿ</li><li>å†…æ ¸ä¸ºä»€ä¹ˆéœ€è¦å°†å¼‚å¸¸çš„ç°åœº Trapframe å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ï¼Ÿ</li></ul></blockquote><p>å‡ºç° COW å¼‚å¸¸æ—¶ï¼Œä¹Ÿå³è¿›ç¨‹å°è¯•å†™ COW é¡µé¢æ—¶ï¼Œä¼šå‡ºç°è¿™æ ·çš„å¼‚å¸¸é‡å…¥ã€‚</p><p>å¼‚å¸¸å¤„ç†å®Œæ¯•ä¹‹åï¼Œæ¢å¤ç°åœºçš„å·¥ä½œä¼šåœ¨ç”¨æˆ·æ€è¿›è¡Œï¼Œå› æ­¤éœ€è¦æŠŠ tf ä¿å­˜åœ¨ç”¨æˆ·æ€çš„æ ˆç©ºé—´ä¸‹ã€‚</p><h3 id="Thinking-4-8"><a href="#Thinking-4-8" class="headerlink" title="Thinking 4.8"></a>Thinking 4.8</h3><blockquote><p>åœ¨ç”¨æˆ·æ€å¤„ç†é¡µå†™å…¥å¼‚å¸¸ï¼Œç›¸æ¯”äºåœ¨å†…æ ¸æ€å¤„ç†æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</p></blockquote><ul><li>è§£æ”¾å†…æ ¸ï¼Œä¸ç”¨å†…æ ¸æ‰§è¡Œå¤§é‡çš„é¡µé¢æ‹·è´å·¥ä½œï¼›</li><li>å¯ä»¥å‡å°‘å†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´çš„åˆ‡æ¢æ¬¡æ•°ï¼Œä»è€Œæé«˜å¼‚å¸¸å¤„ç†çš„æ•ˆç‡ï¼›</li><li>å†…æ ¸æ€å¤„ç†å¤±è¯¯äº§ç”Ÿçš„å½±å“è¾ƒå¤§ï¼Œå¯èƒ½ä¼šä½¿å¾—æ“ä½œç³»ç»Ÿå´©æºƒï¼›</li><li>ç”¨æˆ·çŠ¶æ€ä¸‹ä¸èƒ½å¾—åˆ°ä¸€äº›åœ¨å†…æ ¸çŠ¶æ€æ‰æœ‰çš„æƒé™ï¼Œé¿å…æ”¹å˜ä¸å¿…è¦çš„å†…å­˜ç©ºé—´ã€‚</li></ul><h3 id="Thinking-4-9"><a href="#Thinking-4-9" class="headerlink" title="Thinking 4.9"></a>Thinking 4.9</h3><blockquote><p>è¯·æ€è€ƒå¹¶å›ç­”ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>ä¸ºä»€ä¹ˆéœ€è¦å°† <code>syscall_set_tlb_mod_entry</code> çš„è°ƒç”¨æ”¾ç½®åœ¨ <code>syscall_exofork</code> ä¹‹å‰ï¼Ÿ</li><li>å¦‚æœæ”¾ç½®åœ¨å†™æ—¶å¤åˆ¶ä¿æŠ¤æœºåˆ¶å®Œæˆä¹‹åä¼šæœ‰æ€æ ·çš„æ•ˆæœï¼Ÿ</li></ul></blockquote><p>ç¡®ä¿åœ¨å­è¿›ç¨‹åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œé¡µè¡¨é¡¹çš„ä¿®æ”¹èƒ½å¤Ÿè¢«æ­£ç¡®åœ°åŠ è½½åˆ° TLB ä¸­ã€‚å¦‚æœä¸è¿™æ ·åšï¼Œå¯èƒ½ä¼šå¯¼è‡´åœ¨å­è¿›ç¨‹åˆ›å»ºè¿‡ç¨‹ä¸­éœ€è¦è®¿é—®çš„é¡µè¡¨é¡¹å°šæœªè¢«åŠ è½½åˆ° TLB ä¸­ï¼Œä»è€Œå½±å“å­è¿›ç¨‹çš„æ­£å¸¸åˆ›å»ºå’Œè¿è¡Œã€‚</p><h2 id="å®éªŒéš¾ç‚¹åˆ†æ"><a href="#å®éªŒéš¾ç‚¹åˆ†æ" class="headerlink" title="å®éªŒéš¾ç‚¹åˆ†æ"></a>å®éªŒéš¾ç‚¹åˆ†æ</h2><p>lab4 çš„ä¸»è¦å†…å®¹ä¸»è¦åŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨ã€è¿›ç¨‹é€šä¿¡æœºåˆ¶ï¼ˆipcï¼‰ä»¥åŠ fork æ“ä½œã€‚æˆ‘è§‰å¾—å®éªŒçš„éš¾ç‚¹åœ¨äºå¯¹ç³»ç»Ÿè°ƒç”¨æµç¨‹çš„ç†è§£å’Œå®ç°ã€‚åœ¨åšå®éªŒçš„æ—¶å€™å¾ˆå®¹æ˜“å¿˜è®°è‡ªå·±æ˜¯åŸºäºå†…æ ¸è¿˜æ˜¯åŸºäºç”¨æˆ·ã€‚</p><p>è€Œ<code>fork</code>æ“ä½œçš„éš¾ç‚¹åœ¨äºç†è§£å­è¿›ç¨‹å¦‚ä½•ç»§æ‰¿çˆ¶è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ï¼Œå³ï¼Œä»€ä¹ˆæ ·çš„é¡µé¢éœ€è¦è¢«èµ‹äºˆ COW å±æ€§ã€‚</p><h2 id="å®éªŒä½“ä¼š"><a href="#å®éªŒä½“ä¼š" class="headerlink" title="å®éªŒä½“ä¼š"></a>å®éªŒä½“ä¼š</h2><p>lab4çš„ä¸Šæœºè¿˜æ˜¯æ¯”è¾ƒè½»æ¾çš„ã€‚examå¤§æ¦‚ç”¨äº†20åˆ†é’Ÿå°±å†™å®Œäº†ï¼Œä¸»è¦å°±æ˜¯è¦ç†è§£ç”¨æˆ·æ€å’Œå†…æ ¸æ€å‡½æ•°è°ƒç”¨çš„å±‚æ¬¡é€»è¾‘ã€‚extraæœ‰ç‚¹éš¾åº¦ï¼Œæœ€ååªæ‹¿äº†50åˆ†ã€‚æ•´ä½“æ„Ÿè§‰ä¸‹æ¥è¿˜æ˜¯å¯¹Cè¯­è¨€ä¸å¤Ÿç†Ÿæ‚‰ï¼Œæœ‰å¾ˆå¤šä»£ç é€»è¾‘ä¸æ˜¯å¾ˆæ¸…æ™°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_Lab3_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/04/25/OS-Lab3/BUAA-OS-Lab3%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/04/25/OS-Lab3/BUAA-OS-Lab3%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="BUAA-OS-Lab3-å®éªŒæŠ¥å‘Š"><a href="#BUAA-OS-Lab3-å®éªŒæŠ¥å‘Š" class="headerlink" title="BUAA_OS_Lab3_å®éªŒæŠ¥å‘Š"></a>BUAA_OS_Lab3_å®éªŒæŠ¥å‘Š</h1><h2 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h2><h3 id="Thinking-3-1"><a href="#Thinking-3-1" class="headerlink" title="Thinking 3.1"></a>Thinking 3.1</h3><blockquote><p>è¯·ç»“åˆ MOS ä¸­çš„é¡µç›®å½•è‡ªæ˜ å°„åº”ç”¨è§£é‡Šä»£ç ä¸­ <code>e-&gt;env_pgdir[PDX(UVPT)] = PADDR(e-&gt;env_pgdir) | PTE_V</code> çš„å«ä¹‰ã€‚</p></blockquote><ul><li><code>e-&gt;env_pgdir</code> ä»£è¡¨å½“å‰è¿›ç¨‹çš„é¡µç›®å½•çš„åŸºåœ°å€ã€‚åœ¨ MOS ä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„é¡µç›®å½•ï¼Œç”¨äºå­˜å‚¨è¯¥è¿›ç¨‹çš„é¡µè¡¨ä¿¡æ¯ã€‚</li><li><code>PADDR(e-&gt;env_pgdir)</code> ä»£è¡¨è¿™ä¸ªå‡½æ•°è·å–é¡µç›®å½•çš„ç‰©ç†åœ°å€ã€‚<code>PADDR</code>æ˜¯ä¸€ä¸ªå®ï¼Œç”¨äºå°†å†…æ ¸è™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚</li><li><code>PTE_V</code> ï¼šè¿™æ˜¯ä¸€ä¸ªæ ‡å¿—ä½ï¼Œè¡¨ç¤ºé¡µè¡¨é¡¹æœ‰æ•ˆã€‚<code>PADDR(e-&gt;env_pgdir) | PTE_V</code>ï¼Œè¡¨ç¤ºç»™é¡µç›®å½•çš„ç‰©ç†åŸºåœ°å€åŠ ä¸Šæƒé™ä½ã€‚</li><li><code>PDX(UVPT)</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå®ï¼Œç”¨äºè·å–è™šæ‹Ÿåœ°å€ <code>UVPT</code> çš„é¡µç›®å½•ç´¢å¼•ã€‚</li></ul><p>æ‰€ä»¥ï¼Œè¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å°†å½“å‰è¿›ç¨‹çš„é¡µç›®å½•çš„ç‰©ç†åœ°å€æ˜ å°„åˆ°ç”¨æˆ·è™šæ‹Ÿåœ°å€ç©ºé—´çš„<code>UVPT</code>åœ°å€å¤„ï¼Œå¹¶è®¾ç½®é¡µè¡¨é¡¹ä¸ºæœ‰æ•ˆã€‚è¿™æ ·ï¼Œè¿›ç¨‹å°±å¯ä»¥åœ¨è‡ªå·±çš„åœ°å€ç©ºé—´ä¸­è®¿é—®é¡µè¡¨å’Œé¡µç›®å½•ï¼Œæé«˜äº†è®¿é—®æ•ˆç‡ã€‚</p><h3 id="Thinking-3-2"><a href="#Thinking-3-2" class="headerlink" title="Thinking 3.2"></a>Thinking 3.2</h3><blockquote><p><code>elf_load_seg</code> ä»¥å‡½æ•°æŒ‡é’ˆçš„å½¢å¼ï¼Œæ¥å—å¤–éƒ¨è‡ªå®šä¹‰çš„å›è°ƒå‡½æ•° <code>map_page</code>ã€‚ è¯·ä½ æ‰¾åˆ°ä¸ä¹‹ç›¸å…³çš„ <code>data</code> è¿™ä¸€å‚æ•°åœ¨æ­¤å¤„çš„æ¥æºï¼Œå¹¶æ€è€ƒå®ƒçš„ä½œç”¨ã€‚æ²¡æœ‰è¿™ä¸ªå‚æ•°å¯ä¸å¯ä»¥ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>åœ¨ <code>elf_load_seg</code> å‡½æ•°ä¸­ï¼Œ<code>data</code> å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘ç”¨æˆ·è‡ªå®šä¹‰æ•°æ®çš„æŒ‡é’ˆï¼Œå®ƒå°†è¢«ä¼ é€’ç»™ <code>map_page</code> å›è°ƒå‡½æ•°ã€‚</p><p>åœ¨ <code>load_icode</code> å‡½æ•°ä¸­ï¼Œå½“è°ƒç”¨ <code>elf_load_seg</code> æ—¶ï¼Œ<code>data</code> å‚æ•°è¢«è®¾ç½®ä¸ºå½“å‰ç¯å¢ƒç»“æ„ <code>struct Env *e</code> çš„åœ°å€ã€‚è¿™æ ·ï¼Œåœ¨ <code>map_page</code> å›è°ƒå‡½æ•°ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>data</code> å‚æ•°è®¿é—®åˆ°å½“å‰ç¯å¢ƒçš„ä¿¡æ¯ï¼Œä¾‹å¦‚é¡µç›®å½• <code>env_pgdir</code> å’Œåœ°å€ç©ºé—´æ ‡è¯†ç¬¦ <code>env_asid</code>ï¼Œè¿™äº›ä¿¡æ¯å¯¹äºå°†é¡µé¢æ’å…¥åˆ°æ­£ç¡®çš„è¿›ç¨‹åœ°å€ç©ºé—´è‡³å…³é‡è¦ã€‚</p><p>å› æ­¤ï¼Œ<code>data</code> å‚æ•°æ˜¯å¿…éœ€çš„ï¼Œå®ƒä½¿å¾— <code>elf_load_seg</code> å’Œ <code>map_page</code> å‡½æ•°èƒ½å¤Ÿä¸è°ƒç”¨è€…ä¹‹é—´ä¼ é€’å¿…è¦çš„æ•°æ®ã€‚</p><h3 id="Thinking-3-3"><a href="#Thinking-3-3" class="headerlink" title="Thinking 3.3"></a>Thinking 3.3</h3><blockquote><p>ç»“åˆ elf_load_seg çš„å‚æ•°å’Œå®ç°ï¼Œè€ƒè™‘è¯¥å‡½æ•°éœ€è¦å¤„ç†å“ªäº›é¡µé¢åŠ è½½çš„æƒ…å†µã€‚</p></blockquote><ul><li>å¤„ç†ç¨‹åºæ®µçš„è™šæ‹Ÿåœ°å€ <code>p_vaddr</code> æ²¡æœ‰å¯¹é½åˆ°é¡µè¾¹ç•Œçš„æƒ…å†µï¼Œè®¡ç®—åç§»é‡å¹¶å®ç°å¯¹é½ã€‚</li><li>åœ¨ä»»ä½•è°ƒç”¨ <code>map_page</code> çš„åœ°æ–¹ï¼Œå¦‚æœ <code>map_page</code> è¿”å›éé›¶å€¼ï¼Œè¡¨ç¤ºæ˜ å°„å¤±è´¥ï¼Œ<code>elf_load_seg</code> å‡½æ•°éƒ½ä¼šç«‹å³è¿”å›è¿™ä¸ªé”™è¯¯å€¼ã€‚</li><li>å¦‚æœæ®µçš„å†…å­˜å¤§å° <code>p_memsz</code> å¤§äºæ–‡ä»¶çš„å°ºå¯¸ <code>p_filesz</code>ï¼Œè¯´æ˜æ®µåœ¨å†…å­˜ä¸­æ¯”åœ¨æ–‡ä»¶ä¸­å æ®æ›´å¤šçš„ç©ºé—´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦é¢å¤–åˆ†é…é¡µæ¥å¡«å……è¿™éƒ¨åˆ†ç©ºé—´ã€‚</li></ul><h3 id="Thinking-3-4"><a href="#Thinking-3-4" class="headerlink" title="Thinking 3.4"></a>Thinking 3.4</h3><blockquote><p>æ€è€ƒä¸Šé¢è¿™ä¸€æ®µè¯ï¼Œå¹¶æ ¹æ®è‡ªå·±åœ¨ Lab2 ä¸­çš„ç†è§£ï¼Œå›ç­”ï¼š</p><ul><li>ä½ è®¤ä¸ºè¿™é‡Œçš„ <code>env_tf.cp0_epc</code> å­˜å‚¨çš„æ˜¯ç‰©ç†åœ°å€è¿˜æ˜¯è™šæ‹Ÿåœ°å€?</li></ul></blockquote><p>è™šæ‹Ÿåœ°å€ã€‚<code>CP0</code>ä¸­å­˜å‚¨çš„<code>EPC</code>æ˜¯CPUäº§ç”Ÿå¼‚å¸¸çš„æŒ‡ä»¤åœ°å€ï¼Œå¯¹äºCPUæ¥è¯´ï¼Œå…¶æ‰€è§çš„éƒ½æ˜¯è™šæ‹Ÿåœ°å€ã€‚</p><h3 id="Thinking-3-5"><a href="#Thinking-3-5" class="headerlink" title="Thinking 3.5"></a>Thinking 3.5</h3><blockquote><p>è¯•æ‰¾å‡º 0ã€1ã€2ã€3 å·å¼‚å¸¸å¤„ç†å‡½æ•°çš„å…·ä½“å®ç°ä½ç½®ã€‚8 å·å¼‚å¸¸ï¼ˆç³»ç»Ÿè°ƒç”¨ï¼‰æ¶‰åŠçš„ <code>do_syscall()</code> å‡½æ•°å°†åœ¨ Lab4 ä¸­å®ç°ã€‚</p></blockquote><p><code>genex.S</code>æ–‡ä»¶ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">NESTED(handle_int, TF_SIZE, zero)</span><br><span class="line">mfc0    t0, CP0_CAUSE</span><br><span class="line">mfc0    t2, CP0_STATUS</span><br><span class="line">and     t0, t2</span><br><span class="line">andi    t1, t0, STATUS_IM7</span><br><span class="line">bnez    t1, timer_irq</span><br><span class="line">timer_irq:</span><br><span class="line">li      a0, 0</span><br><span class="line">j       schedule</span><br><span class="line">END(handle_int)</span><br><span class="line"></span><br><span class="line">BUILD_HANDLER tlb do_tlb_refill</span><br><span class="line"></span><br><span class="line">#if !defined(LAB) || LAB &gt;= 4</span><br><span class="line">BUILD_HANDLER mod do_tlb_mod</span><br><span class="line">BUILD_HANDLER sys do_syscall</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><h3 id="Thinking-3-6"><a href="#Thinking-3-6" class="headerlink" title="Thinking 3.6"></a>Thinking 3.6</h3><blockquote><p>é˜…è¯» <code>entry.S</code>ã€<code>genex.S</code> å’Œ <code>env_asm.S</code> è¿™å‡ ä¸ªæ–‡ä»¶ï¼Œå¹¶å°è¯•è¯´å‡ºæ—¶é’Ÿä¸­æ–­åœ¨å“ªäº›æ—¶å€™å¼€å¯ï¼Œåœ¨å“ªäº›æ—¶å€™å…³é—­ã€‚</p></blockquote><ol><li>å¼‚å¸¸å¤„ç†ã€‚å½“å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™ï¼Œä¼šé€šè¿‡<code>mfc0 t0, CP0_STATUS</code>å’Œ<code>mtc0 t0, CP0_STATUS</code>æŒ‡ä»¤æ¥ä¿®æ”¹<code>CP0_STATUS</code>æ¥å…³é—­ä¸­æ–­</li><li>ç³»ç»Ÿè°ƒç”¨</li><li>å½“å¼‚å¸¸å¤„ç†æˆ–ç³»ç»Ÿè°ƒç”¨å®Œæˆåï¼Œä¼šé€šè¿‡ <code>ret_from_exception</code> æ ‡ç­¾è¿”å›ã€‚åœ¨è¿™é‡Œï¼Œä¼šæ‰§è¡Œ <code>RESTORE_ALL</code> å’Œ <code>eret</code> æŒ‡ä»¤æ¥æ¢å¤å¯„å­˜å™¨çŠ¶æ€å¹¶è¿”å›åˆ°å‘ç”Ÿå¼‚å¸¸å‰çš„çŠ¶æ€ã€‚</li><li>è¿›ç¨‹åˆ‡æ¢ã€‚</li></ol><h3 id="Thinking-3-7"><a href="#Thinking-3-7" class="headerlink" title="Thinking 3.7"></a>Thinking 3.7</h3><ol><li>é€šè¿‡æ—¶é’Ÿä¸­æ–­æ¥è§¦å‘å¼‚å¸¸</li><li>å¼‚å¸¸å¤„ç†ç¨‹åºå…ˆç¡®å®šæ˜¯æ—¶é’Ÿä¸­æ–­ï¼Œå¹¶è°ƒç”¨è°ƒåº¦å‡½æ•°</li><li>è°ƒåº¦å‡½æ•°é€šè¿‡ä¸€å®šçš„è°ƒåº¦ç®—æ³•ï¼Œé€‰æ‹©ä¸€ä¸ªæ–°çš„è¿›ç¨‹å¼€å§‹æ‰§è¡Œ</li><li>æ“ä½œç³»ç»Ÿæ‰§è¡Œä¸Šä¸‹æ–‡çš„åˆ‡æ¢ï¼Œä¿å­˜å½“å‰è¿›ç¨‹ã€æ¢å¤æ–°è¿›ç¨‹çš„çŠ¶æ€</li><li>è¿”å›ï¼Œæ‰§è¡Œæ–°è¿›ç¨‹</li></ol><h2 id="éš¾ç‚¹åˆ†æ"><a href="#éš¾ç‚¹åˆ†æ" class="headerlink" title="éš¾ç‚¹åˆ†æ"></a>éš¾ç‚¹åˆ†æ</h2><p>æœ¬æ¬¡çš„è¯¾ä¸‹labè™½ç„¶å†…å®¹æœ‰ç‚¹å¤šä½†æ˜¯æ•´ä½“éš¾åº¦å…¶å®ä¸é«˜ï¼Œ<del>æ¯•ç«Ÿè·Ÿç€æ³¨é‡Šå†™å°±å®Œäº‹äº†</del>ï¼Œä½†æ˜¯æ¯”è¾ƒéš¾çš„æ˜¯æˆ‘ä»¬è¦å¯¹æ–°å¢çš„æ–‡ä»¶ä»¥åŠæˆ‘ä»¬åœ¨è¿™ä¸ªlabå¹²äº†ä»€ä¹ˆåšä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„æŠŠæ¡ã€‚</p><p>ç›¸æ¯”è¾ƒä¹‹å‰çš„labï¼Œè¿™æ¬¡çš„labæ¯”è¾ƒæ³¨é‡å’Œç†è®ºè¯¾çš„è”ç³»ï¼ŒæŠŠç†è®ºè¯¾ä¸Šè¿›ç¨‹è°ƒåº¦ä»”ç»†å­¦å¥½ï¼Œæ‰èƒ½å¥½å¥½å‚åŠ æœ¬æ¬¡çš„examã€‚å»ºè®®ä¸€å®šè¦é€šè¯»æ–°å¢æ–‡ä»¶çš„æ¯ä¸ªå‡½æ•°çš„<code>Overview</code>ï¼Œæ— è®ºæ˜¯å¦è¦æ±‚è‡ªå·±è¡¥å…¨çš„</p><h2 id="å®éªŒä½“ä¼š"><a href="#å®éªŒä½“ä¼š" class="headerlink" title="å®éªŒä½“ä¼š"></a>å®éªŒä½“ä¼š</h2><p>æœ¬æ¬¡è¯¾ä¸‹labèŠ±è´¹çš„æ—¶é—´ä¸å¤šï¼Œä»£ç å¡«ç©ºä¹Ÿæ²¡æœ‰å¾ˆå¤æ‚çš„å‡½æ•°è°ƒç”¨ï¼Œæ‰€ä»¥ä»…ä»…å®Œæˆè¯¾ä¸‹ä»»åŠ¡æ˜¯ä¸è¡Œçš„ï¼Œè¿œä¸è¶³ä»¥æ”¯æ’‘æˆ‘ä»¬å®Œæˆé™æ—¶æµ‹è¯•ã€‚</p><p>å¦å¤–ï¼Œæœ¬æ¬¡ä¸Šæœºå‡ºç°äº†ä¸€ä¸ªä»¤äººéš¾ç»·çš„bugï¼Œå¥½åœ¨20:55çš„æ—¶å€™éå¸¸æé™çš„æ‰¾åˆ°å¹¶æäº¤äº†ï¼Œä¸å¾—ä¸è¯´æŠ—å‹èƒ½åŠ›æ˜¯å¾ˆé‡è¦çš„~</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OO_Unit2_å•å…ƒæ€»ç»“</title>
      <link href="/2025/04/20/OO-Unit2%E6%80%BB%E7%BB%93/OO-Unit2%20%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6/"/>
      <url>/2025/04/20/OO-Unit2%E6%80%BB%E7%BB%93/OO-Unit2%20%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŒBUAA-OOã€ç¬¬äºŒå•å…ƒæ€»ç»“"><a href="#ã€ŒBUAA-OOã€ç¬¬äºŒå•å…ƒæ€»ç»“" class="headerlink" title="ã€ŒBUAA OOã€ç¬¬äºŒå•å…ƒæ€»ç»“"></a>ã€ŒBUAA OOã€ç¬¬äºŒå•å…ƒæ€»ç»“</h1><h2 id="hw5"><a href="#hw5" class="headerlink" title="hw5"></a>hw5</h2><h3 id="å†™åœ¨åŠ¨æ‰‹ä¹‹å‰"><a href="#å†™åœ¨åŠ¨æ‰‹ä¹‹å‰" class="headerlink" title="å†™åœ¨åŠ¨æ‰‹ä¹‹å‰"></a>å†™åœ¨åŠ¨æ‰‹ä¹‹å‰</h3><p>åœ¨å¼€å§‹æœ¬æ¬¡ä½œä¸šä¹‹å‰ï¼Œéœ€è¦æ˜ç¡®å‡ ä¸ªé—®é¢˜ï¼š</p><p><strong>1.éœ€è¦å“ªäº›çº¿ç¨‹</strong></p><p>é¦–å…ˆè‡ªç„¶æ˜¯6ä¸ªç”µæ¢¯6ä¸ªçº¿ç¨‹ï¼Œç„¶åä¾¿æ˜¯è¾“å…¥çº¿ç¨‹</p><p><strong>2.æœ‰å“ªäº›å…±äº«å¯¹è±¡</strong></p><p>å› ä¸ºä¹˜å®¢éƒ½å·²ç»åˆ†é…ç»™æŸä¸ªç”µæ¢¯äº†ï¼Œä¹˜å®¢è‡ªç„¶å°±ä¸èƒ½ç®—å…±äº«å¯¹è±¡ï¼Œå› ä¸ºä¹˜å®¢åªç‹¬å±äºæŸä¸ªç”µæ¢¯ï¼ˆçº¿ç¨‹ï¼‰ã€‚é‚£ä¹ˆè¿˜æœ‰ä»€ä¹ˆç®—å…±äº«å¯¹è±¡å‘¢ï¼Œç¬”è€…è§‰å¾—åº”è¯¥æ˜¯ä»»åŠ¡åˆ—è¡¨ç±»ã€‚è¾“å…¥çº¿ç¨‹æŠŠè¯»åˆ°çš„è¯·æ±‚å†™åˆ°ä»»åŠ¡åˆ—è¡¨é‡Œé¢ï¼Œ6ä¸ªç”µæ¢¯çº¿ç¨‹å¯¹ä»»åŠ¡åˆ—è¡¨è¿›è¡Œè¯»æ“ä½œï¼Œè·å–å±äºå„è‡ªçš„è¯·æ±‚ï¼Œå®Œæˆè¯·æ±‚åå†™å›ä»»åŠ¡åˆ—è¡¨ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ•´ä½“æ¡†æ¶å°±å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œåœ¨<code>MainClass</code>ç±»é‡Œé¢ï¼Œéœ€è¦æŠŠ6ä¸ªç”µæ¢¯çº¿ç¨‹<code>Elevator</code>ä¾æ¬¡å¯åŠ¨ï¼Œå†æŠŠè¾“å…¥çº¿ç¨‹<code>InputThread</code>å¯åŠ¨ï¼Œæ¯ä¸ªç”µæ¢¯çº¿ç¨‹æœ‰ä¸€ä¸ªè‡ªå·±çš„ä»»åŠ¡åˆ—è¡¨<code>QuestList</code>ï¼Œç„¶å<code>InputThread</code>å°±æ ¹æ®è¯·æ±‚çš„è¦æ±‚ï¼ˆç”µæ¢¯idï¼‰æ¥æŠŠè¯·æ±‚æ”¾åˆ°äººç‰©åˆ—è¡¨ä¸­ï¼Œç”±ç”µæ¢¯å»å®Œæˆ</p><h3 id="æ•´ä½“æ¶æ„"><a href="#æ•´ä½“æ¶æ„" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h3><p><img src="/img/OO-Unit2/ClassDiagram_fifth.png" alt="ç¬¬ä¸€æ¬¡ä½œä¸šç±»å›¾-ç”µæ¢¯ç³»ç»Ÿç±»å›¾"></p><p>ç¬¬ä¸€æ¬¡ä½œä¸šç±»å›¾å¦‚å›¾æ‰€ç¤ºï¼Œæ•´ä½“æŒ‰ç…§<em>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹</em>å»æ­å»ºçš„ï¼Œç¾ä¸­ä¸è¶³çš„ä¸€ç‚¹æ˜¯ç¬”è€…æ²¡æœ‰å†™åˆ†é…å™¨ç±»ï¼Œè¿™æ ·è¿™ä¸ªä½œä¸šçš„å¯è¿­ä»£æ€§å°±ä¸å¥½</p><h3 id="åŒæ­¥å—è®¾è®¡ä¸é”"><a href="#åŒæ­¥å—è®¾è®¡ä¸é”" class="headerlink" title="åŒæ­¥å—è®¾è®¡ä¸é”"></a>åŒæ­¥å—è®¾è®¡ä¸é”</h3><p>ç¬¬ä¸€æ¬¡ä½œä¸šç¬”è€…åªæ˜¯ç”¨äº†<code>synchronized</code>å…³é”®å­—ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨å…¶ä»–çš„é”ã€‚</p><p><img src="/img/OO-Unit2/synchronized.png" alt="ç¬¬ä¸€æ¬¡ä½œä¸šsynchronizedæ–¹æ³•"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œç¬”è€…åªåœ¨<code>QuestTable</code>é‡Œé¢ç”¨äº†<code>synchronized</code>æ–¹æ³•ï¼Œä½¿å¾—<code>InputThread</code>å’Œ<code>Elevator</code>çº¿ç¨‹å¯¹å…¶æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚javaç›®å‰çš„å®ç°ä¸­<code>synchronized</code>çš„æ•ˆç‡ä¹Ÿæ˜¯å¾ˆé«˜çš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•å¾ˆæ¸…æ™°ã€‚ä¸è¿‡è£è€å¸ˆä¸Šè¯¾è®²è¿‡ï¼Œæœ€å¥½åº”è¯¥æ˜¯ä½¿ç”¨<code>synchronzied</code>ä»£ç å—æ¥ä¸Šé”ï¼Œè¿™æ ·æ›´æ¸…æ™°ï¼Œå¯æ‹“å±•æ€§ä¹Ÿå¥½ï¼Œ<strong>ä¸è¦åœ¨æ–¹æ³•ä¸Šä¸Šé”</strong>ã€‚</p><h3 id="ç”µæ¢¯è°ƒåº¦"><a href="#ç”µæ¢¯è°ƒåº¦" class="headerlink" title="ç”µæ¢¯è°ƒåº¦"></a>ç”µæ¢¯è°ƒåº¦</h3><p>æœ¬æ¬¡ä½œä¸šç¬”è€…ä¸»è¦é‡‡ç”¨äº†LOOKç­–ç•¥ï¼Œé€»è¾‘å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="comment">/*ç”µæ¢¯å†…æœ‰äººè¦å‡ºç”µæ¢¯æˆ–è€…ç”µæ¢¯å¤–æœ‰äººè¦è¿›ç”µæ¢¯*/</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> Operation.OPEN; <span class="comment">// ç”µæ¢¯å¼€é—¨</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="comment">/*ç”µæ¢¯å†…æœ‰äºº*/</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> Operation.CONTINUE; <span class="comment">// ç”µæ¢¯æŒ‰å½“å‰æ–¹å‘ç»§ç»­è¿è¡Œ</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// ç”µæ¢¯å†…æ²¡äºº</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="comment">/*æ‰€æœ‰ç”µæ¢¯çš„ä»»åŠ¡è¡¨éƒ½ä¸ºç©º*/</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="comment">/*æ‰€æœ‰è¯·æ±‚éƒ½å·²å®Œæˆ*/</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> Operation.END; <span class="comment">// ç”µæ¢¯ç»ˆæ­¢è¿è¡Œ</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> Operation.WAIT; <span class="comment">// ç”µæ¢¯ç­‰å¾…</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="comment">/*å½“å‰æ–¹å‘ä¸Šè¿˜å­˜åœ¨è¯·æ±‚*/</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> Operation.CONTINUE; <span class="comment">// ç”µæ¢¯æŒ‰å½“å‰æ–¹å‘ç»§ç»­è¿è¡Œ</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> Operation.REVERSE; <span class="comment">// ç”µæ¢¯æ‰å¤´</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><code>Opreation</code>æ˜¯ä¸€ä¸ªæšä¸¾ç±»ï¼Œç”¨æ¥è§„å®šç”µæ¢¯çš„å„ç§åŠ¨ä½œã€‚</p><p>é¡ºå¸¦ä¸€æï¼Œç”Ÿæ´»ä¸­ç»å¤§å¤šæ•°çš„ç”µæ¢¯æ‰§è¡Œçš„éƒ½æ˜¯LOOKç­–ç•¥ã€‚</p><p>æ­¤å¤–ï¼Œç¬”è€…è¿˜å®ç°äº†ç”µæ¢¯<del>è¸¹äºº</del>çš„ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯åœ¨åŒæ–¹å‘ä¸Šï¼Œè‹¥æ˜¯ç”µæ¢¯å·²æ»¡ï¼Œä¸”é—¨å¤–æœ‰ä¼˜å…ˆçº§æ¯”ç”µæ¢¯å†…é«˜çš„è¯·æ±‚ï¼Œä¸¤è€…äº¤æ¢ä¸€ä¸‹ã€‚ç¬¬ä¸€æ¬¡ä½œä¸šæ²¡æœ‰<code>RECEIVE</code>çš„è¦æ±‚ï¼Œè¯¥æ–¹æ¡ˆå®ç°èµ·æ¥éå¸¸ç®€å•ã€‚</p><h3 id="ä»£ç é‡å’Œç±»å¤æ‚åº¦åˆ†æ"><a href="#ä»£ç é‡å’Œç±»å¤æ‚åº¦åˆ†æ" class="headerlink" title="ä»£ç é‡å’Œç±»å¤æ‚åº¦åˆ†æ"></a>ä»£ç é‡å’Œç±»å¤æ‚åº¦åˆ†æ</h3><p><img src="/img/OO-Unit2/Code_fifth.png" alt="ç¬¬ä¸€æ¬¡ä½œä¸šä»£ç é‡"></p><p>ç¬¬ä¸€æ¬¡ä½œä¸šçš„ä»£ç é‡æ•´ä½“æ¯”è¾ƒå°‘ï¼Œé›†ä¸­åœ¨<code>Elevator</code>ç±»å’Œ<code>QuestTable</code>ç±»ä¸­ã€‚</p><p><img src="/img/OO-Unit2/Magnanimity_fifth.png" alt="ç¬¬ä¸€æ¬¡ä½œä¸šOOåº¦é‡"></p><p><code>Elevator</code>ç±»ï¼Œ<code>QuestTable</code>ç±»å’Œ<code>Scheduler</code>ç±»çš„å¤æ‚åº¦éƒ½æ¯”è¾ƒé«˜ã€‚å…¶ä¸­<code>Elevator.run()</code>ä¸­æœ‰<code>while</code>å¾ªç¯å’Œå¤§é‡<code>if</code>æ¡ä»¶åˆ¤æ–­ï¼Œè€Œ<code>Shceduler</code>ç±»ä¸­çš„<code>existQuest</code>æ–¹æ³•å’Œ<code>nextOperation</code>æ–¹æ³•ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥å¤æ‚åº¦æ¯”è¾ƒé«˜ã€‚</p><h3 id="å€¼å¾—æ³¨æ„çš„bug"><a href="#å€¼å¾—æ³¨æ„çš„bug" class="headerlink" title="å€¼å¾—æ³¨æ„çš„bug"></a>å€¼å¾—æ³¨æ„çš„bug</h3><p>ç¬”è€…åœ¨å®ç°ç”µæ¢¯çš„è¿‡ç¨‹ä¸­æ²¡æœ‰ä»€ä¹ˆå°è±¡æ·±åˆ»çš„bugï¼Œä¸è¿‡åœ¨äº’æµ‹ä¸­æ‰¾åˆ°äº†åˆ«äººçš„bugã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå½“æˆ‘ä»¬å¯¹ä¸€ä¸ªå®¹å™¨è¿›è¡Œè¾¹éå†è¾¹ç§»é™¤çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿ<code>ConcurrentModificationException</code>ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿­ä»£å™¨æ¥éå†ã€‚ç„¶è€Œå½“<strong>ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹æŸä¸ªå®¹å™¨è¿›è¡Œæ“ä½œ</strong>çš„æ—¶å€™ï¼Œå³ä½¿ä½¿ç”¨äº†è¿­ä»£å™¨ï¼Œä¾ç„¶ä¼šæœ‰<code>CME</code>é”™è¯¯ã€‚å› æ­¤ï¼Œå¯¹å…±äº«ç±»è¿›è¡Œä¸¥æ ¼çš„çº¿ç¨‹å®‰å…¨ä¿è¯æ˜¯å¾ˆé‡è¦çš„ã€‚</p><h2 id="hw6"><a href="#hw6" class="headerlink" title="hw6"></a>hw6</h2><h3 id="æ•´ä½“æ¶æ„-1"><a href="#æ•´ä½“æ¶æ„-1" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h3><p><img src="/img/OO-Unit2/ClassDiagram_sixth.png" alt="ç¬¬å…­æ¬¡ä½œä¸šç±»å›¾"></p><p>ç±»å›¾å¦‚ä¸Šå›¾æ‰€ç¤º</p><p>è¿™ä¸€æ¬¡çš„ä½œä¸šæ•´ä½“è¦å¤æ‚ä¸€ç‚¹ï¼Œé¦–å…ˆä¸å†ä¸ºæ¯ä¸ªä¹˜å®¢è§„å®šç”µæ¢¯äº†ï¼Œå…¶æ¬¡å¯¹ç”µæ¢¯ä¹Ÿå¢åŠ äº†ä¸´æ—¶è°ƒåº¦è¯·æ±‚ï¼Œæ•´ä½“çš„å¤æ‚åº¦å¾ˆé«˜ï¼Œ<del>ç¬”è€…ä¹Ÿå‡ ä¹å†™äº†æ•´ä¸ªæ¸…æ˜èŠ‚å‡æœŸ</del></p><p>è¿™ä¸€æ¬¡åŠ å…¥äº†æ–°çš„çº¿ç¨‹<code>Manager</code>ï¼Œç”¨æ¥å°†æ¯ä¸ªè¯·æ±‚åˆ†é…ç»™ç”µæ¢¯ã€‚</p><h3 id="è°ƒåº¦ç®—æ³•"><a href="#è°ƒåº¦ç®—æ³•" class="headerlink" title="è°ƒåº¦ç®—æ³•"></a>è°ƒåº¦ç®—æ³•</h3><p>åœ¨æµè§ˆå¾€å±Šå­¦é•¿å­¦å§çš„å¸–å­çš„æ—¶å€™ï¼Œå¶ç„¶å‘ç°äº†è¿™ä¸ªå­¦é•¿çš„<a href="https://blog.csdn.net/weixin_73635758/article/details/137831524?spm=1001.2014.3001.5501">åšå®¢</a>ï¼Œå­¦åˆ°äº†ä¸€ä¸ªç»è¿‡åˆç†å»ºæ¨¡åçš„æ‰“åˆ†ç®—æ³•ï¼Œæ•´ä½“ä½“éªŒä¸‹æ¥æ•ˆæœå¾ˆå¥½ï¼Œä¸é€Šäºå½±å­ç”µæ¢¯ã€‚ä¸»è¦é€»è¾‘å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿”å›çš„åˆ†æ•°ä¸ºç”µæ¢¯ä»å½“å‰æ¥¼å±‚å‡ºå‘åˆ°æ¥åˆ°ä¹˜å®¢å…±è¿è¡Œçš„æ¥¼å±‚æ•°</span></span><br><span class="line"><span class="comment">//åœ¨QuestScheduleré‡Œå–åˆ†æ•°æœ€ä½çš„ç”µæ¢¯åˆ†é…è¯¥ä¹˜å®¢</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getScore</span><span class="params">(Quest quest)</span> &#123; </span><br><span class="line">    <span class="keyword">if</span> (<span class="comment">/*ä¹˜å®¢éœ€æ±‚æ–¹å‘ä¸ç”µæ¢¯è¿è¡Œæ–¹å‘ç›¸åŒ*/</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/*ç”µæ¢¯å†…äººæ•°+ä¸ç”µæ¢¯è¿è¡Œæ–¹å‘ç›¸åŒçš„å‰©ä½™ä»»åŠ¡æ•°&lt;ç”µæ¢¯å®¹é‡*/</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="comment">/*ç”µæ¢¯æ— éœ€æ‰å¤´å³å¯æ¥åˆ°ä¹˜å®¢*/</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="comment">/*ç”µæ¢¯å½“å‰æ¥¼å±‚ä¸ä¹˜å®¢å‡ºå‘æ¥¼å±‚ä¹‹å·®çš„ç»å¯¹å€¼*/</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">//éœ€è¦æ‰å¤´</span></span><br><span class="line">                <span class="keyword">return</span> <span class="comment">/*ç”µæ¢¯è¿è¡Œä¸€åœˆçš„æ¥¼å±‚æ•°-ç”µæ¢¯å½“å‰æ¥¼å±‚ä¸ä¹˜å®¢å‡ºå‘æ¥¼å±‚ä¹‹å·®çš„ç»å¯¹å€¼*/</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">//ç”µæ¢¯è¿™è¶Ÿæ¥ä¸åˆ°ä¹˜å®¢</span></span><br><span class="line">        <span class="keyword">return</span> <span class="comment">/*ç”µæ¢¯æ¥åˆ°ä¹˜å®¢éœ€è¦éå†çš„åœˆæ•°xç”µæ¢¯è¿è¡Œä¸€åœˆçš„æ¥¼å±‚æ•°-ç”µæ¢¯å½“å‰æ¥¼å±‚ä¸ä¹˜å®¢å‡ºå‘æ¥¼å±‚ä¹‹å·®çš„ç»å¯¹å€¼*/</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">//ä¹˜å®¢éœ€æ±‚æ–¹å‘ä¸ç”µæ¢¯è¿è¡Œæ–¹å‘ç›¸å</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡ç¬”è€…çš„ä¼˜åŒ–ï¼Œç¬”è€…å°†ç”µæ¢¯è¿è¡Œä¸€åœˆçš„æ¥¼å±‚æ•°åšäº†ä¸€ä¸ªæœŸæœ›è®¡ç®—ï¼Œæœ€åçš„ç»“æœçº¦ä¸º9-10ä¹‹é—´ï¼Œæœ€åé€‰æ‹©äº†9ã€‚ç¬¬å…­æ¬¡ä½œä¸šçš„å¼ºä¾§å¾—åˆ†ä¸º95.25åˆ†ï¼Œæ•´ä½“ç»“æœè¿˜ç®—æ»¡æ„ã€‚</p><p>é™¤æ­¤ä»¥å¤–ï¼Œæ•´ä½“çš„è°ƒåº¦ç®—æ³•æ²¡æœ‰æ”¹å˜ï¼Œä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç‚¹ï¼Œå°±æ˜¯æœ¬æ¬¡ä½œä¸šçš„<code>RECEIVE</code>è¦æ±‚ä½¿å¾—è¸¢äººçš„å®ç°å˜å¾—ç•¥æœ‰å¤æ‚ï¼Œå†ç»è¿‡é•¿æ—¶é—´çš„ä¼˜åŒ–è€Œ<del>ä¸€ç›´å‡ºbug</del>ä¹‹åï¼Œç¬”è€…<del>æœ‰ç‚¹è‡ªæš´è‡ªå¼ƒï¼Œå¹²è„†</del>æ”¾å¼ƒäº†æ­¤ç­–ç•¥</p><p>å¦å¤–æœ‰ä¸€ä¸ªè®©äººç¬‘è¯çš„ç‚¹ï¼Œå°±æ˜¯ç¬”è€…æ²¡æœ‰æƒ³åˆ°å¯ä»¥åœ¨æ¥æ”¶åˆ°<code>SCHE</code>æ—¶å°±æŠŠç”µæ¢¯å†…éƒ¨çš„ä¹˜å®¢æ”¾å‡ºï¼Œåè€Œæ˜¯è®©ä¹˜å®¢å…¨ç¨‹è·Ÿç€ç”µæ¢¯è·‘å»ä¸´æ—¶è°ƒåº¦çš„ç›®æ ‡æ¥¼å±‚ï¼Œæµªè´¹äº†ä¸€äº›æ€§èƒ½åˆ†ã€‚</p><h3 id="ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ"><a href="#ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ" class="headerlink" title="ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ"></a>ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ</h3><p><img src="/img/OO-Unit2/Code_sixth.png" alt="ç¬¬å…­æ¬¡ä½œä¸šä»£ç é‡"></p><p>å¯ä»¥çœ‹åˆ°æœ¬æ¬¡ä½œä¸šçš„ä»£ç é‡ä¸€ä¸‹å­å°±ä¸Šå»äº†ï¼Œæœ€å¤šçš„æ˜¯åœ¨<code>Elevator</code>ç±»é‡Œé¢ï¼Œå¯¹äºå®ç°<code>RECEIVE</code>å’Œ<code>SCHE</code>èŠ±è´¹äº†å¤§é‡çš„ç²¾åŠ›å’Œä»£ç ã€‚</p><p><img src="/img/OO-Unit2/Magnanimity_sixth.png" alt="ç¬¬å…­æ¬¡ä½œä¸šå¤æ‚åº¦"></p><p>é€šè¿‡å¤æ‚åº¦ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œ<code>Elevator</code>ç±»ç¡®å®å˜å¾—è¿‡äºå¤æ‚ï¼Œå…¶ä¸­ä¸»è¦æ˜¯æ‰“åˆ†ç®—æ³•æœ‰è¾ƒå¤šçš„æ¡ä»¶åˆ¤æ–­ç­‰ã€‚è€Œæ‰§è¡Œåˆ†é…è°ƒåº¦çš„<code>Manager</code>ç±»ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><h3 id="å€¼å¾—æ³¨æ„çš„bug-1"><a href="#å€¼å¾—æ³¨æ„çš„bug-1" class="headerlink" title="å€¼å¾—æ³¨æ„çš„bug"></a>å€¼å¾—æ³¨æ„çš„bug</h3><p>æœ¬æ¬¡ä¸»è¦çš„bugæœ‰ä¸€ä¸ªï¼Œåœ¨ä¸­æµ‹ç»“æŸå‰é€šè¿‡ç¬”è€…çš„è¯„æµ‹æœºå‘ç°äº†ã€‚æœ‰æ—¶å€™ï¼Œç”µæ¢¯å¯èƒ½ä¼šåŒæ—¶è¾“å‡ºä¸€ä¸ª<code>RECEIVE</code>å’Œä¸€ä¸ª<code>SCHE-BEGIN</code>ã€‚æœ€åæ£€æŸ¥å‘ç°æ˜¯åœ¨æ‰§è¡Œä¸´æ—¶è°ƒåº¦çš„å¼€å§‹é˜¶æ®µï¼Œç¬”è€…æŠŠé”æŒ‚åœ¨äº†ç”µæ¢¯èº«ä¸Šï¼Œè€Œä¸æ˜¯æœªå®Œæˆè¯·æ±‚åˆ—è¡¨ï¼Œè¿™å¯¼è‡´åˆ†é…çº¿ç¨‹åœ¨æ­¤æœŸé—´è¿˜å¯ä»¥æˆ¿å±‹å†…æœªå®Œæˆè¯·æ±‚åˆ—è¡¨ï¼Œå¹¶æŠŠä¸€ä¸ªè¯·æ±‚åˆ†é…ç»™è¯¥ç”µæ¢¯ã€‚è€Œå¯¹äºç¬”è€…çš„å®ç°ï¼Œè¾“å‡º<code>RECEIVE</code>æ˜¯äº¤ç»™åˆ†é…å™¨çš„ï¼Œå› æ­¤ä¼šå¯¼è‡´åŒæ—¶è¾“å‡ºã€‚</p><p>åœ¨äº’æµ‹ä¸­ï¼Œç¬”è€…å‘ç°åŒæˆ¿é—´åŒå­¦çš„ä¸€ä¸ªæœ‰è¶£çš„bugã€‚è¯¥åŒå­¦ä¼¼ä¹ä¸ºäº†è¿½æ±‚æ€§èƒ½ï¼Œå°½é‡åœ¨è¾“å‡º<code>SHCE-BEGIN</code>å‰å¤šè·‘å‡ å±‚æ¥¼ã€‚å› æ­¤ï¼Œç¬”è€…æ„é€ äº†ä¸€ä¸ªè·¨åº¦è¾ƒé•¿çš„<code>SCHE</code>è¯·æ±‚ï¼ŒæŠŠç”µæ¢¯å¡åœ¨æé™è·ç¦»ï¼Œè®©è¯¥ç”µæ¢¯çš„ç›¸åº”<code>SCHE</code>æ—¶é—´è¶…è¿‡è§„å®šæ—¶é—´äº†ã€‚</p><h2 id="hw7"><a href="#hw7" class="headerlink" title="hw7"></a>hw7</h2><h3 id="å¦‚ä½•å¤„ç†è½¿å¢ä¸ç¢°æ’"><a href="#å¦‚ä½•å¤„ç†è½¿å¢ä¸ç¢°æ’" class="headerlink" title="å¦‚ä½•å¤„ç†è½¿å¢ä¸ç¢°æ’"></a>å¦‚ä½•å¤„ç†è½¿å¢ä¸ç¢°æ’</h3><p>ç»å†è¿‡å‰ä¸¤æ¬¡ä½œä¸šçš„<del>æŠ˜ç£¨</del>ä¹‹åï¼Œè¿™ä¸ªé—®é¢˜å…¶å®å¾ˆå®¹æ˜“æƒ³åˆ°è§£å†³åŠæ³•ã€‚ç¬”è€…åœ¨ç”µæ¢¯å†…éƒ¨æ–°å»ºä¸€ä¸ª<code>TargetFloor</code>å¯¹è±¡ï¼Œå¯¹äºåŒä¸€ä¸ªäº•é“çš„ä¸¤ä¸ªç”µæ¢¯ï¼Œå®ƒä»¬å…±äº«è¿™ä¸€ä¸ªæ¥¼å±‚ã€‚ç¬”è€…ä»¤åˆ°è¾¾æ¢ä¹˜å±‚çš„ç”µæ¢¯è·å–æ¢ä¹˜å±‚å¯¹è±¡çš„é”ï¼Œåœ¨ç¦»å¼€è¯¥å±‚æ—¶é‡Šæ”¾æ¢ä¹˜å±‚å¯¹è±¡çš„é”ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ°è¾¾ä¸ç¦»å¼€å‡ä»¥è¾“å‡ºä¸ºæ ‡å‡†</p><h3 id="å¦‚ä½•å®ç°åŒè½¿å¢ç”µæ¢¯"><a href="#å¦‚ä½•å®ç°åŒè½¿å¢ç”µæ¢¯" class="headerlink" title="å¦‚ä½•å®ç°åŒè½¿å¢ç”µæ¢¯"></a>å¦‚ä½•å®ç°åŒè½¿å¢ç”µæ¢¯</h3><p>ç¬”è€…çš„å®ç°ååˆ†çš„ä¸ä¼˜é›…ã€‚</p><p>è°ƒåº¦å™¨åˆ†åˆ«æŠŠè¿™ä¸ª<code>update</code>è¯·æ±‚äº¤ç»™Aã€Bä¸¤éƒ¨ç”µæ¢¯ï¼Œä¸¤éƒ¨ç”µæ¢¯åŒæ—¶å¼€å§‹æ”¹é€ ï¼Œåˆ†åˆ«æ”¾å‡ºå…¶å†…éƒ¨çš„ä¹˜å®¢ã€ä¿®æ”¹å‚æ•°ä¿¡æ¯ï¼ˆæœ€é«˜åˆ°è¾¾æ¥¼å±‚ç­‰ï¼‰ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸­çš„<code>UPDATE-BEGIN</code>ç­‰ï¼Œå‡ç”±Aç”µæ¢¯æ¥è¿›è¡Œè¾“å‡ºï¼Œä¸è¿‡å¾ˆå¿«ç¬”è€…å°±å‘ç°è¿™æ ·çš„å®ç°æ˜¯æœ‰é—®é¢˜çš„ã€‚</p><p>å°½ç®¡ä¸¤éƒ¨ç”µæ¢¯åŒæ—¶æ¥å—åˆ°äº†æ¥è‡ªè°ƒåº¦å™¨çš„è¯·æ±‚ï¼Œä½†è¿™ä¸èƒ½ä¿è¯ä¸¤éƒ¨ç”µæ¢¯å¯ä»¥åŒæ—¶è¿›è¡Œ<code>UPDATE</code>ï¼Œæˆ–è€…è¯´<code>UPDATE</code>çš„è¿›åº¦èƒ½ä¿æŒä¸€æ ·ï¼Œè¿™å°±å¯¼è‡´äº†æœ‰å¯èƒ½å½“Aç”µæ¢¯å·²ç»è¾“å‡ºäº†<code>UPDATE-BEGIN</code>çš„æ—¶å€™ï¼ŒBç”µæ¢¯è¿˜åœ¨æ”¾å‡ºå®¢äººï¼›æˆ–è€…å½“Aç”µæ¢¯å°šæœªè¾“å‡º<code>UPDATE-END</code>çš„æ—¶å€™ï¼ŒBç”µæ¢¯å·²ç»å®Œæˆäº†æ”¹é€ ï¼Œå¼€å§‹<code>RECEIVE</code>ä¹˜å®¢äº†ã€‚</p><p>ç¬”è€…æœ€åé‡‡ç”¨äº†è¿™æ ·çš„æ–¹æ³•ï¼šå¯¹äºä¸€ä¸ªupdateçš„è¯·æ±‚ï¼Œå…¶å†…éƒ¨è®¾ç½®ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯<code>UPDATE</code>çš„å‡†å¤‡ã€å¼€å§‹å’Œç»“æŸã€‚æ¯ä¸ªæ–¹æ³•è¦æ±‚ä¸¤éƒ¨ç”µæ¢¯éƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰ä¼šä½¿å¾—ç”µæ¢¯åŒæ­¥è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚å…¶å®æ›´ä¼˜é›…çš„æ–¹æ³•å°±æ˜¯æŠŠè¾“å‡ºä¹Ÿæ”¾ç½®åˆ°è¿™äº›æ–¹æ³•ä¸­ï¼Œä½†ç¬”è€…æ²¡æœ‰æ›´æ”¹ã€‚</p><h3 id="æ•´ä½“æ¶æ„-2"><a href="#æ•´ä½“æ¶æ„-2" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h3><p><img src="/img/OO-Unit2/ClassDiagram_seventh.png" alt="ç¬¬ä¸ƒæ¬¡ä½œä¸šç±»å›¾"></p><p>ç±»å›¾å¦‚ä¸Šæ‰€ç¤ºï¼Œæ¶æ„è¾ƒä¸Šä¸€æ¬¡ä½œä¸šæ²¡æœ‰å¤ªå¤§å˜åŒ–ã€‚</p><h3 id="ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ-1"><a href="#ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ-1" class="headerlink" title="ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ"></a>ä»£ç é‡å’Œå¤æ‚åº¦åˆ†æ</h3><p><img src="/img/OO-Unit2/Code_seventh.png" alt="ç¬¬ä¸ƒæ¬¡ä½œä¸šä»£ç é‡"></p><p>ç¬¬ä¸ƒæ¬¡ä½œä¸šä»£ç é‡çªç ´äº†1000è¡Œï¼Œå…¶å®æ•´ä½“ä¸Šè¿˜æ˜¯æœ‰ä¸œè¥¿å¯ä»¥åˆå¹¶çš„ï¼Œåœ¨ä»£ç å—ä¸­æœ‰å‡ å¤„é‡å¤æˆ–è€…é«˜åº¦ç›¸ä¼¼çš„ä»£ç æ®µã€‚ä¸»è¦é›†ä¸­åœ¨<code>Elevator</code>ç±»é‡Œé¢ã€‚</p><p><img src="/img/OO-Unit2/Magnanimity_seventh.png" alt="ç¬¬ä¸ƒæ¬¡ä½œä¸šå¤æ‚åº¦"></p><p>ä½œä¸šæ•´ä½“çš„å¤æ‚åº¦ä¹Ÿå¾ˆé«˜ï¼Œé›†ä¸­åœ¨ç”µæ¢¯ã€è°ƒåº¦å™¨ç­‰ã€‚ä¸ºäº†è¿åˆåŒè½¿å¢ç”µæ¢¯çš„æ”¹é€ ï¼Œ<code>Scheduler</code>ï¼Œå³ç”µæ¢¯è¡Œä¸ºçš„æŒ‡ç¤ºå™¨ï¼Œå¤æ‚åº¦ä¹Ÿå˜é«˜äº†ã€‚</p><h3 id="å€¼å¾—æ³¨æ„çš„bug-2"><a href="#å€¼å¾—æ³¨æ„çš„bug-2" class="headerlink" title="å€¼å¾—æ³¨æ„çš„bug"></a>å€¼å¾—æ³¨æ„çš„bug</h3><p>æœ¬æ¬¡ä½œä¸šå‡ºç°çš„æœ‰è¶£çš„bugéƒ½åœ¨å¼€å¤´éƒ¨åˆ†äº¤ä»£äº†ã€‚åœ¨å¼ºæµ‹å’Œäº’æµ‹ä¸­å‡æ²¡æœ‰è·‘å‡ºbugã€‚</p><h2 id="åŒæ­¥å—å’Œé”"><a href="#åŒæ­¥å—å’Œé”" class="headerlink" title="åŒæ­¥å—å’Œé”"></a>åŒæ­¥å—å’Œé”</h2><p>æœ¬æ¬¡ä½œä¸šä¸­ï¼Œç¬”è€…ä¸»è¦ä½¿ç”¨çš„éƒ½æ˜¯<code>synchronized</code>å…³é”®å­—ã€‚åœ¨ç¬¬å…­æ¬¡ä½œä¸šçš„å®ç°è¿‡ç¨‹ä¸­ï¼Œç¬”è€…åˆæ­¥å°è¯•äº†ä½¿ç”¨è¯»å†™é”ï¼Œä½†æ˜¯åœ¨è‡ªå·±è¯„æµ‹çš„è¿‡ç¨‹ä¸­å‡ºç°äº†å¾ˆå¤šéš¾ä»¥ä¿®å¤çš„<del>å¥‡å¦™</del>bugï¼Œ<del>é‚ä½œç½¢</del>ï¼Œæ”¹å›<code>synchronized</code>ã€‚å¦å¤–ï¼Œå¯¹äºå¾ˆå¤šç§æœ‰å˜é‡ï¼Œæˆ‘ä½¿ç”¨äº†<code>AtomicBoolean</code>ä»¥åŠ<code>AtomicInteger</code>ï¼Œé™ä½äº†é”çš„ä½¿ç”¨é¢‘ç‡ã€‚javaä¿è¯äº†å¯¹è¿™äº›å˜é‡çš„è¯»å†™éƒ½æ˜¯åŸå­æ€§çš„ã€‚</p><h2 id="bugä»¥åŠdebugæ–¹æ³•"><a href="#bugä»¥åŠdebugæ–¹æ³•" class="headerlink" title="bugä»¥åŠdebugæ–¹æ³•"></a>bugä»¥åŠdebugæ–¹æ³•</h2><p>æœ¬æ¬¡ç”µæ¢¯å•å…ƒï¼Œç¬”è€…æ˜¯æ— ä¼¤é€šå…³ï¼Œå¼ºæµ‹äº’æµ‹å‡æ²¡æœ‰å‡ºç°bugã€‚å¯¹äºdebugï¼Œç¬”è€…æœ‰ä¸€äº›è‡ªå·±æ¯”è¾ƒå¥½ç”¨çš„æ–¹æ³•ï¼š</p><ol><li>è°ƒè¯•è¾“å‡º<br> å¤šçº¿ç¨‹çš„bugå¹¶ä¸èƒ½ç¨³å®šå¤ç°ï¼Œè€Œä¸”ä¹Ÿä¸èƒ½é€šè¿‡æ‰“æ–­ç‚¹çš„æ–¹æ³•å»debugï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œè°ƒè¯•è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸€äº›å…³é”®åœ°æ–¹è¾“å‡ºä¸€äº›èƒ½åæ˜ çº¿ç¨‹å‚æ•°çš„ä¿¡æ¯ã€‚æ¯”å¦‚åœ¨çº¿ç¨‹ç»“æŸæ—¶ï¼Œè®©çº¿ç¨‹è¾“å‡º<code>end</code>ç­‰ï¼Œè¿™æ ·å¯ä»¥è§‚å¯Ÿæœ‰å“ªäº›çº¿ç¨‹å¯èƒ½æ²¡æœ‰æ­£å¸¸ç»“æŸï¼Œè¿›è€Œå‘ç°ç¨‹åºä¸­çš„ç¼ºé™·</li><li>ä»£ç èµ°æŸ¥<br> ä»£ç èµ°æŸ¥æŒ‡çš„æ˜¯åœ¨ä»£ç å†™å®Œä¹‹åé€šè¯»ä»£ç å…¨ä½“ï¼Œæ£€æŸ¥ä»£ç æ½œåœ¨çš„bugã€‚ç¬”è€…ä¸»è¦é€šè¿‡è¿™ç§æ–¹æ³•æ¥å¯»æ‰¾å¯èƒ½å‡ºç°çš„çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ï¼Œä¹Ÿç¡®å®ç”¨è¿™æ ·çš„æ–¹æ³•æˆåŠŸçš„æŸ¥æ¼è¡¥ç¼ºäº†ã€‚</li><li>æ„é€ è¯„æµ‹æœº<br> è‡ªåŠ¨åŒ–è¯„æµ‹å¯¹äºå¤šçº¿ç¨‹é—®é¢˜æ¥è¯´ï¼Œç¬”è€…è®¤ä¸ºæ˜¯å¿…è¦çš„ã€‚å¤§é‡çš„æµ‹è¯•ç‚¹æ‰æœ‰å¯èƒ½æµ‹å‡ºå¤šçº¿ç¨‹é¡¹ç›®ä¸­æ½œåœ¨çš„é—®é¢˜ï¼Œäººå·¥æ„é€ çš„æµ‹è¯•ç‚¹å¹¶ä¸æ€»èƒ½å¾ˆå¥½çš„â€å‹è¿«è¾¹ç•Œâ€œã€‚æ„é€ è¯„æµ‹æœºæ–¹æ³•ï¼Œè¯¦æƒ…å¯ä»¥çœ‹ç¬”è€…çš„<a href="http://oo.buaa.edu.cn/assignment/624/discussion/1691">è®¨è®ºåŒºå¸–å­</a>ï¼ŒæŠ‘æˆ–æ˜¯å·²ç»åŒæ­¥æ›´æ–°çš„<a href="https://www.oldjoy.top/2025/04/08/%E6%88%91%E4%BC%9A%E6%9E%84%E5%BB%BA%E5%81%A5%E5%A3%AE%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%94%B5%E6%A2%AF%E8%AF%84%E6%B5%8B%E6%9C%BA/%E6%88%91%E4%BC%9A%E6%9E%84%E5%BB%BA%E5%81%A5%E5%A3%AE%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%94%B5%E6%A2%AF%E8%AF%84%E6%B5%8B%E6%9C%BA/">åšå®¢</a>ã€‚</li></ol><h2 id="å¿ƒå¾—ä½“ä¼š"><a href="#å¿ƒå¾—ä½“ä¼š" class="headerlink" title="å¿ƒå¾—ä½“ä¼š"></a>å¿ƒå¾—ä½“ä¼š</h2><p>ç»å†äº†é¢å‘å¯¹è±¡å’Œæ“ä½œç³»ç»Ÿçš„<del>åŒé‡æŠ˜ç£¨</del>ï¼Œç¬”è€…ç®—æ˜¯å¯¹å¤šçº¿ç¨‹æœ‰äº†ä¸€ç‚¹ç†è§£ã€‚å¯¹äºå¤šçº¿ç¨‹ç¼–ç¨‹ï¼ŒåŒæ­¥ä¸äº’æ–¥ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œæ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹æœ€æ ¸å¿ƒçš„å†…å®¹ä¹‹ä¸€ã€‚</p><p>ç¬”è€…åœ¨æµ‹è¯•ä¸­æ²¡æœ‰å‘ç°è‡ªå·±çš„ä»»ä½•æœ‰å…³çº¿ç¨‹å®‰å…¨çš„bugï¼Œè¿™ä¸»è¦å½’åŠŸäºåœ¨å¼€å§‹å­¦ä¹ å¤šçº¿ç¨‹ç¼–ç¨‹ä¹‹å‰ï¼Œç¬”è€…å¯¹çº¿ç¨‹é—®é¢˜è¿›è¡Œäº†ç»†è‡´ç³»ç»Ÿçš„å­¦ä¹ ã€‚å°½ç®¡å¦‚æ­¤ï¼Œç¬”è€…ä¹Ÿå¹¶ä¸è®¤ä¸ºè‡ªå·±å¯¹çº¿ç¨‹å®‰å…¨å·²ç»å®Œå…¨æŒæ¡ã€‚æœ¬æ¬¡ä½œä¸šå¹¶å‘ç¨‹åº¦å¹¶ä¸é«˜ï¼Œå…±äº«èµ„æºå¹¶ä¸å¤æ‚ï¼Œå°šä¸”æ²¡æœ‰è¾¾åˆ°ç”Ÿæ´»ä¸­å¸¸è§çš„å¤šçº¿ç¨‹é—®é¢˜ï¼ˆ12306ï¼‰ï¼Œåªèƒ½è¯´å¯¹å¤šçº¿ç¨‹åˆçª¥é—¨å¾„ã€‚</p><h2 id="å±‚æ¬¡åŒ–è®¾è®¡"><a href="#å±‚æ¬¡åŒ–è®¾è®¡" class="headerlink" title="å±‚æ¬¡åŒ–è®¾è®¡"></a>å±‚æ¬¡åŒ–è®¾è®¡</h2><p>æœ¬æ¬¡ä½œä¸šçš„æ ¸å¿ƒæ¶æ„æ²¡æœ‰ç¦»å¼€å¤šçº¿ç¨‹æ¶æ„ä¸­ç»å…¸çš„<strong>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹</strong>ï¼Œè€Œç»å†äº†æ“ä½œç³»ç»Ÿçš„å­¦ä¹ ä¹‹åï¼Œè¿™æ ·çš„æ¨¡å‹å…¶å®è¿˜æœ‰æ›´å¤šã€æ›´å¤æ‚ã€åŒæ ·å¾ˆç²¾å·§çš„æ¨¡å‹ã€‚</p><p>å±‚æ¬¡åŒ–è®¾è®¡è¦æ±‚ç¼–ç¨‹è€…è‡ªé¡¶å‘ä¸‹å¯¹æ•´ä¸ªè®¾è®¡ä»»åŠ¡è¿›è¡Œåˆ†å±‚åˆ†å—ï¼Œå¹¶å¯¹æ¯å±‚æ¯å—åˆ†åˆ«å»ºç±»å®ç°ã€‚é«˜å±‚çš„ç±»åªå…³æ³¨æŠ½è±¡åçš„åŠŸèƒ½è°ƒç”¨ï¼Œè€Œåº•å±‚çš„ç±»åˆ™è´Ÿè´£æ¯ç§åŠŸèƒ½çš„å…·ä½“å®ç°ã€‚è¿™æ ·çš„åšæ³•åœ¨é™ä½æ¯å±‚ä»£ç çš„å¤æ‚åº¦å‘åŒæ—¶ä¹Ÿä¼šå¢åŠ ç¨‹åºçš„ä»£ç æ€»é‡ï¼Œæ‰€ä»¥åº”è¯¥åˆç†å¹³è¡¡ä»£ç å¤æ‚åº¦ä¸ä»£ç é‡ã€‚</p><p>æœ¬æ¬¡ä½œä¸šä¸­ï¼Œæˆ‘çš„å±‚æ¬¡åŒ–è®¾è®¡æ•´ä½“è¿˜ç®—æ¯”è¾ƒå¥½ï¼Œæ¯ä¸ªç±»è´Ÿè´£çš„åŠŸèƒ½æ¯”è¾ƒå•ä¸€ï¼Œç±»é—´é€»è¾‘æ¯”è¾ƒæ¸…æ™°ã€‚ä½†å…¶å®è¿˜å¯ä»¥åšçš„æ›´å¥½ï¼Œæœ‰å¾ˆå¤šå¯ä»¥ç»§ç»­æŠ½è±¡çš„åœ°æ–¹å°šå¯ä¼˜åŒ–ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OO_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_Lab2_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/04/11/OS-Lab2/BUAA-OS-Lab2%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/04/11/OS-Lab2/BUAA-OS-Lab2%20%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h1><h2 id="Thinking-2-1"><a href="#Thinking-2-1" class="headerlink" title="Thinking 2.1"></a>Thinking 2.1</h2><blockquote><p>è¯·æ ¹æ®ä¸Šè¿°è¯´æ˜ï¼Œå›ç­”é—®é¢˜ï¼šåœ¨ç¼–å†™çš„ C ç¨‹åºä¸­ï¼ŒæŒ‡é’ˆå˜é‡ä¸­å­˜å‚¨çš„åœ°å€è¢«è§†ä¸ºè™šæ‹Ÿåœ°å€ï¼Œè¿˜æ˜¯ç‰©ç†åœ°å€ï¼ŸMIPS æ±‡ç¼–ç¨‹åºä¸­ lw å’Œ sw æŒ‡ä»¤ä½¿ç”¨çš„åœ°å€è¢«è§†ä¸ºè™šæ‹Ÿåœ°å€ï¼Œè¿˜æ˜¯ç‰©ç†åœ°å€ï¼Ÿ</p></blockquote><p>C è¯­è¨€ä¸­æŒ‡é’ˆå˜é‡å‚¨å­˜çš„åœ°å€æ˜¯è™šæ‹Ÿåœ°å€ï¼Œæ±‡ç¼–ä»£ç ä¸­ lw å’Œ sw æŒ‡ä»¤ä¸­ä½¿ç”¨çš„åœ°å€ä¹Ÿæ˜¯è™šæ‹Ÿåœ°å€ã€‚</p><h2 id="Thinking-2-2"><a href="#Thinking-2-2" class="headerlink" title="Thinking 2.2"></a>Thinking 2.2</h2><blockquote><ul><li>ä»å¯é‡ç”¨æ€§çš„è§’åº¦ï¼Œé˜è¿°ç”¨å®æ¥å®ç°é“¾è¡¨çš„å¥½å¤„ã€‚</li><li>æŸ¥çœ‹å®éªŒç¯å¢ƒä¸­çš„ &#x2F;usr&#x2F;include&#x2F;sys&#x2F;queue.hï¼Œäº†è§£å…¶ä¸­å•å‘é“¾è¡¨ä¸å¾ªç¯é“¾è¡¨çš„å®ç°ï¼Œæ¯”è¾ƒå®ƒä»¬ä¸æœ¬å®éªŒä¸­ä½¿ç”¨çš„åŒå‘é“¾è¡¨ï¼Œåˆ†æä¸‰è€…åœ¨æ’å…¥ä¸åˆ é™¤æ“ä½œä¸Šçš„æ€§èƒ½å·®å¼‚ã€‚</li></ul></blockquote><ol><li><p>ä½¿ç”¨å®æ¥å®ç°é“¾è¡¨çš„å¥½å¤„æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>ä»£ç å¤ç”¨ï¼šå®å¯ä»¥ä½¿é“¾è¡¨çš„å®šä¹‰å’Œæ“ä½œå˜å¾—é€šç”¨ï¼Œä¸å—ç‰¹å®šæ•°æ®ç±»å‹çš„å½±å“ã€‚é€šè¿‡å®ï¼Œå¯ä»¥åœ¨ä¸åŒçš„æ•°æ®ç»“æ„ä¸­é‡ç”¨ç›¸åŒçš„é“¾è¡¨å®ç°ä»£ç ï¼Œåªéœ€ç®€å•åœ°å°†é“¾è¡¨èŠ‚ç‚¹ä¸­çš„æ•°æ®ç±»å‹è¿›è¡Œæ›¿æ¢å³å¯ã€‚</li><li>ç±»å‹æ— å…³æ€§ï¼šå®å…è®¸é“¾è¡¨æ“ä½œä¸å…·ä½“çš„å­˜å‚¨ç±»å‹æ— å…³ï¼Œè¿™æ„å‘³ç€åŒä¸€ä¸ªå®å®šä¹‰å¯ä»¥ç”¨äºåˆ›å»ºå­˜å‚¨ä¸åŒç±»å‹æ•°æ®çš„é“¾è¡¨ã€‚</li><li>æ€§èƒ½ä¼˜åŠ¿ï¼šå®åœ¨ç¼–è¯‘æ—¶ä¼šè¢«ç›´æ¥æ›¿æ¢ä¸ºç›¸åº”çš„ä»£ç ï¼Œæ²¡æœ‰å‡½æ•°è°ƒç”¨çš„å¼€é”€ã€‚è¿™å¯ä»¥å‡å°‘ç¨‹åºè¿è¡Œæ—¶çš„æ€§èƒ½æŸè€—ã€‚</li></ul></li><li><p>é˜…è¯»äº†ç³»ç»Ÿä¸­<code>queue.h</code>å¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“è®º</p><ul><li>å•é¡¹é“¾è¡¨å¦‚æœè¦æ’å…¥åˆ°é“¾è¡¨ä¸­é—´çš„æŸä¸ªä½ç½®ï¼Œéœ€è¦ä»å¤´éƒ¨éå†ä¸€éæ‰èƒ½æ‰¾åˆ°ç›¸åº”çš„ä½ç½®ï¼Œè¿™ä¸ªäº‹ä»¶å¤æ‚çš„æ˜¯ O(n)ï¼›</li><li>è€ŒåŒå‘é“¾è¡¨è®°å½•äº†å…ƒç´ çš„å‰é©±å’Œåç»§ï¼Œå®ƒå¯¹äºä»»æ„å…ƒç´ åœ¨ä»»æ„ç»™å®šä½ç½®çš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦éƒ½åªæœ‰ O(1)ï¼›</li><li>å¾ªç¯åˆ—è¡¨æœ¬è´¨å’Œå•å‘é“¾è¡¨å·®ä¸å¤š</li></ul></li></ol><h2 id="Thinking-2-3"><a href="#Thinking-2-3" class="headerlink" title="Thinking 2.3"></a>Thinking 2.3</h2><blockquote><p>è¯·é˜…è¯» include&#x2F;queue.h ä»¥åŠ include&#x2F;pmap.h, å°† Page_list çš„ç»“æ„æ¢³ç†æ¸…æ¥šï¼Œé€‰æ‹©æ­£ç¡®çš„å±•å¼€ç»“æ„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">A:</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page_list</span>&#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_next</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_prev</span>;</span></span><br><span class="line">&#125; pp_link;</span><br><span class="line">u_short pp_ref;</span><br><span class="line">&#125;* lh_first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">B:</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page_list</span>&#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_next</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> **<span class="title">le_prev</span>;</span></span><br><span class="line">&#125; pp_link;</span><br><span class="line">u_short pp_ref;</span><br><span class="line">&#125; lh_first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page_list</span>&#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_next</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> **<span class="title">le_prev</span>;</span></span><br><span class="line">&#125; pp_link;</span><br><span class="line">u_short pp_ref;</span><br><span class="line">&#125;* lh_first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>åº”å½“é€‰æ‹©<code>C</code>ã€‚<br>å…³äº<code>Page</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> &#123;</span></span><br><span class="line">    Page_LIST_entry_t pp_link;  <span class="comment">/* free list link */</span></span><br><span class="line">    u_short pp_ref;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è€Œå…³äº<code>Page_LIST_entry_t</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> LIST_ENTRY(type)                                                    \</span></span><br><span class="line"><span class="meta">        struct &#123;                                                                \</span></span><br><span class="line"><span class="meta">                struct type *le_next;   <span class="comment">/* next element */</span>                      \</span></span><br><span class="line"><span class="meta">                struct type **le_prev;  <span class="comment">/* address of previous next element */</span>  \</span></span><br><span class="line"><span class="meta">        &#125;</span></span><br></pre></td></tr></table></figure><h2 id="Thinking-2-4"><a href="#Thinking-2-4" class="headerlink" title="Thinking 2.4"></a>Thinking 2.4</h2><blockquote><ul><li>è¯·é˜…è¯»ä¸Šé¢æœ‰å…³ TLB çš„æè¿°ï¼Œä»è™šæ‹Ÿå†…å­˜å’Œå¤šè¿›ç¨‹æ“ä½œç³»ç»Ÿçš„å®ç°è§’åº¦ï¼Œé˜è¿° ASIDçš„å¿…è¦æ€§ã€‚</li><li>è¯·é˜…è¯» MIPS 4Kc æ–‡æ¡£ã€ŠMIPS32Â® 4Kâ„¢ Processor Core Family Software Userâ€™s Manualã€‹çš„ Section 3.3.1 ä¸ Section 3.4ï¼Œç»“åˆ ASID æ®µçš„ä½æ•°ï¼Œè¯´æ˜ 4Kc ä¸­å¯å®¹çº³ä¸åŒçš„åœ°å€ç©ºé—´çš„æœ€å¤§æ•°é‡ã€‚</li></ul></blockquote><p>åœ¨å¤šè¿›ç¨‹ç¯å¢ƒä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œè¿™äº›åœ°å€ç©ºé—´é€šå¸¸æ˜¯ç‹¬ç«‹çš„ã€‚ASIDç”¨äºåœ¨TLBä¸­åŒºåˆ†ä¸åŒè¿›ç¨‹çš„é¡µè¡¨é¡¹ï¼Œç¡®ä¿æ¯ä¸ªè¿›ç¨‹åªèƒ½è®¿é—®è‡ªå·±çš„å†…å­˜åœ°å€ï¼Œä»è€Œå®ç°è¿›ç¨‹é—´çš„éš”ç¦»ã€‚</p><p>ASIDä½¿å¾—æ“ä½œç³»ç»Ÿåœ¨ç®¡ç†å†…å­˜æ—¶æ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚å®ƒå…è®¸æ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œè€Œä¸éœ€è¦å…³å¿ƒè¿›ç¨‹çš„å…·ä½“è™šæ‹Ÿåœ°å€ç©ºé—´å¸ƒå±€ï¼Œä»è€Œç®€åŒ–äº†å†…å­˜ç®¡ç†çš„å·¥ä½œã€‚</p><p>å½“CPUè¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œå¦‚æœæ²¡æœ‰ASIDï¼Œåˆ™éœ€è¦å°†TLBä¸­çš„æ‰€æœ‰æ¡ç›®åˆ·æ–°ï¼Œå› ä¸ºæ–°çš„è¿›ç¨‹å¯èƒ½ä¼šä½¿ç”¨ç›¸åŒçš„è™šæ‹Ÿåœ°å€ï¼Œè€Œè¿™äº›åœ°å€åœ¨TLBä¸­å¯èƒ½æ˜ å°„åˆ°ä¸åŒçš„ç‰©ç†åœ°å€ã€‚ASIDå…è®¸TLBä¿ç•™å¤šä¸ªè¿›ç¨‹çš„æ¡ç›®ï¼Œåªæœ‰å½“åˆ‡æ¢åˆ°å…·æœ‰ç›¸åŒASIDçš„è¿›ç¨‹æ—¶æ‰éœ€è¦åˆ·æ–°ç›¸å…³çš„TLBæ¡ç›®ï¼Œå‡å°‘äº†ä¸å¿…è¦çš„åˆ·æ–°æ“ä½œã€‚</p><p>ASID 6 ä½ï¼Œå› æ­¤å¯ä»¥æœ€å¤šå®¹çº³ 64 ä¸ªä¸åŒçš„åœ°å€ç©ºé—´ã€‚</p><h2 id="Thinking-2-5"><a href="#Thinking-2-5" class="headerlink" title="Thinking 2.5"></a>Thinking 2.5</h2><blockquote><ul><li>tlb_invalidate å’Œ tlb_out çš„è°ƒç”¨å…³ç³»ï¼Ÿ</li><li>è¯·ç”¨ä¸€å¥è¯æ¦‚æ‹¬ tlb_invalidate çš„ä½œç”¨ã€‚</li><li>é€è¡Œè§£é‡Š tlb_out ä¸­çš„æ±‡ç¼–ä»£ç ã€‚</li></ul></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">tlb_invalidate</span><span class="params">(u_int asid, u_long va)</span> &#123;</span><br><span class="line">    tlb_out((va &amp; ~GENMASK(PGSHIFT, <span class="number">0</span>)) | (asid &amp; (NASID - <span class="number">1</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯<code>tlb_invalidate</code>è°ƒç”¨<code>tlb_out</code></p><p>é€è¡Œè§£é‡Šå¦‚ä¸‹ï¼š</p><figure class="highlight mips"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">LEAF(tlb_out) <span class="comment"># æ ‡è®°è¿™æ˜¯ä¸€ä¸ªå¶å­å‡½æ•°ï¼Œå³å®ƒä¸ä¼šè°ƒç”¨å…¶ä»–å‡½æ•°ï¼Œä¹Ÿä¸ä¼šä¿å­˜å…¶ä»–å¯„å­˜å™¨çš„çŠ¶æ€ã€‚</span></span><br><span class="line"><span class="meta">.set</span> <span class="keyword">noreorder </span><span class="comment"># å‘Šè¯‰æ±‡ç¼–å™¨ä¸è¦å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ–°æ’åºï¼Œç¡®ä¿æŒ‡ä»¤æŒ‰ç…§å†™çš„é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">mfc0 </span>   <span class="built_in">t0</span>, CP0_ENTRYHI <span class="comment"># å°† CP0 å¯„å­˜å™¨ä¸­çš„ ENTRYHIï¼ˆTLB çš„é”®å­—æ®µï¼‰å†…å®¹å¤åˆ¶åˆ°é€šç”¨å¯„å­˜å™¨ t0 ä¸­ï¼Œä¿å­˜åŸå§‹çš„ ENTRYHI å€¼</span></span><br><span class="line">    <span class="keyword">mtc0 </span>   <span class="built_in">a0</span>, CP0_ENTRYHI <span class="comment"># å°†ä¼ å…¥çš„å‚æ•°ï¼ˆa0 å¯„å­˜å™¨ä¸­çš„å€¼ï¼‰å¤åˆ¶åˆ° CP0 çš„ ENTRYHI å¯„å­˜å™¨ä¸­ï¼Œå‡†å¤‡è¿›è¡ŒTLBæ“ä½œ</span></span><br><span class="line">    <span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span>    <span class="comment">/* Step 1: Use &#x27;tlbp&#x27; to probe TLB entry */</span></span><br><span class="line">    <span class="comment">/* Exercise 2.8: Your code here. (1/2) */</span></span><br><span class="line">    <span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span>    <span class="keyword">tlbp </span><span class="comment"># æ ¹æ® EntryHi ä¸­çš„ Keyï¼ŒæŸ¥æ‰¾ TLB ä¸­ä¸ä¹‹å¯¹åº”çš„è¡¨é¡¹ï¼Œå¹¶å°†è¡¨é¡¹çš„ç´¢å¼•å­˜å…¥ Index å¯„å­˜å™¨</span></span><br><span class="line">    <span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span>    <span class="comment">/* Step 2: Fetch the probe result from CP0.Index */</span></span><br><span class="line">    <span class="keyword">mfc0 </span>   <span class="built_in">t1</span>, CP0_INDEX <span class="comment"># å°† CP0 çš„ INDEX å¯„å­˜å™¨å†…å®¹ï¼ˆTLB æ¢æµ‹çš„ç»“æœï¼‰å¤åˆ¶åˆ°é€šç”¨å¯„å­˜å™¨ t1 ä¸­</span></span><br><span class="line">    <span class="meta">.set</span> reorder</span><br><span class="line">    <span class="keyword">bltz </span>   <span class="built_in">t1</span>, NO_SUCH_ENTRY <span class="comment"># å¦‚æœ TLB ä¸­æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æ¡ç›®ï¼Œè·³è½¬åˆ° NO_SUCH_ENTRY æ ‡ç­¾</span></span><br><span class="line">    <span class="meta">.set</span> <span class="keyword">noreorder</span></span><br><span class="line"><span class="keyword"></span>    <span class="keyword">mtc0 </span>   <span class="built_in">zero</span>, CP0_ENTRYHI</span><br><span class="line">    <span class="keyword">mtc0 </span>   <span class="built_in">zero</span>, CP0_ENTRYLO0</span><br><span class="line">    <span class="keyword">mtc0 </span>   <span class="built_in">zero</span>, CP0_ENTRYLO1 <span class="comment"># æŠŠ CP0_ENTRYHIï¼ŒCP0_ENTRYLO å…¨éƒ¨è®¾ä¸º 0ï¼Œä¸ºæ¸…ç©º TLB åšå‡†å¤‡</span></span><br><span class="line">    <span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span>    <span class="comment">/* Step 3: Use &#x27;tlbwi&#x27; to write CP0.EntryHi/Lo into TLB at CP0.Index  */</span></span><br><span class="line">    <span class="comment">/* Exercise 2.8: Your code here. (2/2) */</span></span><br><span class="line">    <span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span>    <span class="keyword">tlbwi </span><span class="comment"># å°†æ­¤æ—¶ EntryHi ä¸ EntryLo çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ 0ï¼Œå†™åˆ°ç´¢å¼•æŒ‡å®šçš„ TLB è¡¨é¡¹ä¸­ï¼Œå®Œæˆæ¸…ç©º</span></span><br><span class="line">    <span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span><span class="meta">.set</span> reorder</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">NO_SUCH_ENTRY:</span></span><br><span class="line">    <span class="keyword">mtc0 </span>   <span class="built_in">t0</span>, CP0_ENTRYHI <span class="comment"># å°†ä¹‹å‰ä¿å­˜çš„åŸå§‹ ENTRYHI å€¼å†™å›åˆ° CP0 çš„ ENTRYHI å¯„å­˜å™¨ä¸­ï¼Œæ¢å¤ä¸Šä¸‹æ–‡</span></span><br><span class="line">    <span class="keyword">j </span>      <span class="built_in">ra</span> <span class="comment"># è¿”å›</span></span><br><span class="line">END(tlb_out)</span><br></pre></td></tr></table></figure><h2 id="Thinking-A-1"><a href="#Thinking-A-1" class="headerlink" title="Thinking A.1"></a>Thinking A.1</h2><p>ä¸‰çº§é¡µè¡¨é¡µç›®å½•çš„åŸºåœ°å€<br><code>&#123;PTbase[38:30], PTbase[38:30], PTbase[38:30], 12&#39;h0&#125;</code></p><p>æ˜ å°„åˆ°é¡µç›®å½•è‡ªèº«çš„é¡µç›®å½•é¡¹ï¼ˆè‡ªæ˜ å°„ï¼‰<br><code>&#123;PTbase[38:30], PTbase[38:30], PTbase[38:30], PTbase[38:30], 3&#39;h0&#125;</code></p><h2 id="Thinking-2-6"><a href="#Thinking-2-6" class="headerlink" title="Thinking 2.6"></a>Thinking 2.6</h2><ol><li>CPU å‘å‡ºè®¿é—®æŒ‡ä»¤: ç”¨æˆ·è¿›ç¨‹æ‰§è¡Œå†…å­˜è®¿é—®ã€‚</li><li>æŸ¥è¯¢ TLB: ç¡¬ä»¶è‡ªåŠ¨æ‰§è¡Œã€‚</li><li>è§¦å‘ TLB Miss (No åˆ†æ”¯): ç¡¬ä»¶æ£€æµ‹åˆ° TLB æœªå‘½ä¸­ï¼Œè·³è½¬åˆ°å†…æ ¸ TLB Miss å¤„ç†ç¨‹åºã€‚</li><li>æ ¹æ®é¡µç›®å½•è¡¨å’Œè™šæ‹Ÿåœ°å€å¯»æ‰¾é¡µè¡¨é¡¹ &#x2F; ä»é¡µè¡¨ä¸­æŸ¥æ‰¾é¡µè¡¨é¡¹: ä¸»è¦ç”± <code>page_lookup</code> å‡½æ•°å®ç°ã€‚å®ƒéå†é¡µç›®å½•å’Œé¡µè¡¨ï¼ŒæŸ¥æ‰¾å¯¹åº”çš„é¡µè¡¨é¡¹ (PTE)ã€‚</li><li>é¡µç›®å½•é¡¹&#x2F;é¡µè¡¨é¡¹æ˜¯å¦æœ‰æ•ˆ:<ul><li>å¦ (No åˆ†æ”¯ - é¡µé¢&#x2F;é¡µè¡¨ä¸å­˜åœ¨æˆ–æ— æ•ˆ):<ul><li>åˆ†é…æ–°é¡µé¢&#x2F;é¡µè¡¨: å¯èƒ½æ¶‰åŠ <code>page_alloc</code> (åˆ†é…ç‰©ç†é¡µ) å’Œ <code>page_insert</code> (å»ºç«‹æ˜ å°„ï¼Œå¡«å†™ PTE)ã€‚<em>ï¼ˆæµç¨‹å›¾ç®€åŒ–äº†åˆ†é…é¡µè¡¨æœ¬èº«ï¼ŒLab2 ä¸»è¦å¤„ç†é¡µé¢çš„åˆ†é…å’Œæ’å…¥ï¼‰</em></li></ul></li><li>æ˜¯ (Yes åˆ†æ”¯ - æ‰¾åˆ°æœ‰æ•ˆ PTE): <code>page_lookup</code> æˆåŠŸè¿”å›æœ‰æ•ˆçš„ PTEã€‚</li></ul></li><li>å–å‡ºç‰©ç†é¡µå· PPN â€¦ å†™å…¥ TLB: ç”± <code>_do_tlb_refill</code> å‡½æ•°åœ¨ <code>page_lookup</code> æˆåŠŸåï¼Œè¯»å– PTE ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨ç‰¹å®š CPU æŒ‡ä»¤å°†æ˜ å°„å…³ç³»å†™å…¥ç¡¬ä»¶ TLBã€‚</li><li>é‡æ–°è®¿é—® &#x2F; è¯»å–åˆ° PPN ç»“åˆ offset å®Œæˆè®¿é—® (Yes åˆ†æ”¯): TLB refill å®Œæˆåï¼ŒæŒ‡ä»¤é‡æ–°æ‰§è¡Œï¼Œæ­¤æ—¶ TLB Hitï¼Œç¡¬ä»¶ä½¿ç”¨ TLB ä¸­çš„ PPN å®Œæˆåœ°å€ç¿»è¯‘å’Œè®¿é—®ã€‚</li></ol><p><strong>æ ¸å¿ƒå…³ç³»</strong>: Lab2 ä¸­çš„ <code>do_tlb_refill</code>ã€<code>page_lookup</code>ã€<code>page_alloc</code>ã€<code>page_insert</code> ç­‰å‡½æ•°å…±åŒæ„æˆäº† CPU è®¿é—®æµç¨‹å›¾ä¸­ <strong>TLB Miss å‘ç”Ÿåç”±è½¯ä»¶æ‰§è¡Œçš„é¡µè¡¨æŸ¥æ‰¾ã€é¡µé¢åˆ†é…ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€é¡µè¡¨æ›´æ–°ä»¥åŠæœ€ç»ˆå¡«å…… TLB çš„å¤„ç†é€»è¾‘</strong>ã€‚</p><h2 id="Thinking-2-7"><a href="#Thinking-2-7" class="headerlink" title="Thinking 2.7"></a>Thinking 2.7</h2><ul><li>X86 ä½“ç³»ç»“æ„ä¸­çš„å†…å­˜ç®¡ç†æœºåˆ¶<ul><li>é€šè¿‡åˆ†æ®µå°†é€»è¾‘åœ°å€è½¬æ¢ä¸ºçº¿æ€§åœ°å€ï¼Œé€šè¿‡åˆ†é¡µå°†çº¿æ€§åœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚</li><li>é€»è¾‘åœ°å€ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯æ®µé€‰æ‹©å™¨ï¼Œä¸€éƒ¨åˆ†æ˜¯åç§»ã€‚</li><li>æ®µé€‰æ‹©ç¬¦å­˜æ”¾åœ¨æ®µå¯„å­˜å™¨ä¸­ï¼Œå¦‚CSï¼ˆå­˜æ”¾ä»£ç æ®µé€‰æ‹©ç¬¦ï¼‰ã€SSï¼ˆå­˜æ”¾å †æ ˆæ®µé€‰æ‹©ç¬¦ï¼‰ã€DSï¼ˆå­˜æ”¾æ•°æ®æ®µé€‰æ‹©ç¬¦ï¼‰å’ŒESã€FSã€GSï¼ˆä¸€èˆ¬ä¹Ÿç”¨æ¥å­˜æ”¾æ•°æ®æ®µé€‰æ‹©ç¬¦ï¼‰ç­‰ï¼›</li><li>åç§»ä¸å¯¹åº”æ®µæè¿°ç¬¦ä¸­çš„åŸºåœ°å€ç›¸åŠ å°±æ˜¯çº¿æ€§åœ°å€ã€‚</li><li>æ“ä½œç³»ç»Ÿåˆ›å»ºå…¨å±€æè¿°ç¬¦è¡¨å’Œæä¾›é€»è¾‘åœ°å€ï¼Œä¹‹åçš„åˆ†æ®µæ“ä½œx86çš„CPUä¼šè‡ªåŠ¨å®Œæˆï¼Œå¹¶æ‰¾åˆ°å¯¹åº”çš„çº¿æ€§åœ°å€ã€‚</li><li>ä»çº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢æ˜¯CPUè‡ªåŠ¨å®Œæˆçš„ï¼Œè½¬åŒ–æ—¶ä½¿ç”¨çš„Page Directoryå’ŒPage Tableç­‰éœ€è¦æ“ä½œç³»ç»Ÿæä¾›ã€‚</li></ul></li><li>X86 å’Œ MIPS åœ¨å†…å­˜ç®¡ç†ä¸Šçš„åŒºåˆ«<ul><li>TLBä¸å‘½ä¸­ï¼š<ul><li>MIPSè§¦å‘TLBç¼ºå¤±å’Œå……å¡«ï¼Œç„¶åCPUé‡æ–°è®¿é—®TLB</li><li>x86ç¡¬ä»¶MMUç´¢å¼•è·å¾—é¡µæ¡†å·ï¼Œç›´æ¥è¾“å‡ºç‰©ç†åœ°å€ï¼ŒMMUå……å¡«TLBåŠ å¿«ä¸‹æ¬¡è®¿é—®é€Ÿåº¦</li></ul></li><li>åˆ†é¡µæ–¹å¼ä¸åŒï¼š<ul><li>ä¸€ç§MIPSç³»ç»Ÿå†…éƒ¨åªæœ‰ä¸€ç§åˆ†é¡µæ–¹å¼</li><li>x86çš„CPUæ”¯æŒä¸‰ç§åˆ†é¡µæ¨¡å¼</li></ul></li><li>é€»è¾‘åœ°å€ä¸åŒï¼š<ul><li>MIPSåœ°å€ç©ºé—´32ä½</li><li>x86æ”¯æŒ64ä½é€»è¾‘åœ°å€ï¼ŒåŒæ—¶æä¾›è½¬æ¢ä¸º32ä½å®šå€é€‰é¡¹</li></ul></li><li>æ®µé¡µå¼çš„ä¸åŒï¼š<ul><li>MIPSåŒæ—¶åŒ…å«äº†æ®µå’Œæ®µé¡µå¼ä¸¤ç§åœ°å€ä½¿ç”¨æ–¹å¼</li><li>åœ¨x86æ¶æ„çš„ä¿æŠ¤æ¨¡å¼ä¸‹çš„å†…å­˜ç®¡ç†ä¸­ï¼Œåˆ†æ®µæ˜¯å¼ºåˆ¶çš„ï¼Œå¹¶ä¸èƒ½å…³é—­ï¼Œè€Œåˆ†é¡µæ˜¯å¯é€‰çš„ï¼›</li></ul></li></ul></li></ul><h1 id="å®éªŒéš¾ç‚¹"><a href="#å®éªŒéš¾ç‚¹" class="headerlink" title="å®éªŒéš¾ç‚¹"></a>å®éªŒéš¾ç‚¹</h1><ul><li><p>ç‰©ç†å†…å­˜ç®¡ç†éƒ¨åˆ†ï¼Œæˆ‘æ„Ÿè§‰éš¾åº¦ç›¸å¯¹é€‚ä¸­ã€‚ä¸»è¦ä»»åŠ¡æ˜¯å¡«å……é“¾è¡¨å®å®šä¹‰å’Œå®ç°å‡ ä¸ªå…³é”®å‡½æ•°ã€‚</p><ul><li>é“¾è¡¨å®ï¼šè¿™éƒ¨åˆ†çš„å…³é”®åœ¨äºç†è§£åŒå‘é“¾è¡¨çš„åŸç†ã€‚è™½ç„¶å¡«å……æœ¬èº«ä¸éš¾ï¼Œä½†åœ¨åŠ¨æ‰‹å‰éœ€è¦ä»”ç»†é˜…è¯»å¤šä¸ªç›¸å…³æ–‡ä»¶ä¸­çš„ä»£ç ï¼Œå¹¶ç»“åˆå·²æœ‰çš„å®å®šä¹‰ï¼Œæ‰èƒ½å‡†ç¡®æŠŠæ¡ä¼ å…¥å‚æ•°çš„å«ä¹‰ã€‚</li><li>å‡½æ•°å®ç°ï¼šè¿™éƒ¨åˆ†åˆ™è¦æ±‚å¯¹å„ä¸ªå˜é‡é—´çš„é€»è¾‘å…³ç³»æœ‰æ¸…æ™°çš„è®¤è¯†ï¼Œç‰¹åˆ«æ˜¯è¦ç†è§£ ROUND å‡½æ•°çš„ä½œç”¨ä»¥åŠé¡µæ§åˆ¶å—ï¼ˆPage Control Blockï¼‰åŠå…¶å†…éƒ¨å˜é‡çš„æ„ä¹‰ã€‚åªè¦ç†è§£äº†è¿™äº›ï¼Œä¾ç…§ä»£ç æ³¨é‡Šä¸­çš„æç¤ºæ¥å®Œæˆå®ç°è¿˜æ˜¯æ¯”è¾ƒé¡ºåˆ©çš„ã€‚</li></ul></li><li><p>è™šæ‹Ÿå†…å­˜ç®¡ç†éƒ¨åˆ†ï¼Œæ•´ä½“éš¾åº¦ä¹Ÿæ„Ÿè§‰ä¸ç®—å¤ªé«˜ã€‚</p><ul><li>æ ¸å¿ƒåœ¨äºæŒæ¡äºŒçº§é¡µè¡¨çš„å·¥ä½œæœºåˆ¶ï¼Œå¹¶ç†Ÿæ‚‰ç›¸å…³çš„å®å®šä¹‰å’Œå‡½æ•°è°ƒç”¨æ–¹æ³•ã€‚</li></ul></li><li><p>TLB é‡å¡«éƒ¨åˆ†ï¼Œéœ€è¦ç¼–å†™çš„ä»£ç é‡ä¸å¤§ã€‚åŸºæœ¬ä¸Šæ˜¯æ ¹æ®ä»£ç æ³¨é‡Šçš„è¦æ±‚ï¼ŒæŒ‰éƒ¨å°±ç­åœ°å®ŒæˆæŒ‡å®šçš„æ“ä½œå³å¯ã€‚</p></li></ul><p>æ€»çš„æ¥è¯´ï¼Œè¿™æ¬¡å®éªŒåŠ æ·±äº†æˆ‘å¯¹æ“ä½œç³»ç»Ÿå†…å­˜ç®¡ç†æœºåˆ¶çš„ç†è§£ï¼Œå°¤å…¶æ˜¯åœ¨äºŒçº§é¡µè¡¨å’Œåœ°å€è½¬æ¢çš„æ¦‚å¿µä¸Šæœ‰äº†æ›´æ¸…æ™°çš„è®¤è¯†ï¼Œå°½ç®¡ä¸­é—´ä¹Ÿé‡åˆ°äº†ä¸€äº›ç†è§£ä¸Šçš„æŒ‘æˆ˜ã€‚</p><h1 id="å®éªŒä½“ä¼š"><a href="#å®éªŒä½“ä¼š" class="headerlink" title="å®éªŒä½“ä¼š"></a>å®éªŒä½“ä¼š</h1><p>é¢å¯¹åºå¤§çš„ç°æœ‰ä»£ç åº“ï¼Œæˆ‘æœ€åˆæ„Ÿåˆ°æœ‰äº›ä¸çŸ¥æ‰€æªï¼Œç›´æ¥ä¸Šæ‰‹å®Œæˆä»»åŠ¡ç¡®å®å›°éš¾ã€‚ç”±äº Lab 2 çš„è¯¾ä¸‹ä½œä¸šå¼€å§‹å¾—æ¯”è¾ƒæ™šï¼Œæ—¶é—´ç´§è¿«ï¼Œæˆ‘é‡‡å–äº†å…ˆå¿«é€Ÿæµè§ˆä¸€éï¼Œç„¶åå°±å‚ç…§æç¤ºæˆ–æ¨¡ä»¿ä¸Šä¸‹æ–‡ä»£ç æ¥å¡«å……ç©ºç™½çš„ç­–ç•¥ã€‚è¿™ç§â€œä¾æ ·ç”»è‘«èŠ¦â€çš„æ–¹å¼è™½ç„¶è®©æˆ‘è¾ƒå¿«åœ°å®Œæˆäº†ä»»åŠ¡ï¼Œä½†æ˜æ˜¾æ„Ÿè§‰åˆ°è‡ªå·±å¯¹ä»£ç çš„ç†è§£å¹¶ä¸æ·±å…¥ã€‚<br>æ„è¯†åˆ°è¿™ä¸€ç‚¹åï¼Œåœ¨å®Œæˆç»ƒä¹ ä¹‹åï¼Œæˆ‘ç‰¹æ„æŠ•å…¥äº†å¤§åŠå¤©çš„æ—¶é—´ã€‚æˆ‘ç»“åˆæŒ‡å¯¼ä¹¦ï¼Œä»å¤´åˆ°å°¾ä»”ç»†ç ”è¯»äº† pmap.c æ–‡ä»¶ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°å®ç°ã€‚åŒæ—¶ï¼Œæˆ‘ä¹Ÿæ›´ç»†è‡´åœ°æŸ¥çœ‹äº†ç›¸å…³çš„å¤´æ–‡ä»¶ï¼Œè¿™ä¸ä»…åŠ æ·±äº†æˆ‘å¯¹ C è¯­è¨€å®å®šä¹‰çš„ç†è§£ï¼Œä¹Ÿè®©æˆ‘å¯¹æ¯ä¸ªå‡½æ•°çš„åŠŸèƒ½å’Œå®ç°é€»è¾‘æœ‰äº†æ›´æ¸…æ™°çš„è®¤è¯†ï¼Œå¹¶ä¸ºå®ƒä»¬æ·»åŠ äº†è‡ªå·±çš„æ³¨é‡Šã€‚åœ¨è¿™ä¸ªæ·±å…¥é˜…è¯»å’Œæ€è€ƒçš„è¿‡ç¨‹ä¸­ï¼Œè®¸å¤šä¹‹å‰æ¨¡ç³Šä¸æ¸…çš„åœ°æ–¹è±ç„¶å¼€æœ—ï¼Œå¾—åˆ°äº†åˆç†çš„è§£é‡Šã€‚åæ¥é€šè¿‡ä¸åŒå­¦ä»¬çš„äº¤æµè®¨è®ºï¼Œæˆ‘å¯¹ä»£ç ç»†èŠ‚å’Œå†…å­˜ç®¡ç†æœºåˆ¶çš„ç†è§£åˆå¾—åˆ°äº†è¿›ä¸€æ­¥çš„å·©å›ºå’Œæ·±åŒ–ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘ä¼šæ„å»ºå¥å£®çš„å¤šçº¿ç¨‹ç”µæ¢¯è¯„æµ‹æœº</title>
      <link href="/2025/04/08/%E6%88%91%E4%BC%9A%E6%9E%84%E5%BB%BA%E5%81%A5%E5%A3%AE%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%94%B5%E6%A2%AF%E8%AF%84%E6%B5%8B%E6%9C%BA/%E6%88%91%E4%BC%9A%E6%9E%84%E5%BB%BA%E5%81%A5%E5%A3%AE%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%94%B5%E6%A2%AF%E8%AF%84%E6%B5%8B%E6%9C%BA/"/>
      <url>/2025/04/08/%E6%88%91%E4%BC%9A%E6%9E%84%E5%BB%BA%E5%81%A5%E5%A3%AE%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%94%B5%E6%A2%AF%E8%AF%84%E6%B5%8B%E6%9C%BA/%E6%88%91%E4%BC%9A%E6%9E%84%E5%BB%BA%E5%81%A5%E5%A3%AE%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%94%B5%E6%A2%AF%E8%AF%84%E6%B5%8B%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æˆ‘ä¼šæ„å»ºå¥å£®çš„å¤šçº¿ç¨‹ç”µæ¢¯è¯„æµ‹æœº-smiley"><a href="#æˆ‘ä¼šæ„å»ºå¥å£®çš„å¤šçº¿ç¨‹ç”µæ¢¯è¯„æµ‹æœº-smiley" class="headerlink" title="æˆ‘ä¼šæ„å»ºå¥å£®çš„å¤šçº¿ç¨‹ç”µæ¢¯è¯„æµ‹æœº:smiley:"></a>æˆ‘ä¼šæ„å»ºå¥å£®çš„å¤šçº¿ç¨‹ç”µæ¢¯è¯„æµ‹æœº:smiley:</h1><p>å·²åŒæ­¥æ›´æ–°è‡³æœ¬äººblogï¼Œæ¬¢è¿å¤§å®¶æ¥å‚è§‚:blush:</p><p>å¯¹äºåƒç”µæ¢¯è¿™æ ·çš„å¤æ‚çš„ã€è¡Œä¸ºä¸ç¡®å®šçš„å¹¶å‘ç³»ç»Ÿï¼Œ<strong>æ„å»ºè‡ªåŠ¨åŒ–ã€ç³»ç»ŸåŒ–ã€èƒ½å¤Ÿè¿›è¡ŒçŠ¶æ€è·Ÿè¸ªå’Œè§„åˆ™æ£€æŸ¥çš„æµ‹è¯•æ¡†æ¶ï¼Œæ˜¯ç¡®ä¿ç¨‹åºæ­£ç¡®æ€§ã€æé«˜å¼€å‘æ•ˆç‡çš„å¿…å¤‡æ‰‹æ®µ</strong>ã€‚ç›´æ¥æ‰‹åŠ¨æµ‹è¯•è¦†ç›–é¢æœ‰é™ï¼Œä¸”éš¾ä»¥å¤ç°å¹¶å‘é—®é¢˜ã€‚å› æ­¤ï¼Œæ„å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–çš„ã€èƒ½å¤Ÿç”Ÿæˆæœ‰å¼ºåº¦æ•°æ®çš„ã€èƒ½å¤Ÿç²¾ç¡®åˆ¤å®šæ­£ç¡®æ€§çš„è¯„æµ‹æœºå°±æ˜¾å¾—å°¤ä¸ºå¿…è¦ã€‚<del>åŒå­¦ï¼Œä½ ä¹Ÿä¸æƒ³ä½ çš„ä»£ç è¢«æˆ‘ä»¬hackå§</del></p><p>åœ¨ç»å†äº† HW5 åˆ° HW6 çš„è¿­ä»£åï¼Œç”µæ¢¯ç³»ç»Ÿçš„è§„åˆ™å˜å¾—æ›´åŠ å¤æ‚ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘å’Œèˆå‹åˆåŠ›æ­å»ºäº†ä¸€å¥—åŸºäº Python çš„è‡ªåŠ¨åŒ–è¯„æµ‹æ¡†æ¶ï¼Œå¸Œæœ›èƒ½è¾ƒä¸ºå…¨é¢åœ°æµ‹è¯•ç”µæ¢¯ç¨‹åºçš„å¥å£®æ€§å’Œæ€§èƒ½ã€‚ç»è¿‡äº†ä¸€æ¬¡è¿­ä»£ï¼Œè¯¥è¯„æµ‹æœºçš„æ€§èƒ½å’Œæ­£ç¡®æ€§èƒ½å¤Ÿåšåˆ°æ›´ä¼˜ã€‚åœ¨æ­¤ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€ä¸‹è¿™å¥—è¯„æµ‹æœºçš„æ ¸å¿ƒæ€è·¯å’Œå®ç°ç»†èŠ‚ï¼Œå¸Œæœ›èƒ½ä¸ºå¤§å®¶æä¾›ä¸€äº›å‚è€ƒ</p><h2 id="ä¸€ã€-æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ"><a href="#ä¸€ã€-æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ" class="headerlink" title="ä¸€ã€ æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ"></a>ä¸€ã€ æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ</h2><p>æˆ‘ä»¬çš„è¯„æµ‹æœºä¸»è¦ç”±ä»¥ä¸‹ Python è„šæœ¬æ„æˆï¼š</p><ol><li><p><strong><code>generate_data.py</code></strong>: è´Ÿè´£ç”Ÿæˆç¬¦åˆè¦æ±‚çš„ã€å…·æœ‰ä¸åŒä¾§é‡ç‚¹å’Œå¼ºåº¦çš„æµ‹è¯•è¾“å…¥æ•°æ® (<code>stdin.txt</code>)ï¼ŒåŒ…æ‹¬ä¹˜å®¢è¯·æ±‚å’Œä¸´æ—¶è°ƒåº¦ (SCHE) è¯·æ±‚</p></li><li><p><strong><code>validator.py</code></strong>: æ ¸å¿ƒéªŒè¯é€»è¾‘æ‰€åœ¨ã€‚å®ƒè¯»å–è¾“å…¥æ•°æ®ï¼Œæ¨¡æ‹Ÿç”µæ¢¯ç³»ç»Ÿçš„é¢„æœŸè¡Œä¸ºï¼Œå¹¶é€è¡Œè§£æã€éªŒè¯ç¨‹åºçš„è¾“å‡º (<code>stdout</code>) æ˜¯å¦ç¬¦åˆæŒ‡å¯¼ä¹¦çš„æ‰€æœ‰æ­£ç¡®æ€§çº¦æŸï¼ˆæ—¶åºã€çŠ¶æ€ã€è§„åˆ™ç­‰ï¼‰</p></li><li><p><strong><code>run_test.py</code></strong>: æµ‹è¯•æµç¨‹çš„â€œæŒ‡æŒ¥å®˜â€ã€‚å®ƒè´Ÿè´£è°ƒç”¨æ•°æ®ç”Ÿæˆå™¨ã€åœ¨éš”ç¦»ç¯å¢ƒä¸­æ‰§è¡ŒåŒå­¦ä»¬çš„ Java ç¨‹åºï¼ˆé€šè¿‡å®˜æ–¹æä¾›çš„ <code>datainput.exe</code> å’Œ <code>java</code> å‘½ä»¤ï¼‰ã€æ•è·è¾“å‡ºã€è°ƒç”¨éªŒè¯å™¨è¿›è¡Œåˆ¤å®šï¼Œå¹¶æœ€ç»ˆæ±‡æ€»ã€æŠ¥å‘Šæµ‹è¯•ç»“æœ</p></li><li><p>**<code>run_elevator_tests.bat</code> **: ä¸€ä¸ªç®€å•çš„å¯åŠ¨è„šæœ¬ï¼Œæ–¹ä¾¿ä¸€é”®è¿è¡Œ</p><p><img src="/img/Elevator-tester/composition.png" alt="æ ¸å¿ƒç»„ä»¶"></p></li></ol><h2 id="äºŒã€-æ•°æ®ç”Ÿæˆç­–ç•¥-generate-data-py"><a href="#äºŒã€-æ•°æ®ç”Ÿæˆç­–ç•¥-generate-data-py" class="headerlink" title="äºŒã€ æ•°æ®ç”Ÿæˆç­–ç•¥ (generate_data.py)"></a>äºŒã€ æ•°æ®ç”Ÿæˆç­–ç•¥ (<code>generate_data.py</code>)</h2><p>ç”Ÿæˆé«˜è´¨é‡çš„æµ‹è¯•æ•°æ®æ˜¯è¯„æµ‹æœ‰æ•ˆæ€§çš„åŸºç¡€ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦†ç›–å„ç§è¾¹ç•Œæƒ…å†µå’Œå‹åŠ›åœºæ™¯:smiling_imp:</p><p>è¿™æ˜¯ä¿è¯æˆ‘ä»¬è¯„æµ‹æœºå¼ºåº¦çš„æ ¸å¿ƒäº†ã€‚ä¹‹å‰æˆ‘åœ¨é«˜å¼ºåº¦æ°´ç¾¤çš„æ—¶å€™å‘ç°ï¼ŒæŸä½åŒå­¦è¯´taçš„è¯„æµ‹æœºè·‘äº†ä¸€æ•´å¤©å…¨æ˜¯AC </p><p>é‚£å½“ç„¶æ˜¯æµ‹è¯•ç‚¹å¼ºåº¦è¿˜ä¸å¤Ÿå•¦ï¼å°½ç®¡æ˜¯éšæœºç”Ÿæˆï¼Œæˆ‘ä»¬ä¹Ÿè¦æœ‰ç­–ç•¥ã€æœ‰ä¾§é‡ç‚¹åœ°éšæœºç”Ÿæˆï¼Œä¸ç»™ç‚¹å‹åŠ›ï¼Œä½ æ€ä¹ˆçŸ¥é“ä»£ç ä¼šä¸ä¼šå®æ‰å‘¢ï¼Ÿ<del>å˜»å˜»</del></p><p><strong>æ ¸å¿ƒæ€è·¯ï¼šåˆ†é˜¶æ®µã€æœ‰ä¾§é‡åœ°ç”Ÿæˆè¯·æ±‚ã€‚</strong></p><p>æˆ‘ä»¬å°†æ€»çš„æ¨¡æ‹Ÿæ—¶é—´ï¼ˆå…¬æµ‹çº¦ 60s+ï¼Œäº’æµ‹ 50sï¼‰åˆ’åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µæŠ•æ”¾ä¸åŒç‰¹ç‚¹çš„è¯·æ±‚ï¼š</p><ul><li><strong>é˜¶æ®µä¸€ (0% - 15% æ—¶é—´, ~10% è¯·æ±‚): ç¨€ç–è¯•æ¢</strong><ul><li><strong>ç›®çš„</strong>: æ¨¡æ‹Ÿç³»ç»Ÿå¯åŠ¨åˆæœŸæˆ–ä½å³°æœŸï¼Œè¯·æ±‚é›¶æ•£</li><li><strong>å†…å®¹</strong>: ç”Ÿæˆå°‘é‡ä¹˜å®¢è¯·æ±‚ï¼Œä¼˜å…ˆçº§éšæœºåä½ï¼Œå¹¶å¤¹æ‚å°‘é‡ SCHE è¯·æ±‚ã€‚æµ‹è¯•ç”µæ¢¯çš„å¯åŠ¨ã€åŸºæœ¬å¯»è·¯å’Œ SCHE å“åº”èƒ½åŠ›</li></ul></li><li><strong>é˜¶æ®µäºŒ (15% - 50% æ—¶é—´, ~40% è¯·æ±‚): å¯†é›†å‹åŠ› I</strong><ul><li><strong>ç›®çš„</strong>: æ¨¡æ‹Ÿé«˜å³°æœŸï¼Œæµ‹è¯•ç³»ç»Ÿçš„ååèƒ½åŠ›å’Œè°ƒåº¦ç­–ç•¥åœ¨é«˜è´Ÿè½½ä¸‹çš„è¡¨ç°ï¼Œ<del>å°±å¥½æ¯”ä¸‹è¯¾æ—¶é—´å¤§å®¶èœ‚æ‹¥å»é£Ÿå ‚</del></li><li><strong>å†…å®¹</strong>: å¤§é‡ä¹˜å®¢è¯·æ±‚æ¶Œå…¥ï¼Œæ—¶é—´æˆ³<strong>ç›¸è¿‘</strong>æˆ–<strong>ç›¸åŒ</strong>ã€‚ä¹˜å®¢è¯·æ±‚å¯èƒ½è·¨åº¦è¾ƒå¤§ã€‚ä¹ŸåŒ…å«ä¸€äº› SCHE è¯·æ±‚ï¼Œæµ‹è¯•è°ƒåº¦ä¸­æ–­å’Œæ¢å¤èƒ½åŠ›</li></ul></li><li><strong>é˜¶æ®µä¸‰ (50% - 75% æ—¶é—´, ~20% è¯·æ±‚): è¾¹ç•Œä¸ç‰¹æ®Šåœºæ™¯</strong><ul><li><strong>ç›®çš„</strong>: ä¸“é—¨æµ‹è¯•æŒ‡å¯¼ä¹¦ä¸­æåˆ°çš„æˆ–å®¹æ˜“å‡ºé”™çš„è¾¹ç•Œæƒ…å†µ</li><li><strong>å†…å®¹</strong>:<ul><li><strong>æç«¯è·ç¦»</strong>: å¦‚ B4 &lt;-&gt; F7ã€‚</li><li><strong>è·¨é›¶å±‚</strong>: å¦‚ B1 &lt;-&gt; F1ã€‚</li><li><strong>çŸ­è·ç¦»</strong>: ç›¸é‚»æ¥¼å±‚ã€‚</li><li><strong>SCHE è¾¹ç•Œ</strong>: æµ‹è¯• SCHE è¯·æ±‚ä¸æ™®é€šè¯·æ±‚çš„äº¤äº’ã€SCHE çš„å¿«é€Ÿå“åº”ã€SCHE æœŸé—´ä¹˜å®¢å¤„ç†ã€å®Œæˆ SCHE éœ€è¦çš„æ€»æ—¶é—´ç­‰ã€‚ç”Ÿæˆ SCHE è¯·æ±‚æ—¶ï¼Œä¼šä¿å®ˆä¼°è®¡ä¸Šä¸€ä¸ª SCHE çš„å®Œæˆæ—¶é—´ï¼Œç¡®ä¿ä¸¤æ¬¡ SCHE ä¹‹é—´æœ‰è¶³å¤Ÿé—´éš”</li></ul></li></ul></li><li><strong>é˜¶æ®µå›› (75% - 100% æ—¶é—´, ~30% è¯·æ±‚): ä¼˜å…ˆçº§ä¸å¯†é›†å‹åŠ› II</strong><ul><li><strong>ç›®çš„</strong>: æµ‹è¯•è°ƒåº¦ç­–ç•¥å¯¹ä¼˜å…ˆçº§çš„å“åº”ï¼Œä»¥åŠåœ¨æ¥è¿‘ç»“æŸæ—¶å¤„ç†å‰©ä½™è¯·æ±‚çš„èƒ½åŠ›ã€‚å¾ˆå¤šåŒå­¦æƒ³å¿…éƒ½å¯¹ä¼˜å…ˆçº§è¿›è¡Œè¿‡ä¼˜åŒ–ï¼Œé‚£ä¹ˆè‡ªç„¶è¦æœ‰é’ˆå¯¹æ€§çš„æ‰¾é—®é¢˜ï¼Œ<del>æ¡€æ¡€æ¡€</del></li><li><strong>å†…å®¹</strong>: ç”Ÿæˆå¤§é‡åŒæ—¶é—´æˆ³è¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚ä¸­æœ‰æé«˜ä¼˜å…ˆçº§ (80-100) å’Œæä½ä¼˜å…ˆçº§ (1-10) çš„è¯·æ±‚ï¼Œé›†ä¸­hackåŒå­¦ä»¬é’ˆå¯¹ä¼˜å…ˆçº§ä¼˜åŒ–çš„åœ°æ–¹ã€‚åŒæ—¶ä¿æŒä¸€å®šçš„è¯·æ±‚å¯†åº¦ã€‚ä¹ŸåŒ…å« SCHE è¯·æ±‚</li></ul></li></ul><p><strong>å…¶ä»–ç”Ÿæˆç»†èŠ‚:</strong></p><ul><li><strong>äº’æµ‹æ¨¡å¼çº¦æŸ</strong>: å½“æ£€æµ‹åˆ°æ˜¯äº’æµ‹æ¨¡å¼æ—¶ï¼š<ul><li>æœ€å¤§æ•°æ®æŠ•å–‚æ—¶é—´å¼ºåˆ¶è®¾ä¸º 50s</li><li>æ€»è¯·æ±‚æ•°ï¼ˆä¹˜å®¢ + SCHEï¼‰ä¸¥æ ¼æ§åˆ¶åœ¨ 70 æ¡ä»¥å†…</li><li>æ¯éƒ¨ç”µæ¢¯çš„ SCHE è¯·æ±‚æ•°ä¸¥æ ¼æ§åˆ¶åœ¨ 1 æ¬¡ä»¥å†…</li></ul></li><li><strong>æ—¶é—´æˆ³</strong>:<ul><li>ä¿è¯ç¬¬ä¸€æ¡æŒ‡ä»¤ <code>&gt;= 1.0s</code></li><li>ä½¿ç”¨æ’å…¥å¹¶æœ€åæ’åºï¼Œç¡®ä¿è¾“å…¥æ–‡ä»¶ä¸­çš„ç²¾ç¡®æ—¶é—´æˆ³<strong>éé€’å‡</strong></li><li>åœ¨æœ€ç»ˆè¾“å‡ºåˆ° <code>stdin.txt</code> æ—¶ï¼Œæ£€æŸ¥ç¡®ä¿æ ¼å¼åŒ–åçš„æ—¶é—´æˆ³ä¹Ÿæ˜¯<strong>éé€’å‡</strong>çš„ï¼ˆé€šè¿‡ä¸ä¸Šä¸€ä¸ªè¾“å‡ºçš„æ—¶é—´æˆ³æ¯”è¾ƒè°ƒæ•´ï¼‰</li><li>æ·»åŠ å¾®å°éšæœºæ‰°åŠ¨ï¼Œé¿å…å¤§é‡å®Œå…¨ç›¸åŒçš„æ—¶é—´æˆ³</li></ul></li></ul><h2 id="ä¸‰ã€-æ­£ç¡®æ€§åˆ¤å®š-validator-py"><a href="#ä¸‰ã€-æ­£ç¡®æ€§åˆ¤å®š-validator-py" class="headerlink" title="ä¸‰ã€ æ­£ç¡®æ€§åˆ¤å®š (validator.py)"></a>ä¸‰ã€ æ­£ç¡®æ€§åˆ¤å®š (<code>validator.py</code>)</h2><p>è¿™æ˜¯è¯„æµ‹æœºçš„æ ¸å¿ƒå’Œæœ€å¤æ‚çš„éƒ¨åˆ†ã€‚å®ƒçš„è¿è¡Œæ€è·¯æ˜¯<strong>åŸºäºå­¦ç”Ÿç¨‹åºçš„è¾“å‡ºæ—¥å¿—ï¼Œç²¾ç¡®æ¨¡æ‹Ÿç”µæ¢¯å’Œä¹˜å®¢çš„çŠ¶æ€å˜åŒ–ï¼Œå¹¶æ ¹æ®æŒ‡å¯¼ä¹¦çš„æ‰€æœ‰è§„åˆ™è¿›è¡Œæ ¡éªŒ</strong>ï¼Œ<del>å½“ç„¶ï¼Œè¿™ä¹Ÿæ˜¯å’Œå¤§æ¨¡å‹ç»è¿‡æ·±åˆ»äº¤æµåè¯ç”Ÿçš„</del></p><p><strong>æ ¸å¿ƒæ€è·¯ï¼šçŠ¶æ€æœºæ¨¡æ‹Ÿ + è§„åˆ™æ ¡éªŒ</strong></p><ol><li><p><strong>çŠ¶æ€å»ºæ¨¡</strong>:</p><ul><li><code>PassengerState</code><strong>ä¹˜å®¢çŠ¶æ€</strong>: è®°å½•æ¯ä¸ªä¹˜å®¢çš„ ID, ä¼˜å…ˆçº§, èµ·æ­¢æ¥¼å±‚, è¯·æ±‚æ—¶é—´, <strong>å½“å‰ä½ç½®</strong>, å½“å‰çŠ¶æ€, <strong>æ‰€åœ¨ç”µæ¢¯</strong>, ä»¥åŠ<strong>è¢«å“ªä¸ªç”µæ¢¯æ¥æ”¶</strong></li><li><code>ElevatorState</code><strong>ç”µæ¢¯çŠ¶æ€</strong>: è®°å½•ç”µæ¢¯ ID, å½“å‰æ¥¼å±‚, é—¨çŠ¶æ€, <strong>è½¿å¢å†…ä¹˜å®¢é›†åˆ</strong>, <strong>å·²æ¥æ”¶å¾…å¤„ç†ä¹˜å®¢é›†åˆ</strong>, å½“å‰é€Ÿåº¦, <strong>è°ƒåº¦çŠ¶æ€</strong>, ä¸´æ—¶è°ƒåº¦ä¿¡æ¯, ä»¥åŠ<strong>ä¸Šæ¬¡åŠ¨ä½œå®Œæˆæ—¶é—´</strong> ç”¨äºæ—¶åºæ£€æŸ¥ã€‚</li></ul></li><li><p><strong>è¾“å‡ºè§£æ</strong>:</p><ul><li>é€è¡Œè¯»å– <code>stdout</code>ã€‚</li><li>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ç²¾ç¡®åŒ¹é…æ—¶é—´æˆ³å’Œäº‹ä»¶å†…å®¹ã€‚é‡‡ç”¨ <code>re.fullmatch</code> ç¡®ä¿å†…å®¹å®Œå…¨ç¬¦åˆé¢„æœŸæ ¼å¼ã€‚</li><li>è§£æå‡ºäº‹ä»¶ç±»å‹å’Œå‚æ•°ï¼ˆæ¥¼å±‚ã€IDã€é€Ÿåº¦ç­‰ï¼‰ï¼Œè¿›è¡ŒåŸºæœ¬ç±»å‹å’ŒèŒƒå›´æ£€æŸ¥ï¼ˆå¦‚æ¥¼å±‚æ˜¯å¦æœ‰æ•ˆï¼ŒID æ˜¯å¦åœ¨ 1-6ï¼‰ã€‚</li><li>æ—¶é—´æˆ³æ£€æŸ¥: å…¨å±€æ£€æŸ¥è¾“å‡ºæ—¶é—´æˆ³æ˜¯å¦éé€’å‡ã€‚</li></ul></li><li><p><strong>äº‹ä»¶éªŒè¯</strong>: è¿™ä¸ªæ˜¯æ­£ç¡®æ€§åˆ¤å®šçš„å…³é”®äº†ã€‚å¯¹æ¯ä¸ªè§£æå‡ºçš„äº‹ä»¶ï¼Œæ ¹æ®å½“å‰æ¨¡æ‹Ÿçš„ç³»ç»ŸçŠ¶æ€ï¼ˆæ‰€æœ‰ç”µæ¢¯å’Œä¹˜å®¢çš„çŠ¶æ€ï¼‰å’ŒæŒ‡å¯¼ä¹¦è§„åˆ™è¿›è¡Œæ£€æŸ¥ï¼š</p><ul><li><p><strong>åŸºæœ¬ç§»åŠ¨ (<code>ARRIVE</code>)</strong>:</p><ul><li>æ£€æŸ¥é—¨æ˜¯å¦å…³é—­</li><li>æ£€æŸ¥æ—¶é—´æ˜¯å¦æ»¡è¶³ <code>å½“å‰é€Ÿåº¦ * 1 å±‚</code> çš„è¦æ±‚ï¼ˆä¸ä¸Šæ¬¡åŠ¨ä½œå®Œæˆæ—¶é—´æ¯”è¾ƒï¼Œå…è®¸ä¸€å®šè¯¯å·®ï¼‰</li><li>æ£€æŸ¥ç§»åŠ¨æ˜¯å¦åˆæ³•ï¼ˆç›¸é‚»æ¥¼å±‚æˆ–è·¨é›¶å±‚ï¼‰</li><li>æ£€æŸ¥ç”µæ¢¯åœ¨ç©ºé—²æ—¶ï¼ˆæ— ä¹˜å®¢ã€æ— æ¥æ”¶ï¼‰æ˜¯å¦åœ¨ <code>RECEIVE</code> åæ‰ç§»åŠ¨ï¼ˆåŸºç¡€æ£€æŸ¥ï¼‰</li></ul></li><li><p><strong>å¼€å…³é—¨ (<code>OPEN</code>&#x2F;<code>CLOSE</code>)</strong>:</p><ul><li>æ£€æŸ¥å‰ç½®çŠ¶æ€<del>å¼€é—¨å‰å¿…é¡»å…³é—¨ï¼Œå…³é—¨å‰å¿…é¡»å¼€é—¨</del></li><li>æ£€æŸ¥æ˜¯å¦åœ¨å½“å‰æ¥¼å±‚æ“ä½œ</li><li>æ£€æŸ¥ <code>CLOSE</code> è·ç¦»å¯¹åº”çš„ <code>OPEN</code> æ˜¯å¦æ»¡è¶³æœ€å°å¼€é—¨æ—¶é—´ï¼ˆæ™®é€š <code>0.4s</code>ï¼ŒSCHE ç›®æ ‡å±‚ <code>1.0s</code>ï¼‰</li></ul></li><li><p><strong>è¿›å‡ºä¹˜å®¢ (<code>IN</code>&#x2F;<code>OUT</code>)</strong>:</p><ul><li>æ£€æŸ¥é—¨æ˜¯å¦æ‰“å¼€</li><li>æ£€æŸ¥æ˜¯å¦åœ¨ç”µæ¢¯å½“å‰æ¥¼å±‚</li><li><code>IN</code>: æ£€æŸ¥ç”µæ¢¯å®¹é‡æ˜¯å¦åˆæ³•ï¼›æ£€æŸ¥ä¹˜å®¢æ˜¯å¦åœ¨å½“å‰æ¥¼å±‚ï¼›<strong>æ£€æŸ¥ä¹˜å®¢æ˜¯å¦å·²è¢«è¯¥ç”µæ¢¯ <code>RECEIVE</code></strong>ï¼›<em>é‡è¦ï¼š<code>IN</code> åœ¨ç”µæ¢¯å¤„äºè°ƒåº¦çŠ¶æ€ä¸‹ç¦æ­¢</em>ã€‚</li><li><code>OUT</code>: æ£€æŸ¥ä¹˜å®¢æ˜¯å¦åœ¨è¯¥ç”µæ¢¯å†…éƒ¨ï¼›æ ¹æ® <code>OUT-S</code>&#x2F;<code>OUT-F</code> å’Œæ˜¯å¦åˆ°è¾¾ç›®çš„åœ°åˆ¤æ–­æ ‡å¿—æ˜¯å¦æ­£ç¡®</li><li>çŠ¶æ€æ›´æ–°ï¼šæ­£ç¡®æ›´æ–°ä¹˜å®¢çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬æ‰€å¤„æ¥¼å±‚æˆ–æ‰€å¤„ç”µæ¢¯ç­‰</li></ul></li><li><p><strong>æ¥æ”¶ (<code>RECEIVE</code>)</strong>:</p><ul><li><p>æ£€æŸ¥ä¹˜å®¢æ˜¯å¦å¤„äºç­‰å¾…ç”µæ¢¯çš„çŠ¶æ€ä¸­</p></li><li><p>æ£€æŸ¥ä¹˜å®¢æ˜¯å¦å·²è¢«<strong>å…¶ä»–</strong>ç”µæ¢¯æ¥æ”¶</p></li><li><p>æ£€æŸ¥æ˜¯å¦<strong>é‡å¤æ¥æ”¶</strong>åŒä¸€ä¹˜å®¢</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢æ˜¯åˆ¤å®šæ¥å—æˆåŠŸçš„éƒ¨åˆ†ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function validate_receive(event):</span><br><span class="line">passenger = get_passenger(event.person_id)</span><br><span class="line">elevator = get_elevator(event.elevator_id)</span><br><span class="line">is_sche_active = (elevator.scheduling_state == ACTIVE)</span><br><span class="line"></span><br><span class="line">if is_sche_active://ç”µæ¢¯ä»åœ¨SCHEä¸­</span><br><span class="line">    add_error(&quot;RECEIVE during SCHE ACTIVE&quot;)</span><br><span class="line">if passenger.state != WAITING: //ä¹˜å®¢ä¸å±äºç­‰å¾…çŠ¶æ€ï¼ˆæœªæŠ•å–‚è¯·æ±‚ã€å·²è¿›å…¥ç”µæ¢¯ç­‰ï¼‰</span><br><span class="line">    add_error(&quot;RECEIVE Passenger not WAITING&quot;)</span><br><span class="line">// å…³é”®ï¼šæ£€æŸ¥æ˜¯å¦å·²è¢«ä»»ä½•ç”µæ¢¯æ¥æ”¶ (åŒ…æ‹¬è‡ªå·±)</span><br><span class="line">if passenger.received_by_elevator != -1:</span><br><span class="line">     if passenger.received_by_elevator != event.elevator_id:</span><br><span class="line">         add_error(&quot;Passenger already received by another elevator&quot;)</span><br><span class="line">     else:</span><br><span class="line">         add_error(&quot;Duplicate RECEIVE by same elevator&quot;)</span><br><span class="line"></span><br><span class="line">// å¦‚æœæ£€æŸ¥é€šè¿‡:</span><br><span class="line">passenger.received_by_elevator = event.elevator_id</span><br><span class="line">elevator.received_passengers.add(event.person_id)</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ä¸´æ—¶è°ƒåº¦ (<code>SCHE-ACCEPT</code>, <code>SCHE-BEGIN</code>, <code>SCHE-END</code>)</strong>:</p><ul><li><code>SCHE-ACCEPT</code>: ä»è¾“å‡ºè§£æï¼Œæ›´æ–°ç”µæ¢¯çŠ¶æ€ä¸ºï¼Œè®°å½•è°ƒåº¦ä¿¡æ¯ï¼ˆå…è®¸è¦†ç›–ï¼‰ã€‚</li><li><code>SCHE-BEGIN</code>: æ£€æŸ¥ç”µæ¢¯æ˜¯å¦å¤„äºæ¥å—è°ƒåº¦çŠ¶æ€ï¼›æ£€æŸ¥é—¨æ˜¯å¦å…³é—­ï¼›æ£€æŸ¥ç”µæ¢¯æ˜¯å¦é™æ­¢ï¼›æ£€æŸ¥è·ç¦» <code>SCHE-ACCEPT</code> çš„ <code>ARRIVE</code> æ¬¡æ•° (<code>&lt;= 2</code>)ï¼›<strong>å…³é”®ï¼šå°†è¯¥ç”µæ¢¯æ‰€æœ‰çš„å·²ç»<code>RECEIVE</code>åˆ°çš„ä¹˜å®¢çŠ¶æ€è®¾ä¸ºæœªæ¥æ”¶ï¼Œå¹¶æ¸…ç©ºç”µæ¢¯çš„â€œå·²RECEIVEä¹˜å®¢â€é›†åˆ</strong>ï¼›è®¾ç½®çŠ¶æ€ä¸ºå¤„äºä¸´æ—¶è°ƒåº¦ä¸­ï¼Œæ›´æ–°è¿è¡Œé€Ÿåº¦ã€‚</li><li><code>SCHE-END</code>: <strong>æ£€æŸ¥ç”µæ¢¯æ˜¯å¦å¤„äºä¸´æ—¶è°ƒåº¦ä¸­</strong>ï¼›æ£€æŸ¥ç”µæ¢¯æ˜¯å¦åœ¨ç›®æ ‡æ¥¼å±‚ï¼›æ£€æŸ¥æ˜¯å¦ç©ºè½½ï¼›æ£€æŸ¥é—¨æ˜¯å¦ <code>CLOSED</code>ï¼›æ£€æŸ¥æ€»å“åº”æ—¶é—´ï¼ˆä¸èƒ½è¶…è¿‡6sï¼‰ï¼›æ£€æŸ¥ä¹‹å‰æ˜¯å¦æœ‰åˆæ³•çš„ <code>OPEN</code> -&gt; (ç­‰å¾…1s) -&gt; <code>CLOSE</code> åºåˆ—ï¼›è®¾ç½®çŠ¶æ€ä¸ºæ­£å¸¸ï¼Œæ¢å¤é»˜è®¤é€Ÿåº¦ã€‚</li></ul></li></ul></li><li><p><strong>æœ€ç»ˆçŠ¶æ€æ£€æŸ¥</strong>:</p><ul><li>æ‰€æœ‰ä¹˜å®¢çŠ¶æ€æ˜¯å¦ä¸º <code>ARRIVED</code>ã€‚</li><li>æ‰€æœ‰ç”µæ¢¯çŠ¶æ€æ˜¯å¦ä¸º <code>IDLE</code>ï¼Œæ˜¯å¦ç©ºè½½ï¼Œé—¨æ˜¯å¦ <code>CLOSED</code>ï¼Œé€Ÿåº¦æ˜¯å¦æ¢å¤é»˜è®¤ã€‚</li></ul></li></ol><h2 id="å››ã€-è‡ªåŠ¨åŒ–ä¸æ‰§è¡Œæµç¨‹-run-test-py"><a href="#å››ã€-è‡ªåŠ¨åŒ–ä¸æ‰§è¡Œæµç¨‹-run-test-py" class="headerlink" title="å››ã€ è‡ªåŠ¨åŒ–ä¸æ‰§è¡Œæµç¨‹ (run_test.py)"></a>å››ã€ è‡ªåŠ¨åŒ–ä¸æ‰§è¡Œæµç¨‹ (<code>run_test.py</code>)</h2><p>ä¸ºäº†æ–¹ä¾¿ã€é«˜æ•ˆåœ°è¿›è¡Œå¤§é‡æµ‹è¯•ï¼Œè‡ªåŠ¨åŒ–æµç¨‹å¿…ä¸å¯å°‘ï¼Œä½ ä¹Ÿå¾ˆå–œæ¬¢ç‚¹ç‚¹é¼ æ ‡å°±è‡ªåŠ¨å¼€å§‹è¯„æµ‹å¯¹å§:yum:</p><ol><li><p><strong>æ¨¡å¼é€‰æ‹©</strong>: å¯åŠ¨æ—¶è¯¢é—®ç”¨æˆ·é€‰æ‹©â€œå…¬æµ‹â€æˆ–â€œäº’æµ‹â€æ¨¡å¼ï¼ŒåŠ è½½å¯¹åº”çš„å‚æ•°ï¼ˆå¦‚æœ€å¤§è¯·æ±‚æŠ•å–‚æ—¶é—´ï¼Œæ•°æ®ç”ŸæˆèŒƒå›´ç­‰ï¼‰</p></li><li><p><strong>å¹¶è¡Œæµ‹è¯•</strong>: ä½¿ç”¨ <code>concurrent.futures.ProcessPoolExecutor</code> å¹¶è¡Œè¿è¡Œå¤šä¸ªæµ‹è¯•å®ä¾‹ï¼Œæ˜¾è‘—ç¼©çŸ­æ€»æµ‹è¯•æ—¶é—´</p></li><li><p><strong>ç¯å¢ƒéš”ç¦»</strong>:</p><ul><li>ä¸ºæ¯ä¸ªæµ‹è¯•å®ä¾‹åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å­ç›®å½•</li><li>å°†å­¦ç”Ÿçš„ä»£ç  JARåŒ…ã€å®˜æ–¹çš„JARåŒ…å’Œæ•°æ®æŠ•å–‚åŒ…å¤åˆ¶åˆ°å­ç›®å½•ä¸­</li><li>åœ¨è¯¥å­ç›®å½•ä¸­ç”Ÿæˆç‹¬ç«‹çš„ <code>stdin.txt</code></li><li><strong>ä½œç”¨</strong>: é˜²æ­¢ä¸åŒæµ‹è¯•å®ä¾‹ä¹‹é—´å› å…±äº«æ–‡ä»¶æˆ–çŠ¶æ€äº§ç”Ÿå¹²æ‰°ï¼Œç¡®ä¿æµ‹è¯•çš„å¯é‡å¤æ€§</li></ul></li><li><p><strong>å‘½ä»¤æ‰§è¡Œä¸ I&#x2F;O</strong>:</p><ul><li>ä½¿ç”¨ <code>subprocess.Popen</code> åœ¨å­ç›®å½•ä¸­æ‰§è¡Œæ•°æ®æŠ•å–‚å‘½ä»¤</li><li>é€šè¿‡ç®¡é“æ•è· Java ç¨‹åºçš„ <code>stdout</code> å’Œ <code>stderr</code></li><li>è®¾ç½®è¶…æ—¶ (<code>timeout</code> å‚æ•°)ï¼Œåœ¨è¶…æ—¶åå°†è¶…æ—¶åˆ¤æ–­è®¾ç½®ä¸ºçœŸ</li></ul></li><li><p><strong>è¶…æ—¶å¤„ç†</strong>: å³ä½¿è¿›ç¨‹è¶…æ—¶ï¼Œä»ä¼š<strong>å°è¯•è¯»å–å·²æœ‰çš„è¾“å‡º</strong>ï¼Œå¹¶<strong>ç»§ç»­æ‰§è¡ŒéªŒè¯é€»è¾‘</strong>ã€‚æœ€ç»ˆç»“æœä¼šè¢«æ ‡è®°ä¸º <code>FAIL_TIMEOUT</code>ï¼Œä½†æ—¥å¿—ä¸­ä¼šåŒ…å«éªŒè¯å™¨å¯¹éƒ¨åˆ†è¾“å‡ºçš„æ£€æŸ¥ç»“æœï¼Œæœ‰åŠ©äºåˆ†æè¶…æ—¶å‰çš„è¡Œä¸ºã€‚</p></li><li><p><strong>Stderr æ£€æŸ¥</strong>: ä¸¥æ ¼æ£€æŸ¥ <code>stderr</code> æ˜¯å¦æœ‰ä»»ä½•è¾“å‡ºã€‚æ ¹æ®æŒ‡å¯¼ä¹¦è¦æ±‚ï¼Œä»»ä½• <code>stderr</code> è¾“å‡ºéƒ½è§†ä¸ºé”™è¯¯</p></li><li><p><strong>ç»“æœæ±‡æ€»ä¸æŠ¥å‘Š</strong>:</p><ul><li>æ”¶é›†æ¯ä¸ªæµ‹è¯•çš„çŠ¶æ€ (<code>PASS</code>, <code>FAIL_VALIDATE</code>, <code>FAIL_TIMEOUT</code>, <code>FAIL_JAVA_ERROR</code>, <code>FAIL_STDERR_OUTPUT</code> ç­‰)</li><li>è®¡ç®—é€šè¿‡ç‡ï¼Œæ¸…æ™°åœ°åˆ—å‡ºå¤±è´¥çš„æµ‹è¯•ç‚¹åŠå…¶ä¸»è¦åŸå› </li><li>å¯¹äºå¤±è´¥çš„æµ‹è¯•ç‚¹ï¼Œ<strong>è‡ªåŠ¨ä¿å­˜</strong>å…¶è¾“å…¥æ•°æ® (<code>failed_data_...txt</code>) å’Œè¯¦ç»†æ—¥å¿— (<code>failed_stdout_...txt</code>) åˆ° <code>test_results_hw6</code> ç›®å½•ã€‚æ—¥å¿—ä¸­åŒ…å«ï¼šæµ‹è¯•ä¿¡æ¯ã€stdinã€stdoutã€stderrã€ä»¥åŠ <code>validator.py</code> æŠ¥å‘Šçš„æ‰€æœ‰é”™è¯¯ä¿¡æ¯å’Œ <strong>Traceback (ç”¨äºè°ƒè¯•è¯„æµ‹æœºæœ¬èº«)</strong></li></ul></li><li><p><strong>è‡ªåŠ¨æ¸…ç†</strong>: æµ‹è¯•ç»“æŸåï¼Œè‡ªåŠ¨åˆ é™¤æ‰€æœ‰ä¸´æ—¶çš„å­ç›®å½•ã€‚åœ¨å¼€å§‹æ–°ä¸€è½®æµ‹è¯•å‰ï¼Œä¹Ÿä¼šæ¸…ç†æ—§çš„ç»“æœç›®å½• <code>test_results_hw6</code></p><p><img src="/img/Elevator-tester/result.png" alt="è¯„æµ‹ç»“æœ"></p></li></ol><h2 id="äº”ã€-æ€»ç»“ä¸æ€è€ƒ"><a href="#äº”ã€-æ€»ç»“ä¸æ€è€ƒ" class="headerlink" title="äº”ã€ æ€»ç»“ä¸æ€è€ƒ"></a>äº”ã€ æ€»ç»“ä¸æ€è€ƒ</h2><p>è¿™å¥—è¯„æµ‹æ¡†æ¶æ—¨åœ¨é€šè¿‡<strong>è‡ªåŠ¨åŒ–ã€å¹¶è¡ŒåŒ–ã€å¤šé˜¶æ®µæ•°æ®ç”Ÿæˆã€ç²¾ç»†åŒ–çŠ¶æ€æ¨¡æ‹Ÿå’Œä¸¥æ ¼è§„åˆ™æ ¡éªŒ</strong>ï¼Œå°½å¯èƒ½å…¨é¢åœ°æµ‹è¯•å¤šçº¿ç¨‹ç”µæ¢¯ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œäº‹å®ä¸Šï¼Œä¸¤æ¬¡ä½œä¸šæˆ‘ç”¨è¿™ä¸ªè¯„æµ‹æœºæ‰¾åˆ°äº†ç¨‹åºä¸­å¾ˆå¤šéšè”½çš„bugï¼Œå¹¶åœ¨äº’æµ‹ä¸­æˆåŠŸå‡»è½äº†å‡ ä¸ªå¤§ä½¬çš„ç¨‹åºï¼Œæˆ˜ç»©å¯æŸ¥:sunglasses:</p><p><strong>ä¼˜ç‚¹</strong>:</p><ul><li><p><strong>è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜</strong>: ä¸€é”®è¿è¡Œï¼Œè‡ªåŠ¨ç”Ÿæˆæ•°æ®ã€æ‰§è¡Œã€åˆ¤å®šã€æŠ¥å‘Šã€æ¸…ç†</p></li><li><p><strong>æµ‹è¯•æ•ˆç‡é«˜</strong>: å¹¶è¡Œæ‰§è¡Œå¤§å¤§ç¼©çŸ­äº†æµ‹è¯•æ—¶é—´ï¼Œç»è¿‡èˆå‹çš„ä¼˜åŒ–ï¼Œä¸€é”®è„šæœ¬æ”¯æŒå¤šä¸ªJARåŒ…åŒæ—¶å¼€è·‘ï¼Œ<del>æ™šä¸Šç¡è§‰å‰æŠŠæˆ¿é—´é‡Œæ‰€æœ‰åŒå­¦çš„ä»£ç éƒ½æ‰“åŒ…å¥½ç„¶åç‹ ç‹ è·‘ä»–5000ç»„æ•°æ®</del>ï¼Œå¤§å¤§æé«˜äº†è¯„æµ‹æ•ˆç‡</p><p><img src="/img/Elevator-tester/condition.png" alt="è¯„æµ‹ç°çŠ¶"></p></li><li><p><strong>æ•°æ®æœ‰é’ˆå¯¹æ€§</strong>: åˆ†é˜¶æ®µç”Ÿæˆæ•°æ®ï¼Œå…¼é¡¾äº†å‹åŠ›å’Œè¾¹ç•Œæƒ…å†µ</p></li><li><p><strong>åˆ¤å®šè¾ƒä¸¥æ ¼</strong>: å°½å¯èƒ½è¦†ç›–äº†æŒ‡å¯¼ä¹¦ä¸­çš„æ˜¾å¼å’Œéšå¼è§„åˆ™ã€‚</p></li></ul><p><strong>å¾…æ”¹è¿›ä¹‹å¤„</strong>:</p><ul><li><strong>æ€§èƒ½åˆ†è®¡ç®—</strong>: å½“å‰éªŒè¯å™¨åªè®¡ç®—äº†æ€§èƒ½åˆ†çš„ä¸‰è¦ç´  (<code>T_run</code>, <code>WT</code>, <code>W</code>)ï¼Œå¹¶æœªå®ç°æŒ‡å¯¼ä¹¦ä¸­å¤æ‚çš„ç›¸å¯¹è¯„åˆ†å…¬å¼ã€‚</li><li><strong>â€œQuantum Elevatorâ€ æ£€æµ‹</strong>: ç²¾ç¡®æ£€æµ‹<code>ç”µæ¢¯ç©ºé—²çŠ¶æ€ä¸‹æ”¶åˆ°RECEIVEåæœªç­‰å¾…0.4så³ARRIVE</code>éœ€è¦å¤æ‚çš„çŠ¶æ€å›æº¯ï¼Œç›®å‰å®ç°æ˜¯è¿‘ä¼¼çš„ï¼Œå¯èƒ½å­˜åœ¨å°‘é‡è¯¯åˆ¤æˆ–æ¼åˆ¤ã€‚</li><li><strong>SCHE é—´éš”ä¿è¯</strong>: æ•°æ®ç”Ÿæˆå™¨ä¸­å¯¹ä¸¤æ¬¡ SCHE é—´éš”çš„ä¿è¯æ˜¯åŸºäºä¸€ä¸ªä¿å®ˆçš„å›ºå®šæ—¶é—´ä¼°è®¡ï¼Œè€Œéç²¾ç¡®æ¨¡æ‹Ÿï¼Œç†è®ºä¸Šä»æœ‰å°æ¦‚ç‡ç”Ÿæˆä¸åˆè§„æ•°æ®ï¼ˆå°½ç®¡æŒ‡å¯¼ä¹¦ä¿è¯è¾“å…¥æ•°æ®æ˜¯åˆç†çš„ï¼‰ã€‚</li><li><strong>éªŒè¯å™¨å¤æ‚åº¦</strong>: <code>validator.py</code> é€»è¾‘å¤æ‚ï¼Œè‡ªèº«ä¹Ÿå¯èƒ½å­˜åœ¨æœªå‘ç°çš„ bugã€‚</li></ul><p>æ€»è€Œè¨€ä¹‹ï¼Œæ­å»ºè¿™æ ·ä¸€ä¸ªè¯„æµ‹æœºæœ¬èº«å°±æ˜¯ä¸€æ¬¡å¾ˆå¥½çš„é¢å‘å¯¹è±¡è®¾è®¡å’Œå¤šæ–¹é¢è€ƒè™‘çš„ç»ƒä¹ ã€‚å¸Œæœ›è¿™ä¸ªæ€è·¯åˆ†äº«èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¯å‘ï¼Œä¹Ÿæ¬¢è¿äº¤æµå’ŒæŒ‡å‡ºå…¶ä¸­çš„ä¸è¶³ä¹‹å¤„ï¼</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OO_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OO_Unit1_å•å…ƒæ€»ç»“</title>
      <link href="/2025/03/28/OO-Unit1%E6%80%BB%E7%BB%93/%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83/"/>
      <url>/2025/03/28/OO-Unit1%E6%80%BB%E7%BB%93/%E7%AC%AC%E4%B8%80%E5%8D%95%E5%85%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŒBUAA-OOã€ç¬¬ä¸€å•å…ƒæ€»ç»“"><a href="#ã€ŒBUAA-OOã€ç¬¬ä¸€å•å…ƒæ€»ç»“" class="headerlink" title="ã€ŒBUAA OOã€ç¬¬ä¸€å•å…ƒæ€»ç»“"></a>ã€ŒBUAA OOã€ç¬¬ä¸€å•å…ƒæ€»ç»“</h1><h2 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="headerlink" title="æ€»è§ˆ"></a>æ€»è§ˆ</h2><p>ä½¿ç”¨MetricsReloadæ’ä»¶å¯¹æˆ‘çš„é¡¹ç›®è¿›è¡Œåˆ†æï¼Œå¾—åˆ°ç±»çš„å¤æ‚åº¦å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ•´ä½“æ¥çœ‹ï¼Œä¸»è¦å¤æ‚åº¦é«˜çš„åœ°æ–¹åœ¨ç¬¬äºŒæ¬¡ä½œä¸šå’Œç¬¬ä¸‰æ¬¡ä½œä¸šè¿­ä»£çš„åœ°æ–¹ï¼Œè¿™ä¹Ÿä¸æˆ‘è®¾è®¡ä¸Šæœ‰æ‰€æ¬ ç¼ºæœ‰å…³ã€‚<br><img src="/img/OO-Unit1/magnanimity.png" alt="OOåº¦é‡"></p><p><strong>æ¶æ„ä¼˜ç‚¹</strong></p><ul><li>åˆ†ç±»æ˜ç¡®ã€‚æ¯ä¸ªç±»éƒ½å¤„ç†å¥½è‡ªå·±çš„å·¥ä½œï¼Œç›¸äº’æ²¡æœ‰è¿‡å¤šäº¤é›†ï¼Œæ‰€æœ‰çš„<code>get</code>æ–¹æ³•æˆ‘éƒ½æ˜¯è¿”å›ä¸€ä¸ªæ˜ å°„è€Œéè¿”å›ç±»æˆå‘˜æœ¬èº«ï¼Œç¬¦åˆé¢å‘å¯¹è±¡å°è£…çš„æ€æƒ³ã€‚</li><li>å¯è¿­ä»£æ€§å¥½ã€‚æ•´ä½“çš„è¿­ä»£å·¥ä½œå¹¶ä¸å›°éš¾ã€‚</li></ul><p><strong>æ¶æ„ç¼ºç‚¹</strong></p><ul><li>å¯è¯»æ€§å·®ã€‚åœ¨å‡½æ•°å› å­<code>FuncFactor</code>ä¸å‡½æ•°å®šä¹‰<code>FuncCall</code>é‡Œé¢ï¼Œåœ¨å‚æ•°å¤„ç†æ–¹é¢ï¼Œæˆ‘å†™äº†å¾ˆå¤§çš„<code>if - else</code>åˆ†æ”¯ï¼Œå¯¼è‡´äº†ä»£ç å¯è¯»æ€§å¾ˆå·®ï¼Œè€Œä¸”è¿™æ ·å¾ˆå®¹æ˜“æ¼æ‰ä¸€äº›æƒ…å†µï¼Œè¿™ä¹Ÿä¸æˆ‘å¼ºæµ‹å¯„äº†æœ‰ä¸€å®šçš„è”ç³»</li><li>é‡å¤æ€§é«˜ã€‚å‡ºäºä¸€äº›åŸå› <del>å…¶å®å°±æ˜¯æ‡’</del>ï¼Œæˆ‘æ²¡æœ‰å¯¹ä»£ç è¿›è¡Œé‡æ„ï¼Œå¯¼è‡´åœ¨é€’æ¨å‡½æ•°<code>FuncFactor</code>å’Œæ™®é€šå‡½æ•°<code>SimpleFuncFactor</code>é‡Œé¢å­˜åœ¨å¤§é‡çš„ä»£ç é‡å¤ï¼Œæ²¡æœ‰æç‚¼æˆåˆç†çš„æ–¹æ³•ï¼Œç¡®å®æ˜¯ä¸å¯å–çš„åœ°æ–¹ã€‚</li></ul><p>ç±»å›¾å¦‚ä¸‹</p><p><img src="/img/OO-Unit1/ClassDiagram.png" alt="ç±»å›¾"></p><h2 id="ç¬¬ä¸€æ¬¡ä½œä¸š"><a href="#ç¬¬ä¸€æ¬¡ä½œä¸š" class="headerlink" title="ç¬¬ä¸€æ¬¡ä½œä¸š"></a>ç¬¬ä¸€æ¬¡ä½œä¸š</h2><h3 id="è®¾è®¡æ€è·¯"><a href="#è®¾è®¡æ€è·¯" class="headerlink" title="è®¾è®¡æ€è·¯"></a>è®¾è®¡æ€è·¯</h3><p>è®¾è®¡æ€è·¯ä¸Šï¼Œæˆ‘å¥—ç”¨äº†ä¹‹å‰OOpreçš„ç¬¬ä¸ƒæ¬¡ä½œä¸šç»™çš„é€’å½’ä¸‹é™çš„æ¨¡ç‰ˆï¼Œä»è¡¨è¾¾å¼é€å±‚ä¸‹é™è§£æï¼Œç›´åˆ°æŠŠæ•´ä¸ªè¡¨è¾¾å¼è§£æå®Œæˆã€‚åœ¨é¢„å¤„ç†å’Œæœ€åçš„åŒ–ç®€é˜¶æ®µï¼Œæˆ‘ä½¿ç”¨äº†ä¸€äº›æ­£åˆ™è¡¨è¾¾å¼çš„çŸ¥è¯†ï¼Œæ¯”å¦‚åŒ¹é…å¹¶å»é™¤ç©ºç™½å­—ç¬¦ã€åŒ¹é…å¤šä½™çš„<code>+</code>å·ï¼Œè¿˜æœ‰åœ¨è¾“å‡ºä¹‹å‰å»æ‰å¤šä½™çš„<code>^1</code>ç­‰ç­‰ã€‚</p><p>è€Œå…³äºä¸­é—´çš„å•é¡¹å¼ä¸å¤šé¡¹å¼ï¼Œç¬¬ä¸€æ¬¡ä½œä¸šè¡¨è¾¾å¼çš„ç»“æœä¸€å®šæ˜¯<br>$$<br>\displaystyle \sum a \cdot x^n<br>$$<br>æ‰€ä»¥ï¼Œè¿ç®—ä¸­çš„å•ä¸ªç»“æœä¸€å®šæ˜¯<br>$$<br>a \cdot x^n<br>$$<br>å› æ­¤ï¼Œæˆ‘æ„å»ºäº†ä¸€ä¸ªç±»åä¸º<code>Unit</code>ï¼Œè¿˜æœ‰ä¸€ä¸ªç±»åä¸º<code>Poly</code>ï¼Œç”¨æ¥å¤„ç†å•é¡¹å¼ä¸å¤šé¡¹å¼ã€‚è€Œè¡¨è¾¾å¼ã€é¡¹ã€å„ç§å› å­é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ª<code>toPoly</code>æ–¹æ³•ï¼Œç”¨æ¥æŠŠå·²ç»è§£æå®Œæˆçš„è¡¨è¾¾å¼è½¬æ¢æˆå¤šé¡¹å¼ä»¥ä¾›è¿ç®—å’Œè¾“å‡ºã€‚</p><h3 id="ä¼˜åŒ–æ€è·¯"><a href="#ä¼˜åŒ–æ€è·¯" class="headerlink" title="ä¼˜åŒ–æ€è·¯"></a>ä¼˜åŒ–æ€è·¯</h3><p>æœ¬æ¬¡ä½œä¸šæ•´ä½“æ¯”è¾ƒç®€å•ï¼Œé™¤äº†åˆ å»å¤šä½™çš„<code>^1</code>ã€ä¹˜å·ç­‰ï¼Œæˆ‘è¿˜å‘ç°ï¼Œå¯ä»¥å°½é‡æŠŠæ­£é¡¹æ”¾åœ¨å‰é¢ï¼Œè¿™æ ·å°±å¯ä»¥çœç•¥ä¸€ä¸ª<code>+</code>çš„é•¿åº¦ã€‚é™¤æ­¤ä¹‹å¤–æˆ‘æ²¡æœ‰æƒ³åˆ°ä»€ä¹ˆå¯è¡Œçš„ä¼˜åŒ–æ–¹æ¡ˆã€‚äº‹å®ä¹Ÿè¯æ˜æ˜¯è¿™æ ·ï¼Œåœ¨å¼ºæµ‹ä¸­ï¼Œæˆ‘å¾—åˆ°äº†100åˆ†ã€‚</p><h3 id="hackæ€è·¯"><a href="#hackæ€è·¯" class="headerlink" title="hackæ€è·¯"></a>hackæ€è·¯</h3><p>æœ¬æ¬¡hackæ˜¯æ¯”è¾ƒ<del>è‰°éš¾</del>çš„ï¼Œå› ä¸ºå¤§å®¶å¥½åƒéƒ½æ²¡æœ‰ä»€ä¹ˆbugã€‚æˆ‘åœ¨hackä¸­å¤šæ•°ä¾èµ–éšæœºç”Ÿæˆçš„æµ‹è¯•ç‚¹è¿›è¡Œæµ‹è¯•ã€‚åªæœ‰ä¸€ä½åŒå­¦çš„ä»£ç è®©æˆ‘çš„è¯„æµ‹æœºäº§ç”Ÿäº†æŠ¥é”™ï¼Œä½†æ˜¯åœ¨å°†æµ‹è¯•ç‚¹å¤åˆ¶åˆ°IDEAé‡Œé¢è¿›è¡Œæœ¬åœ°è¿è¡Œçš„æ—¶å€™å´æ²¡æœ‰é—®é¢˜ã€‚ç›´åˆ°åæ¥æˆ‘åœ¨è§‚å¯Ÿè¿™ä½åŒå­¦çš„ä»£ç æ—¶ï¼Œæˆ‘æ‰å‘ç°è¿™ä¸ªåŒå­¦åœ¨å¤„ç†è¾“å…¥çš„æœ€åä¸€ä¸ªç©ºç™½å­—ç¬¦æ—¶ä¼šäº§ç”Ÿç©ºæŒ‡é’ˆï¼Œè€Œæˆ‘åœ¨å¤åˆ¶æµ‹è¯•ç‚¹æ—¶åªä¼šå¤åˆ¶åˆ°æœ€åä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦ï¼Œç¡®å®æ˜¯ç–å¿½äº†ã€‚</p><h2 id="ç¬¬äºŒæ¬¡ä½œä¸š"><a href="#ç¬¬äºŒæ¬¡ä½œä¸š" class="headerlink" title="ç¬¬äºŒæ¬¡ä½œä¸š"></a>ç¬¬äºŒæ¬¡ä½œä¸š</h2><h3 id="è®¾è®¡æ€è·¯-1"><a href="#è®¾è®¡æ€è·¯-1" class="headerlink" title="è®¾è®¡æ€è·¯"></a>è®¾è®¡æ€è·¯</h3><p>æœ¬æ¬¡ä½œä¸šå¯è°“æ˜¯ä¸€ä¸ªæ»‘é“å¢ã€‚åœ¨æœ€å¼€å§‹è®¾è®¡çš„æ—¶å€™ï¼Œæˆ‘æ²¡æœ‰æƒ³åˆ°ä»€ä¹ˆç‰¹åˆ«æ¸…æ™°çš„å¤„ç†æ–¹æ³•ã€‚æœ€å¼€å§‹æ—¶ï¼Œæˆ‘è¯•å›¾ä½¿ç”¨å­—ç¬¦ä¸²æ›¿æ¢é€’æ¨å‡½æ•°çš„æ–¹æ³•ï¼Œä¸­é—´ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…ã€‚ä½†æ˜¯ç»è¿‡äº†ä¸€æ®µæ—¶é—´çš„åŠªåŠ›ä¹‹åï¼Œæˆ‘å‘ç°è¿™æ ·çš„åšæ³•å­˜åœ¨ç€å¾ˆå¤§çš„å¼Šç«¯ã€‚äºæ˜¯åæ¥ï¼Œåœ¨å’Œæœ‹å‹ä»¬äº¤æµä¹‹åï¼Œæˆ‘é‡æ–°æ„å»ºäº†é€’æ¨å‡½æ•°çš„éƒ¨åˆ†ï¼Œå…ˆä½¿ç”¨<strong>é™æ€æ–¹æ³•</strong>æŠŠå®šä¹‰å¼è§£æåï¼Œè®°å½•ä¸‹å¯¹åº”ä½ç½®çš„å½¢å‚ï¼Œç„¶ååœ¨é€’æ¨å‡½æ•°å› å­çš„<code>toPoly</code>æ–¹æ³•é‡Œé¢ï¼Œå°†å½¢å‚å’Œå®å‚è¿›è¡Œæ›¿æ¢å¹¶è®¡ç®—ã€‚æ•´ä½“çš„æ€è·¯æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œä½†æ˜¯å› ä¸ºæ—¶é—´åŸå› ï¼Œä¹Ÿæ²¡æœ‰è¿›è¡Œå®Œæ•´çš„ã€è¶³å¤Ÿçš„æµ‹è¯•ï¼Œæœ€ç»ˆå°‘è€ƒè™‘äº†å¾ˆå¤šæƒ…å†µï¼Œåœ¨å¼ºæµ‹ä¸­å¾—åˆ°äº†æ¯”è¾ƒä½çš„åˆ†æ•°ã€‚</p><p>ä½†æ˜¯ä¸Šæ¬¡çš„è®¾è®¡æ€è·¯ä¾æ—§å¯å–ï¼Œä¸è¿‡å½¢å¼éœ€è¦è½¬æ¢ä¸€ä¸‹ï¼Œæ¯•ç«ŸåŠ å…¥äº†æ–°çš„ä¸‰è§’å‡½æ•°ç­‰ã€‚ç„¶è€Œåœ¨åˆå¹¶åŒç±»é¡¹çš„æ—¶å€™ï¼Œæˆ‘çš„è®¾è®¡æ•´ä½“æ¯”è¾ƒå¥‡æ€ª</p><p><img src="/img/OO-Unit1/Unit.png" alt="Unit"></p><p>å¦‚å›¾ï¼Œæ˜æ˜<code>Poly</code>æ˜¯ç”±<code>Unit</code>ç»„æˆçš„ï¼Œä½†æ˜¯<code>Unit</code>çš„æˆå‘˜é‡Œé¢å´æœ‰ç€<code>Poly</code>ï¼Œå¯¼è‡´æˆ‘åœ¨åˆ¤æ–­ä¸¤ä¸ªä¸‰è§’å‡½æ•°è¡¨è¾¾å¼æ˜¯å¦ç›¸ç­‰æ—¶å‡ºäº†ç‚¹é—®é¢˜ï¼Œæˆ‘é‡å†™äº†å‡ æ¬¡<code>hashCode</code>æ–¹æ³•æ•ˆæœéƒ½ä¸ç†æƒ³ï¼Œæœ€åå¹²è„†ç›´æ¥<code>toString</code>æ¯”è¾ƒå­—ç¬¦ä¸²äº†ï¼Œæ•ˆæœå±…ç„¶è¿˜ä¸é”™ï¼Œä½†æ˜¯åœ¨é‡åˆ°ä¸€äº›åˆ»æ„çš„ä¸åŒå½¢å¼çš„ç­‰ä»·è¡¨è¾¾å¼ï¼Œè¿™ç§åˆ¤æ–­æ–¹æ³•å°±ä¸å¤Ÿç”¨äº†ã€‚</p><h3 id="debugæ€è·¯"><a href="#debugæ€è·¯" class="headerlink" title="debugæ€è·¯"></a>debugæ€è·¯</h3><p>æœ¬æ¬¡ä½œä¸šæœ€ä¸»è¦çš„é—®é¢˜æ˜¯æƒ…å†µè€ƒè™‘çš„ä¸å‘¨åˆ°ï¼Œå¿½è§†äº†é€’æ¨å‡½æ•°ä¸­å‚æ•°ä¸ºä¸‰è§’å‡½æ•°å› å­çš„æƒ…å†µã€‚æ‰€ä»¥åœ¨æœ€ç»ˆçš„debugè¿‡ç¨‹ä¸­ï¼Œæˆ‘åšçš„æœ€å¤šçš„å…¶å®æ˜¯è¡¥å……<code>if - else</code>åˆ†æ”¯ï¼Œè§£å†³è¢«å¿½è§†çš„æƒ…å†µã€‚å¦å¤–ï¼Œæˆ‘è¿˜æ›´æ”¹äº†ä¸Šæ¬¡ä½œä¸šé—ç•™çš„é—®é¢˜ã€‚åœ¨ä¸Šæ¬¡ä½œä¸šä¸­ï¼Œå¦‚æœåœ¨è¡¨è¾¾å¼å¼€å¤´æˆ–è€…<code>(</code>ä¹‹åç›´æ¥è·Ÿäº†ä¸€ä¸ªè´Ÿå·ï¼Œæˆ‘ä¼šä¸»åŠ¨æ·»åŠ ä¸€ä¸ª0ï¼ŒæŠŠå®ƒæ”¹ç¼–æˆ<code>0-</code>ä½†æ˜¯è¿™æ ·å­˜åœ¨é—®é¢˜ï¼Œå¦‚æœå‡½æ•°å› å­ä¸ºä¸€ä¸ªè´Ÿå¸¸æ•°ï¼Œä¼šå¯¼è‡´è¿™ä¸ªè´Ÿå¸¸æ•°å˜æˆäº†ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿›è€Œè§£æå°±ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥æœ€åæ˜¯æŠŠè§£æå¸¸æ•°å› å­çš„éƒ¨åˆ†ä¿®æ”¹æˆå¯ä»¥åˆ¤æ–­è´Ÿå·äº†ã€‚</p><h2 id="ç¬¬ä¸‰æ¬¡ä½œä¸š"><a href="#ç¬¬ä¸‰æ¬¡ä½œä¸š" class="headerlink" title="ç¬¬ä¸‰æ¬¡ä½œä¸š"></a>ç¬¬ä¸‰æ¬¡ä½œä¸š</h2><h3 id="è®¾è®¡æ€è·¯-2"><a href="#è®¾è®¡æ€è·¯-2" class="headerlink" title="è®¾è®¡æ€è·¯"></a>è®¾è®¡æ€è·¯</h3><p>è®¾è®¡æ€è·¯ä¾ç„¶å»¶ç»­ä¸Šä¸¤æ¬¡ä½œä¸šçš„æ¶æ„ï¼Œæ–°å¢äº†æ±‚å¯¼å› å­å’Œæ™®é€šå‡½æ•°å› å­ã€‚æ™®é€šå‡½æ•°å› å­ä»…åœ¨æœ€åˆå®šä¹‰æ—¶å’Œé€’æ¨å‡½æ•°æœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥å…¶å®å¯ä»¥å†æŠŠäºŒè€…å®šä¹‰ä¸€ä¸ªæ¥å£ï¼ŒæŠŠæ–¹æ³•å†ç²¾ç‚¼ä¸€ä¸‹ã€‚</p><p>æ±‚å¯¼çš„å®ç°ä¹Ÿæ˜¯ä½¿ç”¨äº†é€’å½’çš„æ€è·¯ï¼Œæˆ‘æŠŠæ±‚å¯¼çš„æ–¹æ³•æ·»åŠ åˆ°äº†<code>Factor</code>æ¥å£é‡Œé¢ï¼ŒåŒæ—¶ä¹Ÿæ·»åŠ äº†<code>clone</code>æ–¹æ³•ï¼Œå®ç°æ·±å…‹éš†ï¼Œé¿å…ä¿®æ”¹åŸæ¥å®ä¾‹åŒ–äº†çš„ç±»ã€‚</p><h3 id="debugæ€è·¯-1"><a href="#debugæ€è·¯-1" class="headerlink" title="debugæ€è·¯"></a>debugæ€è·¯</h3><p>ç»è¿‡äº†ä¸Šä¸€æ¬¡ä½œä¸šçš„ç—›è‹¦æ•™è®­ï¼Œæˆ‘å°½åŠ›è€ƒè™‘å‘¨å…¨äº†æ‰€æœ‰çš„æƒ…å†µï¼Œç„¶è€Œåœ¨ä¸€ä¸ªä¸èµ·çœ¼çš„åœ°æ–¹ï¼Œæˆ‘å¤±è¯¯å°†è¿”å›çš„ç±»å®šä¹‰ä¸ºäº†<code>Expr</code>ç±»ã€‚ç„¶è€Œåœ¨æˆ‘çš„å¤„ç†ä¸­ï¼Œå¤„äºå†…å±‚çš„è¡¨è¾¾å¼éƒ½åº”å½“ä½¿ç”¨<code>SubExpr</code>ç±»ï¼Œæ‰€ä»¥å½“å‡ºç°é€’æ¨å‡½æ•°è°ƒç”¨æ™®é€šå‡½æ•°è¿›è¡Œå®šä¹‰çš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿå‚æ•°æ›¿æ¢å¤±è´¥çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯<code>f&#123;1&#125; = g(h(x^2))</code>è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä¼šè§£ææˆ<code>f&#123;1&#125; = g(h(x))</code>ï¼Œäº§ç”Ÿäº†ä¸€äº›bugï¼Œä½¿æˆ‘å¼ºæµ‹å¤±å»äº†ä¸€ç‚¹åˆ†æ•°ã€‚</p><h3 id="hackæ€è·¯-1"><a href="#hackæ€è·¯-1" class="headerlink" title="hackæ€è·¯"></a>hackæ€è·¯</h3><p>åœ¨hackå¼€æ”¾ä¹‹å‰ï¼Œæˆ‘å…ˆåˆ—ä¸‹äº†ä¸€ä¼—å¤§å®¶å¯èƒ½ä¼šå¿½è§†çš„è¾“å…¥å½¢å¼ï¼Œæ¯”å¦‚å‡½æ•°åµŒå¥—è°ƒç”¨ã€å¯¹ä¸‰è§’å‡½æ•°åµŒå¥—æ±‚å¯¼ç­‰ï¼Œç„¶åäººå·¥æäº†å¾ˆå¤šå‹åŠ›æµ‹è¯•ç‚¹ï¼Œåœ¨hackå¼€æ”¾åï¼Œå¯¹æ•´ä¸ªæˆ¿é—´é‡Œçš„æ‰€æœ‰ä»£ç è¿›è¡ŒåŒæ­¥æµ‹è¯•ï¼Œæœ€åç¡®å®å‘ç°äº†å¾ˆå¤šé”™è¯¯ã€‚</p><h2 id="å¯èƒ½çš„è¿­ä»£éœ€æ±‚"><a href="#å¯èƒ½çš„è¿­ä»£éœ€æ±‚" class="headerlink" title="å¯èƒ½çš„è¿­ä»£éœ€æ±‚"></a>å¯èƒ½çš„è¿­ä»£éœ€æ±‚</h2><p>å¯ä»¥å‘ç°ï¼Œæœ‰å¾ˆå¤šçš„è¡¨è¾¾å¼å½¢å¼éƒ½æ²¡æœ‰è€ƒè™‘åˆ°ï¼Œæ¯”å¦‚æŒ‡æ•°å‡½æ•°ã€å¯¹æ•°å‡½æ•°ç­‰ç­‰ã€‚ä»¥æŒ‡æ•°å‡½æ•°ä¸ºä¾‹ã€‚ä¸¤ä¸ªåº•æ•°ç›¸åŒçš„æŒ‡æ•°å‡½æ•°åœ¨ç›¸ä¹˜çš„æ—¶å€™ï¼Œå…¶åº•æ•°ä¸å˜ã€æŒ‡æ•°ç›¸åŠ ï¼Œé‚£ä¹ˆåœ¨å¤šé¡¹å¼ä¹˜æ³•çš„æ–¹æ³•é‡Œå°±è¦å¢åŠ å¯¹æŒ‡æ•°å‡½æ•°ç›¸ä¹˜çš„å¤„ç†ï¼š</p><ol><li>åˆ¤æ–­åº•æ•°æ˜¯å¦ç›¸åŒ</li><li>å°†æŒ‡æ•°è¿›è¡Œç›¸åŠ </li></ol><p>å¯¹æ•°å‡½æ•°çš„å¤„ç†ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚</p><h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><p>æœ¬æ¬¡ä½œä¸šæˆ‘æ²¡æœ‰åšç‰¹åˆ«å¤šçš„ä¼˜åŒ–ï¼Œä¸»è¦çš„ä¼˜åŒ–åœ¨ä¸‰è§’å‡½æ•°ç‰¹æ®Šå€¼åˆ¤æ–­ä¸Šé¢ï¼Œæ¯”å¦‚è¿ç®—ä¸­å‡ºç°sin(0)ï¼Œcos(0)ç­‰ç­‰ï¼Œå¦å¤–æˆ‘å°è¯•åšäº†ä¸€ä¸‹cos^2+sin^2çš„ä¼˜åŒ–ï¼Œä¸è¿‡åªèƒ½åœ¨æ¯”è¾ƒç®€å•çš„æ¡ä»¶ä¸‹è¿›è¡Œåˆ¤æ–­ã€‚</p><h2 id="å¿ƒå¾—ä½“ä¼š"><a href="#å¿ƒå¾—ä½“ä¼š" class="headerlink" title="å¿ƒå¾—ä½“ä¼š"></a>å¿ƒå¾—ä½“ä¼š</h2><p>æœ¬æ¬¡ä½œä¸šç¡®å®è®©æˆ‘ä½“ä¼šåˆ°äº†é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¥‡å¦™ä¹‹å¤„ã€‚è£æ–‡æˆˆè€å¸ˆçš„ç†è®ºè¯¾ä¹Ÿè®©æˆ‘å¯å‘é¢‡å¤šã€‚å°è£…ã€å¤šæ€çš„æ€æƒ³ç¡®å®æ˜¯é¢å‘å¯¹è±¡çš„é‡è¦ç‰¹ç‚¹ï¼Œä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹æœ‰è¶£çš„åœ°æ–¹ã€‚è¡¨è¾¾å¼çš„è§£æã€é€’å½’ä¸‹é™ï¼ŒæŠŠæ¯ä¸€é¡¹ä»»åŠ¡é€æ­¥ä¸‹æ”¾åˆ°æ¯ä¸ªç±»ä¸­ï¼Œæ¯ä¸ªç±»ä¸å‘å¤–ç•Œå±•ç¤ºè‡ªå·±çš„â€œéšç§â€ï¼Œè®©ä»£ç çš„è¿è¡Œå˜å¾—æ¸…æ™°è€Œæœ‰è¿¹å¯å¾ªã€‚</p><h2 id="æœªæ¥æ–¹å‘"><a href="#æœªæ¥æ–¹å‘" class="headerlink" title="æœªæ¥æ–¹å‘"></a>æœªæ¥æ–¹å‘</h2><p>å¯¹äºè¯¾ç¨‹æœªæ¥çš„æ–¹å‘ï¼Œæˆ‘è§‰å¾—å¯ä»¥é€‚å½“ç»™äºˆæ›´å¤šçš„æ—¶é—´ä»¥ä¾›å¤§å®¶å¯¹è‡ªå·±çš„æ¶æ„è¿›è¡Œæ›´å……è¶³çš„ä¼˜åŒ–ï¼Œå¯¹è‡ªå·±çš„ä»£ç äºˆä»¥æ›´å……åˆ†çš„æ£€æŸ¥ã€‚å¦å¤–ï¼Œå»ºè®®è¯¾ç¨‹å¼€å±•ä¸€ä¸ªç±»ä¼¼é¢å¤–è¡¥å……çš„é¡¹ç›®ï¼ŒæŒ‡å¯¼å¤§å®¶å¦‚ä½•æ­å»ºå±äºè‡ªå·±çš„è¯„æµ‹æœºï¼Œå¯ä»¥ç»™ä¸€äº›åˆç†çš„æ•°æ®ç”Ÿæˆæ€è·¯ç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OO_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_Lab1_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/03/28/OS-Lab1/OS-Lab1%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/03/28/OS-Lab1/OS-Lab1%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h1><h2 id="Thinking-1-1"><a href="#Thinking-1-1" class="headerlink" title="Thinking 1.1"></a>Thinking 1.1</h2><blockquote><p>åœ¨é˜…è¯» é™„å½•ä¸­çš„ç¼–è¯‘é“¾æ¥è¯¦è§£ ä»¥åŠæœ¬ç« å†…å®¹åï¼Œå°è¯•åˆ†åˆ«ä½¿ç”¨å®éªŒç¯å¢ƒä¸­<br>çš„åŸç”Ÿ x86 å·¥å…·é“¾ï¼ˆgccã€ldã€readelfã€objdump ç­‰ï¼‰å’Œ MIPS äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼ˆå¸¦æœ‰<br>mips-linux-gnu- å‰ç¼€ï¼Œå¦‚ mips-linux-gnu-gccã€mips-linux-gnu-ldï¼‰ï¼Œé‡å¤å…¶ä¸­çš„ç¼–<br>è¯‘å’Œè§£æè¿‡ç¨‹ï¼Œè§‚å¯Ÿç›¸åº”çš„ç»“æœï¼Œå¹¶è§£é‡Šå…¶ä¸­å‘ objdump ä¼ å…¥çš„å‚æ•°çš„å«ä¹‰ã€‚</p></blockquote><p>æŒ‡å¯¼ä¹¦ä¸­æåˆ°çš„objdumpæŒ‡ä»¤ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -DS è¦åæ±‡ç¼–çš„ç›®æ ‡æ–‡ä»¶å &gt; å¯¼å‡ºæ–‡æœ¬æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><ul><li><code>-D</code>è¡¨ç¤ºï¼šåæ±‡ç¼–ï¼ˆDisassembleï¼‰é‚£äº›é¢„è®¡åŒ…å«æŒ‡ä»¤çš„<strong>æ‰€æœ‰</strong>èŠ‚åŒºã€‚</li><li><code>-S</code>è¡¨ç¤ºï¼šåœ¨åæ±‡ç¼–è¾“å‡ºä¸­ï¼Œå°½å¯èƒ½åœ°å°†æºä»£ç ï¼ˆå¦‚æœç¼–è¯‘æ—¶åŒ…å«äº†è°ƒè¯•ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ gcc -g ç¼–è¯‘ï¼‰ä¸æ±‡ç¼–ä»£ç äº¤é”™æ˜¾ç¤ºã€‚è¿™å¯¹äºç†è§£æŸæ®µæ±‡ç¼–ä»£ç å¯¹åº”å“ªè¡Œ C&#x2F;C++ æºä»£ç éå¸¸æœ‰å¸®åŠ©ã€‚é€šå¸¸éœ€è¦ä¸<code>-d</code>æˆ–<code>-D</code>ä¸€èµ·ä½¿ç”¨ã€‚</li><li><code>-d</code>è¡¨ç¤ºï¼šåæ±‡ç¼–é‚£äº›é¢„è®¡åŒ…å«æŒ‡ä»¤çš„<strong>ä»£ç </strong>èŠ‚åŒºã€‚</li></ul><p>é¦–å…ˆï¼Œç¼–å†™ä¸€ä¸ªç®€å•çš„ç¨‹åº<code>helloworld.c</code>ï¼Œå¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello world!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>mips-linux-gnu-gcc -E helloworld.c &gt; temp</code>å‘½ä»¤ï¼Œåªè¿›è¡Œé¢„å¤„ç†ï¼Œä¸è¿›è¡Œç¼–è¯‘å’Œæ“ä½œï¼Œæ‰¾åˆ°æ–‡ä»¶æœ«å°¾çš„ä½ç½®ï¼Œå¦‚å›¾æ‰€ç¤º</p><p><img src="/img/OS-Lab1/preprocessing.png" alt="é¢„å¤„ç†"></p><p>é¢„å¤„ç†åªä¸è¿‡æ˜¯å°†å¤´æ–‡ä»¶å±•å¼€ï¼Œæ›¿æ¢æˆç›¸åº”çš„ä»£ç ï¼Œå¹¶æ²¡æœ‰ä»»ä½•ç¼–è¯‘å’Œé“¾æ¥</p><p>ä¾æ¬¡æ‰§è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mips-linux-gnu-gcc -c helloworld.c</span><br><span class="line">mips-linux-gnu-objdump -DS helloworld.o &gt; temp</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªå‘½ä»¤åˆ†åˆ«æ˜¯é’ˆå¯¹MIPSæ¶æ„çš„äº¤å‰ç¼–è¯‘å’Œåæ±‡ç¼–æ“ä½œ</p><p>ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯ä½¿ç”¨äº¤å‰ç¼–è¯‘å™¨<code>mips-linux-gun-gcc</code>å¯¹<code>helloworld.c</code>æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œæœ€ç»ˆä¼šç”Ÿæˆç›®æ ‡æ–‡ä»¶<code>helloworld.o</code><br>ç¬¬äºŒä¸ªå‘½ä»¤æ˜¯ä½¿ç”¨<code>mips-linux-gnu-objdump</code>å·¥å…·å¯¹ç›®æ ‡æ–‡ä»¶<code>helloworld.o</code>è¿›è¡Œåæ±‡ç¼–ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°<code>temp</code>ä¸­</p><p>æœ€ç»ˆç»“æœå¦‚å›¾</p><p><img src="/img/OS-Lab1/disassemble.png" alt="åæ±‡ç¼–"></p><p>æˆ‘ä»¬å‘ç°åæ±‡ç¼–çš„ç»“æœä¸­åŒ…å«äº†æºä»£ç ä¸­å®šä¹‰çš„å˜é‡å’Œå‡½æ•°</p><p>å†æ‰§è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mips-linux-gnu-gcc -o helloworld helloworld.c</span><br><span class="line">mips-linux-gnu-objdump -DS helloworld &gt; temp</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªå‘½ä»¤æ˜¯ç”¨äºç¼–è¯‘å’Œåæ±‡ç¼– MIPS æ¶æ„ç¨‹åºçš„æ“ä½œ</p><p>ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯ä½¿ç”¨äº¤å‰ç¼–è¯‘å™¨<code>mips-linux-gun-gcc</code>å¯¹<code>helloworld.c</code>æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶<code>helloworld</code><br>ç¬¬äºŒä¸ªå‘½ä»¤æ˜¯ä½¿ç”¨<code>mips-linux-gnu-objdump</code>å·¥å…·å¯¹åä¸º<code>helloworld</code>çš„å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œåæ±‡ç¼–ï¼Œå¹¶å°†åæ±‡ç¼–ç»“æœè¾“å‡ºåˆ°<code>temp</code>ä¸­</p><p><img src="/img/OS-Lab1/disassemble2.png" alt="åæ±‡ç¼–2"></p><p>æˆ‘ä»¬å‘ç°<code>main</code>å‡½æ•°è¢«åˆ†é…åˆ°äº†<code>00400650</code>çš„åœ°å€ä¸Š</p><p>æŸ¥é˜…ç›¸å…³èµ„æ–™åï¼Œæˆ‘ä»¬çŸ¥é“ï¼š<br>å¦‚æœåªç¼–è¯‘ä¸é“¾æ¥</p><ol><li>ç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆ.o æ–‡ä»¶ï¼‰ï¼ŒåŒ…å«äº†ç¼–è¯‘åçš„æœºå™¨ä»£ç å’Œç¬¦å·è¡¨ä¿¡æ¯ï¼Œä½†è¿˜æ²¡æœ‰è¿›è¡Œç¬¦å·è§£æå’Œåœ°å€é‡å®šä½</li><li>å¦‚æœæ¶‰åŠå¤šä¸ªæºæ–‡ä»¶ï¼Œæ¯ä¸ªæºæ–‡ä»¶éƒ½ä¼šç”Ÿæˆå¯¹åº”çš„ç›®æ ‡æ–‡ä»¶ï¼Œä½†å®ƒä»¬å¹¶æœªåˆå¹¶åœ¨ä¸€èµ·</li></ol><p>ç¼–è¯‘å¹¶è¿æ¥</p><ol><li>å°†å„ä¸ªç›®æ ‡æ–‡ä»¶è¿æ¥åœ¨ä¸€èµ·ï¼Œè§£æç¬¦å·å¼•ç”¨ï¼Œå¡«å……åœ°å€ç©ºé—´ï¼Œå¹¶ç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶</li><li>åœ¨é“¾æ¥è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½è¿˜ä¼šåŒ…å«åº“æ–‡ä»¶ã€å…±äº«å¯¹è±¡ç­‰ï¼Œä»¥åŠè¿›è¡Œç¬¦å·è§£æå’Œåœ°å€é‡å®šä½</li></ol><h2 id="Thinking-1-2"><a href="#Thinking-1-2" class="headerlink" title="Thinking 1.2"></a>Thinking 1.2</h2><blockquote><p>æ€è€ƒä¸‹è¿°é—®é¢˜ï¼š</p><ul><li>å°è¯•ä½¿ç”¨æˆ‘ä»¬ç¼–å†™çš„ readelf ç¨‹åºï¼Œè§£æä¹‹å‰åœ¨ target ç›®å½•ä¸‹ç”Ÿæˆçš„å†…æ ¸ ELF æ–‡<br>ä»¶ã€‚<blockquote><ul><li>ä¹Ÿè®¸ä½ ä¼šå‘ç°æˆ‘ä»¬ç¼–å†™çš„ readelf ç¨‹åºæ˜¯ä¸èƒ½è§£æ readelf æ–‡ä»¶æœ¬èº«çš„ï¼Œè€Œæˆ‘ä»¬åˆš<br>æ‰ä»‹ç»çš„ç³»ç»Ÿå·¥å…· readelf åˆ™å¯ä»¥è§£æï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼ˆæç¤ºï¼šå°è¯•ä½¿ç”¨ readelf<br>-hï¼Œå¹¶é˜…è¯» tools&#x2F;readelf ç›®å½•ä¸‹çš„ Makefileï¼Œè§‚å¯Ÿ readelf ä¸ hello çš„ä¸åŒï¼‰</li></ul></blockquote></li></ul></blockquote><p>è¿è¡Œ<code>./tools/readelf/readelf ./target/mos</code>æŒ‡ä»¤ï¼Œå¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">0:0x0</span><br><span class="line">1:0x80010000</span><br><span class="line">2:0x80011cc0</span><br><span class="line">3:0x80011cd8</span><br><span class="line">4:0x80011cf0</span><br><span class="line">5:0x0</span><br><span class="line">6:0x0</span><br><span class="line">7:0x0</span><br><span class="line">8:0x0</span><br><span class="line">9:0x0</span><br><span class="line">10:0x0</span><br><span class="line">11:0x0</span><br><span class="line">12:0x0</span><br><span class="line">13:0x0</span><br><span class="line">14:0x0</span><br><span class="line">15:0x0</span><br><span class="line">16:0x0</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¾—åˆ°äº†ä¸€ç³»åˆ—çš„åœ°å€ä¿¡æ¯ã€‚ä½†å½“æˆ‘ä»¬ç”¨readelfç¨‹åºå»è§£æè‡ªèº«ï¼Œå´å‘ç°æ— æ³•æˆåŠŸã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç¼–å†™çš„ readelf ç¨‹åºä»…æ”¯æŒè§£æ<strong>32</strong>ä½ ELF æ–‡ä»¶ï¼Œè€Œç¨‹åºè‡ªèº«å®é™…ä¸Šæ˜¯ä¸€ä¸ª<strong>64</strong>ä½çš„ ELF æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬ç”¨<code>readelf -h</code>å‘½ä»¤åˆ†åˆ«å¯¹<code>hello</code>å’Œ<code>readelf</code>æ–‡ä»¶è¿›è¡Œå¤´éƒ¨ä¿¡æ¯è§£æã€‚<code>hello</code>æ–‡ä»¶ç»“æœæ˜¾ç¤ºä¸º<code>ELF32</code>ï¼Œè€Œ<code>readelf</code>æ–‡ä»¶åˆ™æ˜¾ç¤ºä¸º<code>ELF64</code></p><h1 id="å®éªŒéš¾ç‚¹"><a href="#å®éªŒéš¾ç‚¹" class="headerlink" title="å®éªŒéš¾ç‚¹"></a>å®éªŒéš¾ç‚¹</h1><p>æœ¬æ¬¡å®éªŒä¸»è¦åˆ†ä¸ºå†…æ ¸åˆå§‹åŒ–é˜¶æ®µçš„åº•å±‚é…ç½®å’Œç”¨æˆ·åŠŸèƒ½æ¨¡å—å¼€å‘ä¸¤ä¸ªéƒ¨åˆ†ã€‚åœ¨ç³»ç»Ÿå¯åŠ¨ç¯èŠ‚ä¸­ï¼Œæˆ‘ä»¬é‡ç‚¹è¿›è¡Œäº†å†…æ ¸åœ°å€ç©ºé—´çš„é‡æ–°è§„åˆ’ä¸å¯åŠ¨æµç¨‹çš„æ±‡ç¼–çº§å®ç°ã€‚è¿™éœ€è¦ç»“åˆå·¥ç¨‹ä¸­çš„å¤šç»´åº¦æŠ€æœ¯æ–‡æ¡£ï¼Œç‰¹åˆ«æ˜¯é€šè¿‡è§£æå†…å­˜æ˜ å°„ç¤ºæ„å›¾æ¥ä¿®æ­£é“¾æ¥è„šæœ¬(kernel.lds)ä¸­çš„æ®µåœ°å€å‚æ•°ï¼ŒåŒæ—¶éœ€è¦æ·±å…¥ç†è§£å¹³å°ç›¸å…³çš„å®å®šä¹‰ä½“ç³»ï¼Œæ‰èƒ½å‡†ç¡®å®Œæˆstart.Sä¸­å…³é”®å¯„å­˜å™¨çš„åˆå§‹åŒ–é…ç½®ã€‚è™½ç„¶è¿™éƒ¨åˆ†åŸºç¡€ä»£ç é‡ä¸å¤§ï¼Œä½†æ¶‰åŠåˆ°åº•å±‚ç¡¬ä»¶ä¸ç¼–è¯‘å·¥å…·é“¾çš„æ·±åº¦ååŒï¼Œéœ€è¦å»ºç«‹å®Œæ•´çš„åœ°å€ç©ºé—´æ˜ å°„è®¤çŸ¥</p><p>åœ¨åŠŸèƒ½å¼€å‘å±‚é¢ï¼Œå®éªŒåŒ…å«ä¸¤ä¸ªç‰¹è‰²æ¨¡å—çš„å®ç°ã€‚é¦–å…ˆæ˜¯ç±»readelfå·¥å…·çš„æ ¸å¿ƒåŠŸèƒ½ä»¿çœŸï¼Œè™½ç„¶éœ€è¦è¡¥å…¨çš„ä»£ç ç‰‡æ®µæœ‰é™ï¼Œä½†æ•´ä¸ªå·¥ç¨‹æ¶æ„æ¶‰åŠELFæ–‡ä»¶æ ¼å¼è§£æçš„å®Œæ•´å¤„ç†æµç¨‹ã€‚ä¸ºæ­¤å¿…é¡»ä»”ç»†ç ”è¯»å·¥ç¨‹ä¸­é¢„å®šä¹‰çš„èŠ‚å¤´è¡¨ã€ç¨‹åºå¤´è¡¨ç­‰æ•°æ®ç»“æ„ï¼Œå¹¶ç†è§£å„å­—æ®µåœ¨äºŒè¿›åˆ¶è§£æè¿‡ç¨‹ä¸­çš„åŠ¨æ€å¡«å……æœºåˆ¶ã€‚å…¶æ¬¡æ˜¯å†…æ ¸çº§æ—¥å¿—è¾“å‡ºç³»ç»Ÿprintkçš„å®Œå–„ï¼Œè¯¥ä»»åŠ¡è™½ç„¶åªéœ€åœ¨ç°æœ‰æ¡†æ¶å†…è¡¥å……å°‘é‡æ ¼å¼åŒ–å¤„ç†é€»è¾‘ï¼Œä½†è¦çœŸæ­£æŒæ¡å…¶è®¾è®¡ç²¾é«“ï¼Œéœ€è¦é€šç›˜åˆ†æå¯å˜å‚æ•°å¤„ç†æœºåˆ¶ã€å­—ç¬¦ç¼“å†²ç®¡ç†ç­–ç•¥ä»¥åŠç»ˆç«¯é©±åŠ¨æ¥å£çš„è°ƒç”¨å±‚çº§ã€‚ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸‰ä¸ªå…³è”æ–‡ä»¶ä¹‹é—´çš„æ•°æ®æµå‘å’Œå‡½æ•°è°ƒç”¨å…³ç³»æ„æˆäº†å®Œæ•´çš„è¾“å‡ºå¤„ç†é“¾æ¡ï¼Œè¿™å¯¹ç†è§£æ“ä½œç³»ç»Ÿå†…æ ¸çš„æ¨¡å—åŒ–è®¾è®¡æ€æƒ³å…·æœ‰é‡è¦ä»·å€¼</p><h1 id="å®éªŒä½“ä¼š"><a href="#å®éªŒä½“ä¼š" class="headerlink" title="å®éªŒä½“ä¼š"></a>å®éªŒä½“ä¼š</h1><p>è¿™æ¬¡å®éªŒï¼Œæˆ‘ä»¬æ•´ä½“çš„å·¥ä½œé‡å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œéš¾åº¦ä¹Ÿä¸é«˜ã€‚ä½†æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€ç‚¹æ˜¯æˆ‘ä»¬è¦ä»”ç»†é˜…è¯»ç»™å‡ºçš„ä»£ç ï¼ŒæŠŠæ¡ç»†èŠ‚ã€‚æŠŠæ¶æ„ç†æ¸…æ¥šï¼Œä»£ç çš„ç¼–å†™å’Œè¡¥å…¨å°±å¾ˆè½»æ¾äº†ã€‚åœ¨è¡¥å…¨ä»£ç çš„åŒæ—¶ï¼Œæˆ‘ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šæ›´æœ‰è¶£çš„cä»£ç ç¼–å†™æ–¹å¼ï¼Œä¹Ÿç®—æ˜¯ç»™æˆ‘å¸¦æ¥äº†æ›´é«˜ç«¯çš„ä»£ç ç¼–å†™ç»†åˆ™</p><h1 id="åŸåˆ›è¯´æ˜"><a href="#åŸåˆ›è¯´æ˜" class="headerlink" title="åŸåˆ›è¯´æ˜"></a>åŸåˆ›è¯´æ˜</h1><p>æœ¬æ¬¡å®éªŒæŠ¥å‘Šå‚è€ƒäº†<a href="https://buaaczx.github.io/posts/20240712-os-lab1/">czxå­¦é•¿</a>å’Œ<a href="https://yanna-zy.github.io/2023/03/19/BUAA-OS-1/">zyå­¦å§</a>çš„åšå®¢</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUAA_OS_Lab0_å®éªŒæŠ¥å‘Š</title>
      <link href="/2025/03/11/OS-Lab0/OS-Lab0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"/>
      <url>/2025/03/11/OS-Lab0/OS-Lab0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h1><h2 id="Thinking-0-1"><a href="#Thinking-0-1" class="headerlink" title="Thinking 0.1"></a>Thinking 0.1</h2><p>æ‰§è¡Œ<code>git status &gt; Untracked.txt</code>ï¼Œæ˜¯æŸ¥è¯¢å½“å‰<code>README.txt</code>çš„æ–‡ä»¶çŠ¶æ€ï¼Œå¹¶å°†å…¶è®°å½•åœ¨<code>Untracked.txt</code>æ–‡ä»¶ä¸­ã€‚åç»­ä¸¤ä¸ªå‘½ä»¤åŒç†ã€‚</p><p>æ‰§è¡Œå®Œ<code>cat Untracked.txt</code>åï¼Œæ˜¾ç¤ºå‡º<code>æœªè·Ÿè¸ªçš„æ–‡ä»¶</code>ï¼Œè¯´æ˜æ–‡ä»¶åˆšåˆšæ–°å»ºçš„æ—¶å€™ï¼Œå…¶å¤„äºæœªè·Ÿè¸ªçš„çŠ¶æ€ï¼›æ‰§è¡Œ<code>cat Stage.txt</code>åï¼Œæ˜¾ç¤ºå‡º<code>è¦æäº¤çš„å˜æ›´</code>ï¼Œè¯´æ˜ä¿®æ”¹äº†æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨<code>add</code>å‘½ä»¤ä¹‹åï¼Œæ–‡ä»¶å¤„äºæš‚å­˜çš„çŠ¶æ€ï¼›æ‰§è¡Œ<code>cat Modified.txt</code>ä¹‹åï¼Œæ˜¾ç¤ºå‡º<code>å°šæœªæš‚å­˜ä»¥å¤‡æäº¤çš„å˜æ›´</code>ï¼Œè¯´æ˜æ–‡ä»¶å†è¢«ä¿®æ”¹ä¹‹åï¼Œå¤„äºè¢«ä¿®æ”¹çŠ¶æ€ã€‚</p><h2 id="Thinking-0-2"><a href="#Thinking-0-2" class="headerlink" title="Thinking 0.2"></a>Thinking 0.2</h2><p>add the file å¯¹åº”çš„æ˜¯gitä¸­çš„<code>git add</code>å‘½ä»¤</p><p>stage the file å¯¹åº”çš„ä¹Ÿæ˜¯gitä¸­çš„<code>git add</code>å‘½ä»¤</p><p>commit å¯¹åº”çš„æ˜¯gitä¸­çš„<code>git commit</code>å‘½ä»¤</p><h2 id="Thinking-0-3"><a href="#Thinking-0-3" class="headerlink" title="Thinking 0.3"></a>Thinking 0.3</h2><ol><li><code>git checkout --print.c</code></li><li><code>git reset HEAD print.c &amp;&amp; git checkout --print.c</code></li><li><code>git rm --cached hello.txt</code></li></ol><h2 id="Thinking-0-4"><a href="#Thinking-0-4" class="headerlink" title="Thinking 0.4"></a>Thinking 0.4</h2><p>ç¬¬ä¸€æ¬¡<code>git log</code>å¦‚å›¾æ‰€ç¤º</p><p><img src="/img/OS-Lab0/picture1.png" alt="å›¾ç‰‡1"></p><p>ç¬¬äºŒæ¬¡<code>git log</code>å¦‚å›¾æ‰€ç¤º</p><p><img src="/img/OS-Lab0/picture2.png" alt="å›¾ç‰‡2"></p><p>ç¬¬ä¸‰æ¬¡<code>git log</code>å¦‚å›¾æ‰€ç¤º</p><p><img src="/img/OS-Lab0/picture3.png" alt="å›¾ç‰‡3"></p><p>ç¬¬å››æ¬¡<code>git log</code>å¦‚å›¾æ‰€ç¤º</p><p><img src="/img/OS-Lab0/picture4.png" alt="å›¾ç‰‡4"></p><h2 id="Thinking-0-5"><a href="#Thinking-0-5" class="headerlink" title="Thinking 0.5"></a>Thinking 0.5</h2><p>æ‰§è¡Œ<code>echo first</code>åå¦‚å›¾</p><p><img src="/img/OS-Lab0/picture5.png" alt="å›¾ç‰‡5"></p><p>æ‰§è¡Œ<code>echo second &gt; output.txt</code>åå¦‚å›¾</p><p><img src="/img/OS-Lab0/picture6.png" alt="å›¾ç‰‡6"></p><p>æ‰§è¡Œ<code>echo third &gt; output.txt</code>åå¦‚å›¾</p><p><img src="/img/OS-Lab0/picture7.png" alt="å›¾ç‰‡7"></p><p>æ‰§è¡Œ<code>echo forth &gt;&gt; output.txt</code>åå¦‚å›¾</p><p><img src="/img/OS-Lab0/picture8.png" alt="å›¾ç‰‡8"></p><h2 id="Thinking-0-6"><a href="#Thinking-0-6" class="headerlink" title="Thinking 0.6"></a>Thinking 0.6</h2><p><code>command</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash                                                              <span class="built_in">touch</span> <span class="built_in">test</span></span></span><br><span class="line">echo &#x27;echo Shell Start...&#x27; &gt; test</span><br><span class="line">echo &#x27;echo set a = 1&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;a=1&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo set b = 2&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;b=2&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo set c = a+b&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;c=$[$a+$b]&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo c = $c&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo save c to ./file1&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo $c&gt;file1&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo save b to ./file2&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo $b&gt;file2&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo save a to ./file3&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo $a&gt;file3&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo save file1 file2 file3 to file4&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;cat file1&gt;file4&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;cat file2&gt;&gt;file4&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;cat file3&gt;&gt;file4&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;echo save file4 to ./result&#x27; &gt;&gt; test</span><br><span class="line">echo &#x27;cat file4&gt;&gt;result&#x27; &gt;&gt; test</span><br></pre></td></tr></table></figure><p><code>result</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br></pre></td></tr></table></figure><ul><li><code>echo echo Shell Start</code>ç›´æ¥æŠŠ<code>echo Shell Start</code>ä½œä¸ºå­—ç¬¦ä¸²è¾“å‡ºï¼›</li><li><code>echo (åé¡¿å·)echo Shell Start(åé¡¿å·)</code>æ˜¯å°†<code>echo Shell Start</code>çš„<strong>è¾“å‡º</strong>ä½œä¸ºå¤–å±‚echoçš„è¾“å…¥ï¼Œæ‰€ä»¥ä¼šè¾“å‡º<code>Shell Start</code>ï¼›</li><li><code>echo echo $c&gt;file1</code>ç›´æ¥æŠŠ<code>echo $c&gt;file</code>ä½œä¸ºå­—ç¬¦ä¸²è¾“å‡ºï¼›</li><li><code>echo (åé¡¿å·)echo $c&gt;file1(åé¡¿å·)</code>æ˜¯å°†<code>echo $c&gt;file1</code>çš„<strong>è¾“å‡º</strong>ä½œä¸ºå¤–å±‚echoçš„è¾“å…¥ï¼Œæ‰€ä»¥ä¼šç›´æ¥è¾“å‡º<code>$c&gt;file1</code>ï¼›</li></ul><h1 id="å®éªŒéš¾ç‚¹"><a href="#å®éªŒéš¾ç‚¹" class="headerlink" title="å®éªŒéš¾ç‚¹"></a>å®éªŒéš¾ç‚¹</h1><p><img src="/img/OS-Lab0/difficulty.png" alt="å®éªŒéš¾ç‚¹"></p><p>è¿™é‡Œå€Ÿç”¨ä¸€ä¸‹Hygggeå­¦é•¿çš„å›¾ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºå†™çš„éå¸¸å¥½ï¼Œæˆ‘åœ¨è¿›è¡Œçº¿ä¸Šå®éªŒçš„æ—¶å€™ä¹Ÿæ³¨æ„åˆ°äº†è¿™äº›éš¾ç‚¹ï¼Œä¹Ÿæ˜¯æˆ‘ç»å¸¸åœ¨å®éªŒè¿‡ç¨‹ä¸­å›å¤´å»çœ‹æŒ‡å¯¼ä¹¦çš„åœ°æ–¹ã€‚</p><p>åœ¨æˆ‘è‡ªå·±çš„æ„Ÿè§‰é‡Œï¼Œæˆ‘å¯¹<code>awk</code>å‘½ä»¤å’Œ<code>grep</code>å‘½ä»¤æ¯”è¾ƒè¿·æƒ‘ï¼Œä¹Ÿæ˜¯çœ‹äº†å¾ˆå¤šæ”»ç•¥ã€‚å…¶ä¸­<code>grep</code>å‘½ä»¤çš„æ­£åˆ™è¡¨è¾¾å¼å’Œ<code>java</code>çš„æ­£åˆ™è¡¨è¾¾å¼ä¸å¤ªä¸€æ ·ï¼Œè¿˜å¾—æ³¨æ„ã€‚</p><h1 id="å®éªŒä½“ä¼š"><a href="#å®éªŒä½“ä¼š" class="headerlink" title="å®éªŒä½“ä¼š"></a>å®éªŒä½“ä¼š</h1><p>å¯¹äºè®¡ç®—æœºå°ç™½çš„æˆ‘æ¥è¯´ï¼Œåˆšå¼€å§‹æ¥è§¦å‘½ä»¤è¡Œè¿˜æ˜¯åœ¨å¤§äºŒä¸Šç ”ç©¶è®¡ç»„çš„æ—¶å€™ã€‚å½“åˆè·Ÿç€åŒå­¦é‡Œçš„å¤§ä½¬ï¼Œåœ¨ç ”ç©¶è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ—¶å€™ï¼Œæ…¢æ…¢å¼€å§‹æ¥è§¦å‘½ä»¤è¡Œï¼Œå­¦ä¼šç”¨å‘½ä»¤è¡Œè§£æã€æ¯”å¯¹ã€‚å½“åˆç¡®å®æ„Ÿè§‰ï¼Œç›¸å¯¹å›¾å½¢åŒ–ç•Œé¢ï¼Œå‘½ä»¤è¡Œçš„ä¸€ä¸ªæå¤§çš„ä¼˜ç‚¹å°±æ˜¯ç®€æ´ã€‚</p><p>å½“ç„¶ï¼ŒCLIå¯¹äºè®¡ç®—æœºå°ç™½çš„æˆ‘è¿˜æ˜¯å¾ˆæœ‰æŒ‘æˆ˜æ€§çš„ã€‚åœ¨åˆšå¼€å§‹ä½¿ç”¨CLIçš„æ—¶å€™ï¼Œé¢å¯¹å¤šç§å¤šæ ·çš„æŒ‡ä»¤ã€å‚æ•°ï¼Œæˆ‘æ€»æ˜¯è®°ä¸ä½å®ƒä»¬çš„åŠŸèƒ½ï¼Œå†™ç€å†™ç€è¿˜è¦é‡æ–°å»ç¿»æŒ‡å¯¼ä¹¦ï¼Œåæ¥æ…¢æ…¢çš„æ‰ä¹ æƒ¯äº†ã€‚</p><p>é“é˜»ä¸”é•¿ï¼Œè¡Œåˆ™å°†è‡³ï¼è¯¸å›ä¸€èµ·åŠªåŠ›ï¼</p><h1 id="åŸåˆ›è¯´æ˜"><a href="#åŸåˆ›è¯´æ˜" class="headerlink" title="åŸåˆ›è¯´æ˜"></a>åŸåˆ›è¯´æ˜</h1><p>æœ¬å®éªŒæŠ¥å‘Šå‚è€ƒäº†Hygggeå­¦é•¿çš„<a href="https://hyggge.github.io/2022/03/21/os/os-lab0-shi-yan-bao-gao/">åšå®¢</a></p><p>å¦å¤–è‡´è°¢æˆ‘çš„èˆå‹é¢¨èˆ¹åŒå­¦ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç»™äº†æˆ‘å¾ˆå¤šå¸®åŠ©å’Œè§£æƒ‘ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BUAA_OS_2025 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
